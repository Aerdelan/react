/**
 * hirtc-web v1.0.4.2024061739
 * build date: 2024/06/17
 * @JuHaoKan Hisense
 */

const e=g;!function(e,t){const r=g,o=l();for(;;)try{if(963473===parseInt(r(1727))/1+-parseInt(r(709))/2+parseInt(r(1669))/3+-parseInt(r(788))/4*(-parseInt(r(1924))/5)+-parseInt(r(1267))/6*(parseInt(r(1851))/7)+-parseInt(r(1385))/8*(parseInt(r(1113))/9)+-parseInt(r(949))/10*(-parseInt(r(1325))/11))break;o.push(o.shift())}catch(e){o.push(o.shift())}}();const t=e(1085);function r({url:t="",method:r=e(631),headers:o,params:n,data:i,timeout:s=5e3,withCredentials:a=!1,responseType:c=e(1160),contentType:d}){return new Promise(((e,u)=>{const l=g,p={"Content-Type":"application/x-www-form-urlencoded; charset=utf-8",Accept:l(1684)};let m=i;const f={...p,...o||{}};d&&(f[l(1519)]=d),r=r[l(1297)]();let b=new XMLHttpRequest;function y(){const t=l;if(!b)return;const r="getAllResponseHeaders"in b?b.getAllResponseHeaders():{},o=c&&c!==t(1581)&&"json"!==c?b.response:b.responseText;b[t(1659)]>=200&&b[t(1659)]<300||304===b.status?e(c===t(1160)&&o?JSON.parse(o):o):(b[t(1081)]=r,b[t(1583)]=o,u(b)),b=null}if(n&&n instanceof Object&&(t=t+"?"+Object[l(1323)](n)[l(782)]((e=>e+"="+n[e])).join("&")),b.open(r,t,!0),b.timeout=s,l(1620)in b?b[l(1620)]=y:b.onreadystatechange=function(){const e=l;b&&4===b[e(1887)]&&(0!==b[e(1659)]||b[e(694)]&&0===b[e(694)][e(1100)]("file:"))&&setTimeout(y)},b[l(1821)]=function(){b&&(u(new Error("Request aborted",config)),b=null)},b[l(842)]=function(e){u(new Error(l(653))),b=null},b[l(1252)]=function(){const e=l;let t=s?"timeout of "+s+e(1305):e(1261);u(new Error(t)),b=null},l(1890)in b&&Object[l(1323)](f)[l(1278)]((e=>{b[l(1890)](e,f[e])})),a&&(b[l(1082)]=!!a),c&&c!==l(1160)&&(b.responseType=c),!m&&!1!==m&&0!==m&&""!==m&&(m=null),[l(773)][l(601)](r)&&f[l(1519)]===p["Content-Type"]&&typeof m===l(1559)){let e="";Object[l(1323)](m)[l(1278)]((t=>{e+="&"+t+"="+m[t]})),m=e[l(830)](1)}b[l(894)](m)}))}const o={DOT:e(1718),COMMON:e(633),ERR:e(531)},n=e(576),i=e(647),s=e(1342);let a=!0,c=!1,d=[],u=null;function l(){const e=["[WS-SEND]","removeListener(","port","setSingleLayerConfig","updateNetStat","forceArea","setReceiverCodecPreferences","WebSocket","room response error","mimeType","checkQosUplinkError","publish before preview","Response","setDevice",") success!","154","setOption","onOpen","currentRoundTripTime",", type: ","resumeAllStreamAudio","bind","role not in same group","kick: ","detail:"," in subscribing process or subscribed already","publishBegin",", ready:","capture media stream error, timeout","emitError","srcObject","RecordError","audioSource","debug",", deviceID:","[previewCustom] videoElement need, and shoud be HTMLElement","act","subscribe error, bad response","assign","framesPerSecond","screenEnableVideo","setAttribute","getQosData",".*\r?\n","ErrorDetail","trackInfo,oncapturehandlechange:","request ip info error, no cityInfo, response:","netlevel","Content-Type","getQosDownlinkData","startMixer","open screen preview error, ","subscribeEnd","screenPreviewEx","errcode","gapList","content","hidden","203003","interruptionCount","codec","videoEnded","anonymous","subscribe(","routineAudioTestReport","videoOutList","VideoError","203001","IpInfoService","\noptions=","countryCode","audio","applyConstraints success","cameraExLayers","timestamp",".txt","***","subscribeBegin","catch","hasOwnProperty","Notify","本地无采集输出","custom sharing, can not publish","no audio track, cant set framerate","webkit-playsinline","AudioWorkletNode","initAudioContext","options","object","videoinput","firCount",", info:","custom stream muted: ","begin recover"," out of limit","controls","dns","room response error, no token","192.","videoSource","updateInfo","tempVideoElem",",readyState:","request room service error, ","abs","spanDuration","info","errdesc","unlogTrackInfo","P000","text","unsubscribe","resopnse","publicIP","probatorSsrc","createElement","wrapErrorData","add bitrate control error, no minBitrate","packetsReceived","inspiredStream","a=ssrc-group:SIM","record stream needCustom: ","stopRecordCustomStream","firstDataDownloaded","ice conn change to","[updateMixer]","videoFramesDecoded: ","PreviewAlready","playDuration","local timestamp=","waitStreamTimer","inbound-rtp","audioPktsSent","cityInfo","core","toDataURL","videoPacketsSent","reconnect","publish error, cannot handle seq id ","random","interval","concat","inBandWidth","replaceStreamTrack","token","muteLocalEx",", errcode: ","ms and retry:","Error","onloadend","replace screen track error","PrintError","wsHandleUpdateInfo","framesReceived","203013","getDisplayMedia",",url:","remote pubid:","onClose","stopMediaTrack","getVideoConstraints","preview(","DOT","userArea","subscribeAutoRecover","shift","setLocalDescription","setDevicePreference","mixer","initTime","LogErrorCode","getCapabilities","wsHandleInfoUpdated","toString","audience","active","setPublishLayer type no support","invalid recovery: ","releaseAudioProcessor","connection state: failed","enableQosReport","[userPlay]: ","getStreamNetLevel","stuck end: ","retry exceed max count:","record local before preview","bindWindowVisibility","oncapturehandlechange","status","wsHandlePing","kind","unpublishBegin","downlinkStats","videoReport(enable:","record stream","fetchRangePercentH","code","peeruserid","3280641lsxOpO","wsUnPublish","streamAudioTest","continueSpeakTime","streamInfo.ready:","[printLocal]","open camera preview error, ","443","replacePCTrack","web socket disconnected","join to session, normal mode","name","localMuteAudio"," label:","subscriber","application/json, text/javascript, */*","web page task error","LogErrorType","wsHandleUpdateLayer","VideoInput","getNetworkMinBw","dType",", streamId:","probator","getDeviceInfo","commonweb","turnPwd","checkRequirement","printLocalEx","session","label",", role:","duplicate inspire stream: ","Sender","userRole","print","wsHandleNegotiate","getItem","published","wsHandlePublish() code:","setMaxListeners","screenPreview","videoHeight","videoFPS"," cname:","screenEnableAudio","decrypt","getElementsByTagName","bwtarget","dot","videoTrack","timeout","update stream info error","audioProcessor","can not add module to audio worklet,","secure","stopRecordCustomStream done","open screen previewEx error, ","1657896zdythp","publishScreenEx","server timestamp=","publishEx before preview","removeListener","QosEvent","network","connected","cameraPreview","setVideoOption","publishedCustom","negotiate error, drop not found stream, params: ","203005","drawImage","join to session, rejoin mode","totalFreezesDuration","anchor","ready","42e01f","addListener",", requestBody: ","leaveBeforeUnload","wsLeave",", re-publish","ErrorCode","websocket connected,","and","Token"," cname:(.*)\r?\n","destroy","join(room:","currentTarget","historyReport","autoRecovery","stopMediaStream","[wsHandleNetStatChanged] msgtype:","clone","stack error, ","click","wsMixer","filter","requestIpInfo","tempMuteVideo","setRemoteDescription","curVideoQuality","getStreamByPubIDorTag","ws send updateNetstat, userID:","errtype","wsPrepare","cleanVideoEvent","supported","url","clearnStreamNetData","adaptVideoConstraints","delUnableAutoPlayElem","mediaType","mediaDevices","default","[printLocalScreenEx]","enc","selectLayer: no stream","decodeDelay","set session description error, err:","publishScreenEx, info should be string","streamid","init audio context ok","triggerLogUpload",") failed, not function found!",",layers:","systemMuteVideo","wsHandleNotifyWebPage","echoCancellation","isBindWindowVisibility","audioLevel","onicecandidate","sdpAddProbator","ended","Joined","publish before join","trackInfo: track is null","selectLayer","removeTrack","sinkId","reconnect stream ","negotiate error, remote","onplay",", errdesc: ","join error,","SubscribeError","listeners","ask for permission but devices were not readable",", time: ","localLog","videoReport","onabort","selfAESDecrypt"," should be a function","videoOption","webPage","customLayers","netWeakMuteVideo","capabilities","post","getDeviceUsingPermission after await navigator.mediaDevices.getUserMedia(constrains)","targetBitrate","videoRemoteIn","addVideoEvent","data:text/javascript;base64,Y2xhc3MgQXVkaW9MZXZlbFByb2Nlc3NvciBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvciB7Y29uc3RydWN0b3IoKSB7c3VwZXIoKTt0aGlzLl9sYXN0VXBkYXRlID0gY3VycmVudFRpbWU7fXByb2Nlc3MoaW5wdXRzLCBvdXRwdXRzLCBwYXJhbWV0ZXJzKSB7aWYgKCFpbnB1dHMpIHtyZXR1cm47fWlmIChjdXJyZW50VGltZSAtIHRoaXMuX2xhc3RVcGRhdGUgPj0gMC4xKSB7aWYgKCFpbnB1dHNbMF0gfHwgIWlucHV0c1swXVswXSkge3JldHVybjt9Y29uc3QgYnVmZmVyID0gaW5wdXRzWzBdWzBdO2xldCBtYXggPSBNYXRoLmZsb29yKE1hdGgubWF4LmFwcGx5KE1hdGgsIGJ1ZmZlcikgKiAxMDApO2lmIChtYXggPCAwKSB7bWF4ID0gLW1heDt9dGhpcy5wb3J0LnBvc3RNZXNzYWdlKHthdWRpb0xldmVsOiBtYXh9KTt0aGlzLl9sYXN0VXBkYXRlID0gY3VycmVudFRpbWU7fXJldHVybiB0cnVlO319cmVnaXN0ZXJQcm9jZXNzb3IoJ2F1ZGlvTGV2ZWwnLCBBdWRpb0xldmVsUHJvY2Vzc29yKTs=","stunURL","sdpMLineIndex","recordScreen","iceConnectionState","targetLayerIndex","length","recordScreen has already start, sid:",", video:","share","wsHandleStopLive","wsUpdateLayer","number","values","subscribed","sort",", sdp:","14vAGzKt","sdpMid","freezeCount","monitor","Join","subscribe recover:","stringify","publishEx(tag:","firstDataUploaded","[stopWebPage]",", status:","Publish","autoDownload","trackInfo,onmute:","clearRect","unknown","requestID","removeEventListener","videoDelay","muteVideo","PreviewError","emitPreviewError","setRole","Track","ceil","E011","onstop","screenLayers","wsHandleNetStatChanged","cameraEnableAudio","maxBitrate","jitterBufferDelay","Stop","live","already in room","getPubIdBySubId","readyState","unpublishEx(tag:","unpublishCustom","setRequestHeader","ondataavailable","userToken","subscribe error,","mozCaptureStream","muted","downloadTime","userAgent","publishers","src","TypeError","saveAs","Decoder","nackCount","unpublishScreenEx(tag:","time","negotiate error, bad msg type","routineQosLog","logError","subscribe stream error","devices","getTransceivers","publishEx before join","now","frameRate","remote","wrapUserActionData","enabled","sdpAddSIM",", muteAllStreamAudio: ","fps","roundTripTime","resume audio fail, session: ","subscribeID","45QMcJKh","stream updated, but stream not found, stream=","LogLevel","test","mediaStuck","bindWindowEvent","sampleNum","href","seq","onConnectionStateChange ext:","1.0","netWeakChange","uninspire stream: ","leave()","result","webRTCSupported","reconnectTimeout","addTransceiver","succeeded","getTracks","wsHandleUpdateNetStat","audiooutput","rel","RequestIpInfoErr","getAppInfo(streamId:","record","isDownlinkError","stuckLogTimer","muteAudio","packetsLost","videoCodec","totalStuckCount","open ","[printLocalEx]","muteRemote","chunks","audioReport","Date","inputBuffer","Unknown","webkitAudioContext","multicast","current role can not publish","uploadTime","音频无发送数据","hiddenDuration","previewScreenEx","updateNetWeakStats","charCodeAt","framesSent","unsubscribeBegin",", layerIndex:","Published","audioprocess","framesEncoded","error","can't autoplay ","hirtc-web@","Media","payloadType","signalingState","onConnectionStateChange","disconnect","stream","muteLocalStream","toFixed","replaceAll"," error","wsHandleRoomUpdated","Play","autoGainControl","videoElem","setPublishRatio, layer info error","publish, info should be string","video-","captureStream","setCustomProfile","getAttribute","jitter","customLog","[pauseWebPage]","audioNoRcvdTimes",", audioInputID:","width","[websdk] ","framesDecoded","wsHandleStartLive"," http request:","[recordLocalScreenEx]","Encoder","loadedmetadata","request ip info error, retry exceed max count:","setVideoElementStream","update info error","print before ready, ","join room error","localDescription","stuckCount","updateTime","application/json","https://api-gps.hismarttv.com/log/get_js_strategy","wsHandleUserJoined","onDeviceChangeCallback","sett simulcast layer bitrate error, ","toLowerCase","uplinkStats","frames","deltaTime","UserAction","getUplinkNetworkReport","restartRtcPeerConn","AudioOutput","sdpAddSimulcast","tempMuteAudio","adr","host","audioNoSentTimes","reconnectingStreams","playTime","pliCount","userPlay","MixerType","isWeak","Invalid serviceID:","wsHandleWebPage","includes","bitrateList",", StreamIDorTag:","onDeviceChange","restartIce","replaceTrack","playsInline","wsUpdateInfo"," msid:","audioCodec","ping","audioElem","getLayerBw",",contentHint:","initRecordCustomStream done","publisher not found","videoWidth","NotSelectDevice","Rtc","audioTrackStopped","publish stream error","privateID","audio/opus","videoFps","subscriber error, cannot handle seq id ","getSenders","videoFreezeWarn","setSenderCodecPreferences","setDevice(deviceType:","rtt","get","statement","common","layerindex","wsHandleStreamAdded","web page notify error: ","isSafari","wsBaseEvent","unpublish","cleanTimer","wsUnsubscribe","cameraPreviewEx","setPublishLayer, publish should be single layer","video/webm;codecs=h264,opus","getVideoTracks","recordLocalScreenEx","HIRTC_WEB_STRATEGY","set audio element source error, ","push","getTargetBw"," mslabel:(.*)\r?\n","renego","Network Error","recvonly","setPublishLayer","joinBegin","close peer conn error, ","subscribe","ios","getHours"," input","codecs","frameHeight","videoPktsLost","wsHandleNegotiate() params.type:","a=fmtp:[a-z0-9 -=]*packetization-mode=1;","candidate","ispCode","open","audioPacketsSent",",document:","a=mid:","screen sharing, can not publish","can not find device","custom stream no video","emit",", requestID: ","onError","ipInfoRetryCount","mfsip","userName","getStats","videoPktsRcvd",", interval:","sendonly","findIndex","sdpFmtpLine","lastRequestID","someoneJoined","too many listeners, add listeners ","reviseStreamDataNormal","rejected","wsPing","responseURL","streamNetworkReport","WebPageErr","restart ice error,","StreamTrack","wsUpdateRoom","getDeviceUsingPermission before await navigator.mediaDevices.getUserMedia(constrains:","[startWebPage]","Sent","onended","start","Unsubscribed","mixerTask","addTrack","boolean","2330838PiNOlE","getDate","Pause","maxListener","https://brs-hirtc.hismarttv.com/v1/auth/token","receive user stream added but user not found","recordTest","127","mixer task error","answerRtcPeerConn","find","audio test audioElement error","onunmute","permission","setPublishRatio, layer shoud be object","[message] sent a msg to","apply","record remote before ready","wsHandleUnsubscribe","wsHandleSubscribe","add bitrate control error,","contentHint","bad listener, listener ","serviceKey","startSpeakTime","AudioContext","request ip info error:","canvas","wsHandleMessage",", err:","streamUpdated","join","handleWindowVisibility","removeAllListener(","params","streamAdded"," peerError recover","pktslost","videoBytesReceived","wsSubscribe","Subscribe","deviceID needed, should be string","ConnectionError","publish respond error, requestID: ","wsNegotiate","set autoplay error,invalid dom",",mauth_signature=","elem play fail:","turnUser","netWeakStats","domain","getStreamInfoByRequestID","infoUpdated","noiseSuppression","allSettled","get permission error","unload","media preview audioTrack is not available","no handler for ","layout","eventBus","a=x-google-flag:conference\r\n","applyConstraints","unpublish-","POST","routineNetworkReport","logContainer","getUserMedia","publishedEx","getStreamInfo","user rejected the permission application","autoplayHack","users","map","camera had been preview already","checkedStreamFirstUpload","muteLocalScreenEx","subscribeRecover","X-Sign-For","386300qOeQCJ","fetchRangePercentL","onconnectionstatechange","globalOptions","decoderImplementation","pause","lastVideoinput","setParameters",", no localStream data","getLayersByStreamInfo","wsHandleLayerReqChanged","Subscribed","negotiate error, type: error, streamID: ","wsHandleRole","videoFPSSent","substr",",muted:","wsRole","isWsOpen","aoni webcam A30"," play success","change ","needUserPlay","frameWidth","destination","-weak:","you need to use HTTPS for selecting audio output device: ","enableInspire","initCore","your browser can not support audio context","replace peer connection video track error,","getBrowserSupported","muteAllStreamAudio","script","enumerateDevices","wsHandleUnPublish","muteStream","begin waitStreamTimer","createMediaStreamSource","hirtcwebsdk","SubscribeIce","logIndex","slice","BasicRoomServiceToken","task","getContext","startNormalBitrate_time","subscriber error, cannot handle seq id, params: ","max","MsgType","request ip info error","hdQualityPriority","undefined","[previewCustom] url error","onerror","RTCPeerConnection","play","isInspired","negotiate error, stream id not found","bps","routineStuckLog","substring","response code not zero","enableDomAutoPlay","elementPlay","reuse","splice","totalBitrate","streamID","audioOut","getFullYear","setSinkId","publish error,","weak","cmd","websocket closed: ","parse","updateInfo(streams:","updateRoom","videoRtt",", add ice candidate error, ","no websocket","startMuteTime","init websocket error","Decoded","streamServer","isBindWindowEvent","videoJitter",", open:","E003","can not stop recording, stream","cannot set simulcast layers encoding, getParameters or setParameters is not available","begin audio test, sampling: ","Utf8","guardian","HmacSHA1","[recordLocal]","stuckData:","autoplay","min","totalInterruptionDuration","record error","qosHistroyData","failed",", enable:","E012","send","audio/g722","message","sdpAddLayer","resetStreamData","wsHandler","crossOrigin","connectionState","streams","applyConstraints fail","SUCCESS","Subscriber","NotFoundError","streamAudioReport","sdpAddGroup","answer","Camera","streamInfo","releaseAudioTestProcessor","tokenInfo","Received","packetsSent","canvasTrack","video/H264",", local: ","text/plain;charset=utf-8","unableAutoPlay","-streamID-","isChange","callback","preview","getStreamReport","wrapBaseData","decode","audio test interval error","cleanStreamData",", msg:","mediatype","StreamType","getQosUplinkData","[recordRemote]","headers","qosReport(enable:","audioPktsLost","httpRequest","networkReportInterval","screenshot local before preview","unpublishEnd","unshift","uid","encodings","quality",",enabled:","wsHandleUserLeft",", muteVideo:","4844510ViPFKD",", re-subscribe","addListener(","h264DecodeSupported","wsMessage","uplink weak","203011","download","wsHandleKick","height","emitNetworkReport",",mauth_role=presenter,mauth_serviceid=","audioJitter","localMuteVideo","android","E000","availableOutgoingBitrate","sign error, ","close","totalVideoFps","AudioInput","wsHandleUpdate","requestTimeout","updateSubLayer","muteLocalCustom(status:","sessionStorage"," label:(.*)\r?\n","unpublish(streamType:","Video","SubStreamType","E001","streamRemoved","setCustomProfile: url error","muteRemoteStream","video/h264","joinRoomEx","level","publishScreenEx before join","cameraChangePreview","initRecordCustomStream","offer:","removeItem","onIceCandidate","selectLayer: no subscriberID","create session description error, ","event [error]","recordRemote","reconnected","split","detail","previewEx(vodeo.id:","publicCloud","UserRole","createScriptProcessor","before subscribe","ip request: ","[recordLocalEx]","NotAllowedError","SetDeviceError","routineAudioReport","const",".webm","can not parse data, ","LOG_TYPE","Screen","printLocalScreenEx","logSize","customStream",", detail:","unsubscribe-","tag","Role","layers","aduioTest","getAudioTracks","AllDisabled","SecurityError","videoPktsRcvd: ","muteLocalCustom","COMMON","jitterBufferEmittedCount","statusText","wsInitialize","receiver","AES","UplinkWeak","pause audio fail, session: ","publishCustom, info should be string","track","nack","open audio input error, ",",kind:","set video element source error, ","app","open video preview error, ","custom","availableIncomingBitrate","outbound-rtp","publish response code not zero","audioContext timeout","type","displaySurface","signature","role","peerError","publish error, bad response","removeAllListener",",mauth_cnonce=","sdp","checkStreamFirstUpload","OPEN","TaskCmd",", has audioElement: "," not support yet","video","Area","log","weakDuration","lastMuteAudio","streamType","ParamsError","media preview videotrack is not available","recoverTimeout","sleep ","deviceList","remote-candidate","sysAudience","media playback","wsSender","muteLocal","[printRemote]","publishCustom(info:","responseHeaders","withCredentials","getDownlinkNetworkReport","autoplayFix","1.0.4.2024061739","resolve","视频无发送数据","getSettings","publisher","revokeObjectURL","no need subscribe recover","setSimulcastLayerBitrate","), enableInspire: ","recordLocal","document hidden: ","ipAddr","lastIntervalTime","StreamRole","PublishError","indexOf","setSimulcastLayerConfig","addModule","wsHandlePublish","unsubscribeEnd","serAddress","can not handle data, ","setPublishLayer, type:","PublishIce","startNormalBitrateTime","audioTest(enable:","audioTest","Record","9cHaRxl","join respond error, requestID: ","deviceChanged","clockRate","setStreamReport","subscribe-","emitNetWeakReport","change simulcast layer active, ","muteLocal(streamType:","groupId","videoRemoteInList","Services","wsUpdate","wsHandleNegotiate Notify: params:","DeviceType","getNetLevel",", tag:","mute","videoNoSentTimes","closed","Audio","logInfo","iceServers","autoFocusScreen","local","open camera before select device","request","leaveRoom","getChannelData","sysAnchor","FpsList","ssrc","[getDevices]: enableDetail: ","publish error, requestID: ","packetization-mode=1","audioTrack","fromCharCode","setRole:","setDNS(rules:","customPreview","candidate-pair","onmessage","handleMessage_",", code not zero","clear","checkQosDownlinkError","checkStreamFirstDownload","json","not found","videoPktsSent","onIceStateChange ext:","inspired stream: ","wrapStuckData","setCustomProfile(videoEle:",", levelList:","record error, stream","Publisher","setItem","muteLocalEx(tag:","cityCode","prototype","m=video","checkDeviceList","offer","captureStream not exit","Layers","qosUploadInterval","autoLayout","promise","vbad","bytesSent","wsHandleLeave","getDeviceInfo(deviceID:","sdpAddBitrateControl","setCodecPreferences","wsWebPage","screenEx","selected","disconnected","onIceNegotiationNeeded","publish","record remote not found","update","JoinError","checkVideoPlay","askForPermission(audio:","open media preview error","E007","markPermission","audioRtt","MediaRecorder","ondevicechange"," mslabel:","open camera error","qosReport","`reqest ip info:","getParameters","group","Event","x-google-min-bitrate=","bytesReceived","audioLevelLog","negotiate error, type: failed, streamID: ","replace","then","joined","canplay","ipInfoMaxRetryCount","unpublishEx","E009","index","getResponseHeader","reconnectStream","wsHandleNotifyMixer","audioRemoteIn","connectionState failed ext:","NotReadableError","_hiRtcSDK.getDeviceUsingPermission(audio:","replaceCustomTrack","framesDropped",", code: ","Leave","videoNoRcvdTimes"," msid:(.*)\r?\n","routineCheckStreamFirstUpload","data","target","levelList","state","desc","previewCustom(videoElement:","logToFile","networkReport","averageBitrate","getDeviceUsingPermission","negotiate error, bad msg type, params: ","room service response error, ","subscriber error, code not zero, params: ","LogType","ontimeout","video input","stack","closeRtcPeerConn","bad","request room error,status: ","auidoInterval"," or serviceKey:","deviceId","timeout exceeded","cameraLayers","previewScreenEx(vodeo.id:","emitPeerError",", area:","connect","4213374esTPTf","warn","joinEnd","qosError, errtype: ","Unpublished","setCustomProfile: custom not preview yet","MixerErr","[streamUpdated] uid:","E010","videoOut","response","forEach","forceAreaCode","stuck begin: ","getSeconds","joinRoom","streamVideoReport","audioPktsRcvd","screen","selectLayer(subscriberID:","negotiate","subType","publishedScreenEx","browser does not support output device selection","web page respon error: ","notify","targetBw","audioWorklet","m=audio","cameraEnableVideo","toUpperCase","tokenId","startLowBitrateTime","reportInfo","report","onmute","] got a msg","print picture error","ms exceeded","resetDefaultDevice","onIceStateChange","both audio and video have been disabled","roomName","leave","_hiRtcSDK.getDeviceUsingPermission end","unsubscribe, stream not found","Info","wsPublish","userActionData","enableLogUpload","previewEx","stop","encode",", videoInputID:","pauseAllStreamAudio","userID","keys","presenter","33WZVSkX",", options: ","ERR","PlatformType","request room error","audioDelay","cameraEx","Warn","audiolevel","autoInsertScreen"," meta data received ","selectLayer: layerIndex out of range","addEventListener","match","negotiate notify failed, streamInfo.id:","Custom","reject","_public_cloud_","[setPublishRatio]","[recordScreen], open screen error","pair","outBandWidth","getAudioConstraints","input","end waitStreamTimer",", subscribeID:","remote-inbound-rtp","trackName","serviceID","customCanPlay","all","connection error","stamp","unpublishScreenEx","lastLocalMuteAudio",", uName:","activeDuration","request ip info success, resp:",", uid:","recorders","camera","turnURL","totalStuckDuration","layerIndex","E004","not started recording, ","wsJoin","beginStuckTime","logTrackInfo","Start","get audio report before preview, no permission","retry","averageVideoFps","stuckDuration","videoBytesSent","bad response, decryption failure","add simulcast info to original sdp error,","recorder","subStreams","webpageTask","12324968KvcWBv","replace peer connection audio track error,","duration","kick","reviseStreamData","publishID","request ip info error, ","视频流无接收数据","audioContext","catch an error when apply for stream, ","floor",",mauth_userid=","setSimulcastLayerEncoding","screenshot remote before subscribe",", muteAudio:","open screen error","completed","peerErrorEvent","MediaType","bwsend","publishEnd","createRtcPeerConn","printLocal","audioinput","set one layer bitrate error, ","[join]: role invalid","msg","muteLocalStreamEx","fulfilled","function","[setRole]: ","Update","websocketPingInterval","layerscount","getMonth","join widthout uName","canvasTimer","wss://","wsHandleStreamUpdated","getTrackFunc","a=ssrc:","routineVideoReport","reviseStreamDataRejoining","oniceconnectionstatechange","currentScript","regionCode","Encoded","webpage","websocket open:","offSceenVideo","[WS-GET]","markVideoEnded","reset local description error,","logReport","event [","setCore","toggleMute","wsHandleUpdateRoom","Constraints","last","1.8","logWarn","string","stuckData","userDNS","publish(streamType:","bytessent","initBrowserSupported","videoFramesDecoded","wsUpdateNetStat","trackInfo,onended:","createOffer","prepare ice reconnection","create","setCodecPreferences error:",", params:"," before preview","trackInfo,onunmute:","onMessage","wsHandleMixer","publish-"," , area:","failCheck","qosLogTimer","getDeviceList","encodetime"];return(l=function(){return e})()}const p=(y=e(974),{setItem(e,t){const r=g;"object"==typeof t&&(t=JSON[r(1857)](t)),window[y][r(1170)](e,t)},getItem(e,t=!1){const r=g;let o=window[y][r(1706)](e);if(t)try{o=JSON.parse(o)}catch(e){console.error(e),o=null}return o},removeItem(e){window[y].removeItem(e)}}),m=(t,r,n=o.COMMON)=>{const i=e;return u&&u.serAddress?t({url:b(n,u),method:"post",sign:!1,data:{json:JSON[i(1857)](r)},timeout:1e3}):Promise[i(1341)](new Error("No log strategy"))},f=(t,r)=>{const o=e;t?c=!0:(c=!1,d[o(1840)]>0&&(d[o(1278)]((e=>{e(r)})),d=[]))},b=(t,r)=>{const n=e;switch(t){case o[n(1633)]:return r.dotAddress;case o[n(1327)]:return r.excAddress;default:return r[n(1105)]}};var y,v={init:t=>{const r=e,{publicCloud:o}=t;!u&&(u=p[r(1706)](i,!0)||null),u&&u[s]!==o&&(p[r(990)](i),u=null),a=o},report:(t,r,o)=>new Promise((l=>{const b=g;c?d[b(649)]((e=>{const n=b;e?l():m(t,r,o).then(l)[n(1549)](l)})):u?m(t,r,o)[b(1217)](l)[b(1549)](l):(f(!0),((t,r)=>{const o=e;t({url:a?n:"https://api-gps-julinker.hisense.com/log/get_js_strategy",method:o(631),timeout:1e3,sign:!1,params:{policySeq:Math[o(1395)](Date[o(1913)]()/1e3),appKey:1192554437,version:o(1934),reportTag:0,receiveTag:2}}).then((e=>{const t=o;e.serAddress&&(u=e,u[s]=a,p[t(1170)](i,u)),f(!1),r()}))[o(1549)]((e=>{f(!1,e),r(e)}))})(t,(e=>{const n=b;e?l():m(t,r,o)[n(1217)](l)[n(1549)](l)})))})),LOG_TYPE:o};function g(e,t){const r=l();return(g=function(e,t){return r[e-=488]})(e,t)}const h=function(){const t=e;let r=new Date;return r[t(858)]()+"/"+(r[t(1419)]()+1)+"/"+r[t(710)]()+" "+r[t(660)]()+":"+r.getMinutes()+":"+r[t(1281)]()+"."+r.getMilliseconds()},w=function(t,r){const o=e;return Math[o(1395)](Math[o(1610)]()*(r-t+1))+t},S=function(e=10){const t=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];let r="";for(let o=0;o<e;o++)r+=t[w(0,61)];return r},I=function(e=0,t=0,r=0,o=1){return 0===r?0:Math.floor(o*(e-t)/r)||0},k=function(t=""){const r=e;return t?t[0][r(1297)]()+t.substring(1):t},E=function(){},D=function(t,r,o){const n=e,i=Date[n(1913)]()+(r[n(583)]||0),s=Math[n(1395)](i/1e3),a=t[n(1322)],c=r[n(1353)],d=r[n(732)];try{return"MAuth realm=http://marte3.dit.upm.es,mauth_signature_method=HMAC_SHA1"+n(1396)+a+n(960)+c+n(1056)+i+",mauth_timestamp="+s+n(755)+Base64.encode(CryptoJS[n(883)]([s,i,a,n(1324)][n(740)](","),d)[n(1644)]())}catch(e){o[n(1908)](n(966)+e)}},T=t=>{const r=e;let o=URL.createObjectURL(t),n=document[r(1586)]("a");n[r(1931)]=o,n[r(956)]=""+t.name,n[r(498)]="noopener",setTimeout((function(){const e=r;URL[e(1090)](n[e(1931)])}),3e4),setTimeout((function(){n[r(1765)]()}),0)};class C{logContainer=[];[e(829)]=-1;LogLevel={Info:e(1577),Warn:e(1268),Error:e(531)};[e(791)]=null;constructor({globalOptions:t}){this[e(791)]=t}[e(1065)](t,...r){const o=e;let n=o(560)+h()+" "+t,i="";if(r.forEach((e=>{i=e instanceof Object?i+" "+JSON[o(1857)](e):i+" "+e})),i&&(i=n+" -"+i+"\n",console[t](i),this[o(775)].push(i),this[o(775)].length>this[o(791)][o(1015)]))for(let e=0,t=this[o(791)][o(1015)]/10;e<t;e++)this.logContainer[o(1636)](),this[o(829)]--}[e(1134)](...t){const r=e;this.log(this[r(1926)][r(1313)],...t)}[e(1446)](...t){const r=e;this[r(1065)](this[r(1926)][r(1332)],...t)}[e(1908)](...t){const r=e;this.log(this[r(1926)][r(1619)],...t)}[e(1244)](t,r){const o=e;let n=window[o(1901)]||T,i=JSON[o(1857)](t),s=JSON[o(1857)](this.globalOptions).replace(this[o(791)][o(732)],o(1547)),a=h()[o(997)](" ",2);this[o(775)][o(649)]("@@@@ write log to file @@@@\ncore="+i+o(1540)+s+"\n");let c=o(533)+a[0]+"@"+a[1][o(997)](".",1)[0]+o(1546),d=new File(this.logContainer,c,{type:o(919)});return r&&n(d),d}[e(1157)](){const t=e;this.logContainer=[],this[t(829)]=-1}}class R{listeners={};[e(1211)]={joined:e(1218),reconnected:e(996),disconnected:e(1191),kick:"kick",someoneJoined:e(689),someoneLeft:"someoneLeft",published:e(1707),publishedEx:e(777),publishedScreenEx:e(1289),publishedCustom:e(1737),subscribed:e(1848),streamAdded:e(744),streamRemoved:e(980),streamUpdated:e(739),infoUpdated:e(761),message:e(896),mixerTask:e(706),webpageTask:e(1384),videoOption:e(1824),deviceList:e(1073),deviceChanged:e(1115),audioReport:e(512),videoReport:e(1820),audioTest:"audioTest",networkReport:e(1245),qosReport:"qosReport",netWeakChange:e(1935),permission:e(722),camera:"camera",cameraEx:"cameraEx",screen:"screen",screenEx:"screenEx",custom:e(1044),needUserPlay:e(810),audioTrackStopped:"audioTrackStopped",subscribeRecover:"subscribeRecover",videoFreezeWarn:"videoFreezeWarn",peerError:e(1053),error:e(531)};[e(712)]=10;constructor(t){const r=e,{maxListener:o,localLog:n}=t;this.localLog=n,o&&this[r(1709)](o)}[e(1746)](t,r){const o=e;!r instanceof Function?this[o(1819)][o(1908)](o(731)+t+o(1823)):this.listeners[t]&&this[o(1816)][t][o(1840)]>=this[o(712)]?this[o(1819)][o(1908)](o(690)+t+o(1565)):(this[o(1819)][o(1134)](o(951)+t+")"),this[o(1816)][t]instanceof Array?-1===this.listeners[t][o(1100)](r)&&this[o(1816)][t][o(649)](r):this[o(1816)][t]=[][o(1612)](r))}removeListener(t,r){const o=e;if(!this[o(1816)][t]||0===this[o(1816)][t][o(1840)])return void this[o(1819)].logWarn(o(1472)+t+o(1794));let n=this.listeners[t].indexOf(r);n>=0&&(this[o(1816)][t][o(854)](n,1),this[o(1819)].logInfo(o(1472)+t+o(1485)))}[e(1055)](t){const r=e;this[r(1819)][r(1134)](r(742)+t+")"),this[r(1816)][t]=[]}setMaxListeners(t=10){this[e(712)]=t}[e(676)](t){const r=e;if(!t)return;let o=Array[r(1173)][r(830)].call(arguments);if(o[r(1636)](),[r(1207),"networkReport",r(1820),r(512),"error"][r(1100)](t)<0&&("message"===t?this[r(1819)][r(1134)](r(1439)+t+r(1303)):this[r(1819)][r(1134)](r(1439)+t+"]",o)),this[r(1816)][t]&&this[r(1816)][t][r(1840)]>0){const e=[];this[r(1816)][t][r(1278)]((t=>{e[r(649)](t)})),e.forEach((e=>{e[r(725)](null,o)}))}}destroy(){this[e(1816)]={}}}const L=navigator[e(1897)][e(580)](),P=!!L.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/i),x=(()=>{const t=e,r=L.match(/cpu iphone os (.*?) like mac os/);return r&&typeof r[1]===t(1447)?r[1][t(542)]?r[1].replaceAll("_","."):(r[1]=r[1][t(1216)]("_","."),r[1][t(1216)]("_",".")):null})(),O=/safari/[e(1927)](L)&&!/chrome/.test(L);var A,M={ios:P,iosVer:x,android:L[e(1100)]("android")>-1||L[e(1100)](e(590))>-1,androidVer:L[e(1338)](/android (.*?);/),isSafari:O};function N(){const o=e;let n={publicCloud:!0,debug:!1,logSize:2e3,deltaTime:0,serviceID:"",serviceKey:"",forceArea:!1,autoPublishCamera:!1,cameraEnableVideo:!0,cameraEnableAudio:!0,muteCameraVideo:!1,muteCameraAudio:!1,autoPublishScreen:!1,screenEnableVideo:!0,screenEnableAudio:!1,muteScreenVideo:!1,muteScreenAudio:!1,autoSubscribe:!1,autoRecovery:!0,enableQosReport:!1,enableLogUpload:!0,Services:{BasicRoomServiceToken:e(713),IpInfoService:"https://bas-web.hismarttv.com/1.0/bas/ip/info"},requestTimeout:5e3,websocketPingInterval:1e3,qosUploadInterval:5e3,stuckLogInterval:600,networkReportInterval:5e3,cameraLayers:[{width:320,height:180,frameRate:20,targetBw:16e4,layerIndex:0},{width:640,height:360,frameRate:20,targetBw:5e5,layerIndex:1},{width:1280,height:720,frameRate:20,targetBw:11e5,layerIndex:2}],cameraExLayers:[{width:320,height:180,frameRate:20,targetBw:16e4,layerIndex:0},{width:1280,height:720,frameRate:20,targetBw:11e5,layerIndex:1}],screenLayers:[{width:1920,height:1080,frameRate:15,targetBw:15e5,layerIndex:0}],customLayers:[{width:1920,height:1080,frameRate:15,targetBw:15e5,layerIndex:0}],maxListener:10,supported:{},publicIP:"",ispCode:"",countryCode:"",regionCode:"",cityCode:"",hdQualityPriority:!1,enableProbator:!1,leaveBeforeUnload:!0,audioLevelLog:!0,peerErrorEvent:!1,subscribeAutoRecover:!1,autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,videoFreezeLog:!1,autoplayFix:!1},i=new C({globalOptions:n}),s=new R({localLog:i}),a=window.saveAs,c=window[o(734)]||window[o(516)]||null,d=window[o(1203)]||null,u=window[o(1556)]||null,l={};l.eventBus=s,l[o(1819)]=i,l[o(1558)]=n,l[o(1605)]={retry:0,status:0,roomName:"",userID:"",userName:"",userArea:"",userToken:0,session:"",stunURL:"",turnURL:"",turnUser:"",turnPwd:"",publicIP:"",ispCode:"",countryCode:"",regionCode:"",cityCode:"",userRole:0,ipInfoMaxRetryCount:3,ipInfoRetryCount:0,permission:{audio:!1,video:!1},camera:{local:!0,type:o(1365),preview:!1,muteAudio:!1,muteVideo:!1,ready:!1,id:null,pc:null,candidate:[],stream:new MediaStream,audioTrack:null,videoTrack:null,lastRequestID:"",info:{app:"",rtc:"",act:0}},cameraEx:{},screen:{local:!0,type:"screen",preview:!1,muteAudio:!1,muteVideo:!1,ready:!1,id:null,pc:null,candidate:[],stream:new MediaStream,audioTrack:null,videoTrack:null,lastRequestID:"",info:{app:"",rtc:"",act:0},subType:o(1285)},custom:{local:!0,type:o(1285),preview:!1,muteAudio:!1,muteVideo:!1,ready:!1,id:null,pc:null,candidate:[],stream:null,audioTrack:null,videoTrack:null,lastRequestID:"",info:{app:"",rtc:"",act:0},subType:"custom",label:o(1076)},audioTest:{local:!0,type:o(1022),sampling:200,stream:null,audioLevel:0,levelList:[]},users:{},publishers:{},devices:{audioinput:"",audiooutput:"",videoinput:"",detail:{audioinput:[],audiooutput:[],videoinput:[]},lastVideoinput:""},unableAutoPlay:[],reconnectingStreams:{},network:{const:{rttMin:50,rttMax:200,fractionLostMin:5,fractionLostMax:10,delayMin:80,delayMax:300,jitterMin:80,jitterMax:400,kMinVideoBitrate:6e4,kMinVideoBitrate2:3e5,kMinVideoFrameRate:2,kMaxExpiredNetLevelStatInMs:1e4,kScreencastStreamBWJitterRatio:.4,kNetUpWeakBitrate:6e4,kNetDownWeakLevel:1,kNetDownWeakFps:5,networkQuality:{unknown:0,vbad:1,bad:2,poor:3,good:4,excellent:5}},uplinkStats:{},downlinkStats:{},netWeakStats:{}},wsBaseEvent:{onOpen:null,onClose:null,onMessage:null,onError:null},dType:10,curVideoQuality:2,userActionData:{},stuckData:{},probatorSsrc:1234,isBindWindowEvent:!1,isBindWindowVisibility:!1,muteAllStreamAudio:!1,peerErrorEvent:{}},l.dns={},l.initCore=function(){const e=o;l[e(1605)].status=0,l.core[e(1892)]=0,l.core[e(1698)]="",l[e(1605)][e(1771)]=2,Object.values(l.StreamType)[e(1278)]((t=>{const r=e;l[r(1605)][t].id="",l[r(1605)][t].pc=null,l[r(1605)][t][r(667)]=[],l[r(1605)][t][r(1744)]=!1,l[r(1605)][t][r(688)]="",l.core[t][r(504)]=!1,l.core[t][r(1870)]=!1,l[r(1605)][t][r(1368)]=-1})),l[e(1605)][e(1331)]={},l[e(1605)][e(920)]=[],l[e(1605)][e(781)]={},l[e(1605)][e(1898)]={},l[e(1605)][e(1315)]={},l[e(1605)][e(1733)][e(581)]={},l[e(1605)][e(1733)][e(1663)]={},l[e(1605)][e(1733)][e(758)]={}},l[o(1440)]=function(e={}){const t=o;!e instanceof Object||Object[t(1323)](e)[t(1278)]((r=>{const o=t;l[o(1605)][o(1550)](r)&&(l[o(1605)][r]=e[r])}))},l.getCore=function(e=""){const t=o;if(e&&l[t(1605)][t(1550)](e))return l.core[e]},l.initBrowserSupported=function(){const e=o;if(navigator[e(1783)]&&(!l.options[e(1777)]||0===Object[e(1323)](l.options[e(1777)])[e(1840)])){let t=navigator[e(1783)].getSupportedConstraints();t&&Object[e(1323)](t).length>0&&(i[e(1134)]("browser supported constraints:",t),l[e(1558)][e(1777)]=t)}},l[o(819)]=function(e=""){const t=o;return e&&l.options[t(1777)]&&l.options[t(1777)][e]||!1},l[o(1929)]=function(){const e=o;n[e(1748)]&&!l[e(1605)][e(874)]&&(window[e(1337)](e(765),(()=>{l[e(1140)]()})),l[e(1605)][e(874)]=!0)},l[o(1657)]=function(e){const t=o;e?!l[t(1605)][t(1799)]&&(window.addEventListener("visibilitychange",l.handleWindowVisibility),l[t(1605)][t(1799)]=!0):l[t(1605)][t(1799)]&&(window[t(1868)]("visibilitychange",l.handleWindowVisibility),l[t(1605)][t(1799)]=!1)},l[o(741)]=function(){const e=o;i[e(1134)](e(1095)+document[e(1528)])},l[o(1487)]=function(e={}){const n=o;e.serviceID&&(i[n(1134)]("sdk version: "+t),i[n(1134)]("userAgent: "+navigator[n(1897)])),l[n(1452)](),!e instanceof Object||(null!=typeof e[n(1504)]&&e[n(1504)]&&i.logInfo("setOption(options:"+JSON[n(1857)](e)+")"),Object[n(1323)](e)[n(1278)]((t=>{const r=n;r(1353)!==t&&r(732)!=t&&("object"==typeof e[t]?i[r(1134)](t+":"+JSON[r(1857)](e[t])):i[r(1134)](t+":"+e[t])),l[r(1558)][r(1550)](t)&&("Services"==t?Object[r(1323)](e[t])[r(1278)]((o=>{const n=r;l.options[t][n(1550)](o)&&(l[n(1558)][t][o]=e[t][o])})):l[r(1558)][t]=e[t])})),(""==l[n(1558)].serviceID||""==l[n(1558)][n(732)])&&i[n(1908)](n(599)+l.options.serviceID+n(1259)+l[n(1558)][n(732)]),v.init({publicCloud:l[n(1558)][n(1e3)]},r),l[n(1929)]())},l[o(1449)]=function(e=""){const t=o;if(!e)return"";let r=Object.keys(l[t(1567)])||[];for(let o=0,n=r.length;o<n;o++){let n=r[o];if(e[t(1100)](n)>=0){let r=l[t(1567)][n];e.replaceAll?e=e.replaceAll(n,r):e=(e=e[t(1216)](n,r))[t(1216)](n,r);break}}return e},l[o(938)]=function(e=o(1829),t="",n={},s={},a=E,c=E){const d=o,u={method:e,url:l.userDNS(t),timeout:l[d(1558)].requestTimeout,contentType:d(575)};s instanceof Object&&Object[d(1323)](s)[d(1840)]>0&&(u.headers=s),"get"===e?u[d(743)]=n:u[d(1238)]=JSON[d(1857)](n),r(u)[d(1217)]((e=>{a(e)}))[d(1549)]((e=>{c(e)})),i[d(1134)](e+d(563)+JSON.stringify(u))},l[o(1064)]={Unknown:"0",BeiJing:"1",ShangHai:"2",GuangZhou:"3"},l[o(932)]={Camera:"camera",Screen:o(1285)},l[o(978)]={Camera:o(1365),Screen:o(1285),Custom:o(1044)},l[o(1098)]={Publisher:o(1089),Subscriber:o(1683)},l[o(837)]={Request:o(1139),Response:o(1277),Notify:o(1292)},l.StreamTrack={Audio:o(1542),Video:o(1063)},l[o(1127)]={AudioInput:"audioinput",VideoInput:o(1560),AudioOutput:"audiooutput"},l[o(1403)]={Audio:o(1542),Video:o(1063),Screen:o(1285)},l.MixerType={Live:1,Record:2},l.TaskCmd={Start:o(704),Stop:o(1318),Pause:o(793),Play:o(844),Update:o(1195)},l.ErrorCode={PermissionError:o(1580),ParamsError:o(964),JoinError:o(979),PreviewError:"E002",PublishError:o(877),SubscribeError:o(1369),ConnectionError:"E005",SetDeviceError:"E006",RecordError:o(1200),PrintError:"E008",UpdateInfoErr:o(1222),MixerErr:o(1275),WebPageErr:o(1876),RequestIpInfoErr:o(893),SetRoleError:"E013"},l[o(1515)]={P000:o(764),E000:"parameter(s) error，check it please",E001:o(571),E002:"handle preview error",E003:o(621),E004:o(1909),E005:o(1356),E006:"set device error",E007:o(889),E008:o(1304),E009:o(1721),E010:o(717),E011:o(1685),E012:o(838),E013:o(1493)},l[o(1001)]={anchor:0,audience:1,sysAnchor:2,sysAudience:3},l[o(1328)]={AndroidTv:1,AndroidPhone:2,WinPc:3,Iphone:4,Mac:5,Ipad:6,AndroidPad:7,WinTv:8,TinyApp:9,Web:10},l.emitError=function(e="",t=""){const r=o;if(e){let o={desc:""};l.ErrorDetail[e]&&(o.desc=l[r(1515)][e]),typeof t===r(1447)?t&&(o[r(1242)]=o.desc+", "+t):(t[r(1242)]&&(t[r(1242)]=o.desc+", "+t[r(1242)]),o={...t}),i[r(1908)](r(994),e,JSON[r(1857)](o)),s[r(676)](s[r(1211)].error,e,o)}},l.emitPreviewError=function(e){const t=o,{type:r,desc:n,subType:i,error:s}=e;let a=0;switch(s[t(1680)]){case"AbortError":a=2001;break;case"NotAllowedError":a=2002;break;case t(906):a=2003;break;case"NotReadableError":a=2004;break;case"OverconstrainedError":a=2005;break;case t(1025):a=2006;break;case t(1900):a=2007;break;case t(1598):a=2008;break;case t(1024):a=2009;break;case"NotSelectDevice":a=2010;break;case t(1537):a=2011}l[t(1500)](l[t(1751)][t(1871)],{type:r,desc:n,subType:i,code:a})},l.LogType={Error:o(955),QosEvent:o(1538),UserAction:o(1625),mediaStuck:o(1739),CustomLog:o(555)},l[o(584)]={Joined:1,Leave:2,Published:3,Unpublished:4,Subscribed:5,Unsubscribed:6,firstDataUploaded:7,firstDataDownloaded:8,toggleMute:9},l[o(890)]={},l[o(1686)]={Audio:1,Video:2,Rtc:3},l[o(1641)]={Media:{Capturer:1,Encoder:2,Sender:3,Receiver:4,Rtpdemux:5,Decoder:6,Render:7},Rtc:{Token:1,Join:2,Publish:3,Subscribe:4,PublishIce:5,SubscribeIce:6,UplinkWeak:7}},l[o(1793)]=function(e,t={}){const r=o;if(l[r(1558)][r(1316)])switch(e){case l[r(1251)][r(1732)]:l.getQosData().then((e=>{const t=r;e.log[t(1840)]>0&&l.logReport(e[t(1065)],v.LOG_TYPE[t(1028)]),l[t(1558)][t(1651)]&&e.report[t(1840)]>0&&s.emit(s[t(1211)][t(1207)],e[t(1301)])}));break;case l[r(1251)].UserAction:const o=l[r(1916)](e,t);l[r(1438)](o,v[r(1012)][r(1028)]);break;case l[r(1251)][r(1928)]:const n=l[r(1165)](t);l[r(1438)](n,v[r(1012)][r(1028)]);break;case l[r(1251)].Error:const i=l[r(1587)](e,t);l[r(1438)](i,v[r(1012)].COMMON)}},l[o(1520)]=function({streamInfo:e,pair:t,video:r,audio:n,videoCodec:i,audioCodec:s,remoteCandidate:a}){const c=o,d={log:[],report:[]},u=n&&!(e[c(504)]||e.localMuteAudio),p=r&&!(e.muteVideo||e.lcoalMuteVideo);if(!t)return d;const m={...l.wrapBaseData({eventCode:c(1529),streamInfo:e}),userid:l[c(1605)][c(1322)],roomid:l.core[c(1309)],serviceid:l[c(1558)].serviceID,username:l[c(1605)][c(681)],streamid:e.id,layerindex:e.layerIndex,peeruserid:e[c(943)],mediatype:-1,codec:-1,ssrc:-1,mute:-1,jitter:-1,pktslost:-1,width:-1,height:-1,fps:-1,pli:-1,fir:-1,cpu:-1,memory:-1,netmode:-1,bwtransmit:-1,bwretransmit:-1,nack:-1,audiolevel:-1,bwrecv:-1,bytesrcvd:-1,pktsrcvd:-1,fpsout:-1,remb:-1,delay:-1,framesdropped:-1,netlevel:-1,weak:-1,codecname:-1};if(a&&(e[c(680)]=a.ip+":"+a[c(1473)]),u){const r=l.qosHistroyData[n.ssrc]?l[c(890)][n.ssrc].audio:{packetsLost:0},o={...m,mediatype:l[c(1403)][c(1133)],ssrc:n[c(1144)],bwrecv:t.availableIncomingBitrate,codec:s?""+s[c(1480)][c(997)]("/")[1]:-1,bytesrcvd:n.bytesReceived,pktsrcvd:n[c(1589)],pktslost:n[c(505)]-r[c(505)],delay:1e3*t[c(1489)]+(n[c(1029)]?n[c(1882)]/n[c(1029)]*1e3:0),jitter:1e3*n[c(554)],audiolevel:n.audioLevel,mute:e[c(504)]||e[c(1681)]?1:0,weak:0,netlevel:5};d.log.push(o)}if(p){const o=l[c(890)][r.ssrc]?l[c(890)][r[c(1144)]][c(1063)]:{packetsLost:0,firCount:0,pliCount:0,nackCount:0,framesDropped:0},n={...m,mediatype:e[c(1049)]===l[c(932)][c(1013)]?l.MediaType[c(1013)]:l[c(1403)][c(977)],ssrc:r.ssrc,bwrecv:t[c(1045)],codec:i?""+i[c(1480)][c(997)]("/")[1]:-1,bytesrcvd:r.bytesReceived,pktsrcvd:r[c(1589)],pktslost:r.packetsLost-o[c(505)],width:r.frameWidth,height:r[c(663)],fps:r[c(1510)],fir:r[c(1561)]-o[c(1561)],pli:r.pliCount-o[c(595)],nack:r[c(1903)]-o[c(1903)],delay:1e3*t[c(1489)]+(r[c(1029)]?r[c(1882)]/r[c(1029)]*1e3:0),jitter:1e3*r[c(554)],mute:e[c(1870)]||e[c(962)]?1:0,framesdropped:r[c(1232)]-o[c(1232)],weak:0,netlevel:5},s=l[c(1605)].network[c(1663)][e.id],a=l[c(1605)][c(1733)][c(758)][e.id];s&&(n[c(1518)]=l[c(1653)](e.id,!1),n[c(861)]=a&&a[c(598)]?1:0),d[c(1065)][c(649)](n)}const f={publishID:e[c(1390)],subscribeID:e.id,audio:null,video:null};if(u){const e=l[c(890)][n[c(1144)]];f.audio={bps:e&&e[c(1542)]?Math[c(1395)]((n.bytesReceived-e.audio[c(1213)])/(n[c(1545)]-e[c(1542)][c(1545)])*1e3):0,audiolevel:Math[c(1395)](100*n[c(1800)]),codec:s?s[c(1480)][c(997)]("/")[1]+"/"+s[c(1116)]+" ("+s[c(535)]+", "+s.sdpFmtpLine+")":"",pktslost:n.packetsLost},l[c(890)][n[c(1144)]]={audio:n}}if(p){const o=l[c(890)][r[c(1144)]];f[c(1063)]={width:r[c(811)],height:r.frameHeight,bps:o&&o[c(1063)]?Math[c(1395)]((r.bytesReceived-o[c(1063)][c(1213)])/(r[c(1545)]-o[c(1063)].timestamp)*1e3):0,fps:r[c(1510)],codec:i?i.mimeType[c(997)]("/")[1]+"/"+i[c(1116)]+" ("+i.payloadType+", "+i.sdpFmtpLine+")":-1,layerindex:e[c(1368)],ssrc:r[c(1144)],delay:o&&o[c(1063)]?Math[c(1395)]((r[c(1882)]-o[c(1063)].jitterBufferDelay)/(r.jitterBufferEmittedCount-o[c(1063)][c(1029)])*1e3):0,jitter:r[c(554)],pktslost:r.packetsLost,nack:r[c(1903)],mfsip:a?a.ip+":"+a[c(1473)]:"",pli:r[c(595)],fir:r[c(1561)],bwrecv:t[c(1045)]},l.qosHistroyData[r[c(1144)]]={video:r}}return(f[c(1542)]||f[c(1063)])&&d[c(1301)][c(649)](f),l[c(1158)]({streamInfo:e,pair:t,audioEnable:u,videoEnable:p,audio:n,video:r}),d},l[o(933)]=function({streamInfo:e,pair:t,videoOutList:r,audioOut:n,videoRemoteInList:i,audioRemoteIn:s,audioSource:a,videoSource:c,videoCodec:d,audioCodec:u,remoteCandidate:p}){const m=o,f={log:[],report:[]},b=(s||n||a)&&!(e[m(504)]||e.systemMuteAudio),y=r.length>0&&!(e[m(1870)]||e[m(1796)]);if(!t)return f;const v={...l.wrapBaseData({eventCode:"203001",streamInfo:e}),userid:l[m(1605)][m(1322)],roomid:l[m(1605)][m(1309)],username:l[m(1605)][m(681)],serviceid:l[m(1558)][m(1353)],streamid:e.id,layerindex:e.layerIndex,mediatype:-1,codec:-1,ssrc:-1,mute:-1,rtt:-1,pktslost:-1,width:-1,height:-1,fps:-1,pli:-1,fir:-1,cpu:-1,memory:-1,netmode:-1,bwsend:-1,bwtransmit:-1,bwretransmit:-1,bwtarget:-1,bwactual:-1,bytessent:-1,pktssent:-1,fpscap:-1,nack:-1,encodetime:-1,audiolevel:-1,remb:-1,restecho:-1,restechomax:-1,innoise:-1,outnoise:-1,reqlayerindex:-1,netlevel:-1,weak:-1,codecname:-1};if(p&&(e.mfsip=p.ip+":"+p[m(1473)]),b){const t=l[m(890)][n[m(1144)]],r=t?t.audioOut:{nackCount:0},o=t&&t[m(1227)]?t[m(1227)]:{packetsLost:0},i={...v,mediatype:l.MediaType[m(1133)],mute:e[m(504)]?1:0,reqlayerindex:e[m(1368)],netlevel:5,weak:0};a&&(i[m(1333)]=a[m(1800)]),n&&(i[m(1144)]=n[m(1144)],i[m(1451)]=n[m(1183)],i.pktssent=n[m(915)],i[m(1717)]=n[m(1831)],i[m(1038)]=n.nackCount-r[m(1903)]),s&&(i[m(1144)]=s[m(1144)],i[m(1404)]=s[m(965)],i[m(746)]=s[m(505)]-o.packetsLost,s[m(1921)]&&(i[m(630)]=1e3*s[m(1921)])),u&&(i[m(1531)]=""+u[m(1480)][m(997)]("/")[1]),f.log[m(649)](i)}y&&r.forEach(((r,o)=>{const n=m,s=i[n(719)]((e=>e[n(1144)]===r[n(1144)]));if(s&&e[n(1368)]>=o){const i=l[n(890)][r[n(1144)]],a=i?i.videoOut:{firCount:0,pliCount:0,nackCount:0},u=i?i[n(1832)]:{packetsLost:0},p={...v,layerindex:o,mediatype:e[n(1049)]===l[n(932)][n(1013)]?l.MediaType[n(1013)]:l[n(1403)][n(977)],mute:e[n(1870)]?1:0,bwtarget:t[n(965)],bwsend:t[n(965)],fpscap:c[n(1510)],ssrc:r.ssrc,width:r[n(811)],height:r[n(663)],bytessent:r[n(1183)],pktssent:r.packetsSent,fps:r[n(1510)],fir:r.firCount-a[n(1561)],pli:r[n(595)]-a[n(595)],nack:r[n(1903)]-a[n(1903)],pktslost:s[n(505)]-u[n(505)],rtt:1e3*s.roundTripTime,reqlayerindex:e.layerIndex};i&&(p[n(1470)]=(r[n(530)]-i[n(1276)].framesEncoded)/(r[n(1545)]-i[n(1276)][n(1545)]));const m=l.core.network[n(581)][e.id],b=l[n(1605)][n(1733)][n(758)][e.id];m&&(p[n(1518)]=l[n(1653)](e.id,!0),b?p.weak=b[n(598)]?1:0:p[n(861)]=0),d&&(p[n(1531)]=""+d[n(1480)][n(997)]("/")[1]),l[n(890)][p.ssrc]={videoOut:r,videoRemoteIn:s,videoSource:c},f[n(1065)].push(p)}}));const g={publishID:e.id,audio:null,video:null};if(b){const e={bps:void 0,audiolevel:void 0,codec:void 0,pktslost:void 0};if(a&&(e.audiolevel=Math[m(1395)](100*a[m(1800)])),n){const t=l[m(890)][n[m(1144)]];!t&&(l[m(890)][n[m(1144)]]={}),e[m(847)]=t&&t[m(857)]?Math.floor((n[m(1183)]-t[m(857)][m(1183)])/(n[m(1545)]-t[m(857)][m(1545)])*1e3):0,l[m(890)][n[m(1144)]][m(857)]=n}s&&(e[m(746)]=s[m(505)],l[m(890)][n[m(1144)]][m(1227)]=s),u&&(e.codec=u[m(1480)][m(997)]("/")[1]+"/"+u[m(1116)]+" ("+u[m(535)]+", "+u[m(687)]+")"),g.audio=e}if(y){if(i[e[m(1368)]]){const o=r[e[m(1368)]],n=i[m(719)]((e=>e.ssrc===o[m(1144)])),s=l[m(890)][m(1301)+o[m(1144)]],a={width:o[m(811)],height:o.frameHeight,bps:void 0,fps:o[m(1510)],fpscap:c.framesPerSecond,codec:d?d.mimeType[m(997)]("/")[1]+"/"+d[m(1116)]+" ("+d[m(535)]+", "+d[m(687)]+")":void 0,layerindex:e[m(1368)],ssrc:o[m(1144)],rtt:1e3*n.roundTripTime,pktslost:n[m(505)],nack:o.nackCount,mfsip:p?p.ip+":"+p[m(1473)]:void 0,pli:o[m(595)],fir:o[m(1561)],bwsend:t[m(965)]};s&&(a[m(847)]=s&&s[m(1276)]?Math[m(1395)]((o.bytesSent-s[m(1276)].bytesSent)/(o[m(1545)]-s.videoOut[m(1545)])*1e3):0),l[m(890)][m(1301)+o[m(1144)]]={videoOut:o,videoRemoteIn:n},g[m(1063)]=a}}return(g[m(1542)]||g[m(1063)])&&f[m(1301)][m(649)](g),l[m(1481)]({streamInfo:e,videoOutList:r,audioOut:n,videoRemoteInList:i,videoSource:c,audioEnable:b,videoEnable:y}),f},l[o(1513)]=function(){return new Promise(((e,t)=>{const r=g;let o={log:[],report:[]},n=[];Object[r(1847)](l[r(1605)].publishers)[r(1278)]((e=>{const t=r;n[t(649)](new Promise((r=>{const n=t;if(!e.pc||e.pc[n(901)]!==n(1734))return r();e.pc.getStats().then((t=>{const i=n,s={streamInfo:e,video:null,audio:null,pair:null,audioCodec:null,videoCodec:null,remoteCandidate:null};t[i(1278)]((e=>{const t=i;e[t(1049)]===t(1153)&&e.state===t(494)?s[t(1345)]=e:e[t(1049)]===t(1602)?e.ssrc!==l[t(1605)][t(1585)]&&("video"===e.kind?e[t(792)]!==t(1866)&&(s[t(1063)]=e):s[t(1542)]=e):e[t(1049)]===t(1531)?e[t(1480)]===t(623)?s[t(610)]=e:e[t(1480)]===t(917)&&(s[t(506)]=e):e[t(1049)]===t(1074)&&e.ip&&-1===e.ip[t(1100)](t(1569))&&(s.remoteCandidate=e)}));const a=l[i(1520)](s);return a&&(o.log=o[i(1065)][i(1612)](a[i(1065)]),o[i(1301)]=o[i(1301)][i(1612)](a[i(1301)])),r()}))})))})),[l[r(1605)][r(1365)],l[r(1605)][r(1285)]][r(1612)](Object[r(1847)](l[r(1605)][r(1331)]))[r(1278)]((e=>{const t=r;e[t(1019)],e[t(1049)],e.preview&&e.pc&&e.pc[t(901)]===t(1734)&&n[t(649)](new Promise((r=>{const n=t;e.pc[n(682)]().then((t=>{const i=n,s={streamInfo:e,pair:null,videoOutList:[],audioOut:null,videoRemoteInList:[],audioRemoteIn:null,videoSource:null,audioSource:null,videoCodec:null,audioCodec:null,remoteCandidate:null};t.forEach((e=>{const t=g;"candidate-pair"===e[t(1049)]&&e[t(1241)]===t(494)?s[t(1345)]=e:e[t(1049)]===t(1351)?e[t(1661)]===t(1063)?s[t(1123)].push(e):s[t(1227)]=e:e.type===t(1046)?e.kind===t(1063)?s[t(1536)][t(649)](e):s.audioOut=e:"media-source"===e[t(1049)]?"video"===e[t(1661)]?s[t(1570)]=e:s[t(1503)]=e:e[t(1049)]===t(1531)?e.mimeType===t(623)?s[t(610)]=e:"video/H264"===e[t(1480)]&&(s[t(506)]=e):e.type===t(1074)&&e.ip&&-1===e.ip[t(1100)](t(1569))&&(s.remoteCandidate=e)}));const a=l[i(933)](s);return a&&(o[i(1065)]=o.log.concat(a.log),o[i(1301)]=o[i(1301)][i(1612)](a[i(1301)])),r()}))})))})),Promise[r(1355)](n).then((()=>{e(o)}))}))},l[o(1481)]=function({streamInfo:e,videoOutList:t,audioOut:r,videoRemoteInList:n,videoSource:i,audioEnable:s,videoEnable:a}){const c=o;if(-1===e[c(1368)])return;const d=l[c(890)][e.id]||(l[c(890)][e.id]={}),u=d[c(1368)]!==e[c(1368)];let p=null,m=null,f=null;if(d[c(1368)]=e[c(1368)],r&&s&&(d[c(1550)](c(670))&&!e[c(504)]&&(d[c(670)]>=r.packetsSent?d.audioNoSentTimes?d.audioNoSentTimes++:d[c(592)]=1:d.audioNoSentTimes=0,d[c(592)]>=2&&(m={errorType:l[c(1686)].Audio,errorCode:l[c(1641)].Media[c(1702)],errorDesc:c(520)})),d[c(670)]=r[c(915)]),e[c(1049)]===l[c(932)][c(1013)]){const t=-1===e[c(1368)]?0:e[c(1368)];p=l[c(1558)].screenLayers[t]}else{const t=-1===e[c(1368)]?0:e.layerIndex;p=l[c(1558)][e[c(1019)]?c(1544):"cameraLayers"][t]}if(i&&a&&i.framesPerSecond<p.frameRate/2&&e[c(1049)]!==l[c(932)][c(1013)]&&(f={errorType:l[c(1686)][c(977)],errorCode:l.LogErrorCode.Media.Capturer,errorDesc:c(1552)}),!f&&a&&n[c(1840)]>0){let r=0;t[c(1278)](((t,o)=>{const n=c;if(0===o){const r="videoEncode"+t[n(1144)];if(d[n(1550)](r)&&!u){Math[n(1395)]((t[n(530)]-d[r][n(530)])/(Date[n(1913)]()-d[r].timestamp)*1e3)<p[n(1914)]/2&&e.type!==l[n(932)][n(1013)]&&(f={errorType:l[n(1686)][n(977)],errorCode:l[n(1641)][n(534)][n(565)],errorDesc:"编码异常"})}else d[r]={};d[r].timestamp=Date.now(),d[r][n(530)]=t[n(530)]}r+=t.packetsSent})),!f&&(d.hasOwnProperty(c(1607))&&(d.videoPacketsSent>=r?d[c(1131)]?d[c(1131)]++:d.videoNoSentTimes=1:d.videoNoSentTimes=0,d.videoNoSentTimes>=2&&(m={errorType:l[c(1686)][c(977)],errorCode:l[c(1641)].Media[c(1702)],errorDesc:c(1087)})),d[c(1607)]=r)}m?(l[c(1793)](l[c(1251)][c(1619)],m),l[c(1264)](e,l.StreamTrack[c(1133)],!0,m)):l.emitPeerError(e,l.StreamTrack[c(1133)],!1),f?(l[c(1793)](l.LogType[c(1619)],f),l[c(1264)](e,l[c(698)][c(977)],!0,f)):l[c(1264)](e,l.StreamTrack[c(977)],!1)},l[o(1158)]=function({streamInfo:e,pair:t,video:r,audio:n,audioEnable:s,videoEnable:a}){const c=o,d=l[c(890)][e.id]||(l[c(890)][e.id]={});let u=null,p=null;n&&s&&(d.hasOwnProperty(c(1284))&&!e[c(504)]&&!e[c(1681)]&&(d[c(1284)]>=n[c(1589)]?d.audioNoRcvdTimes?d[c(557)]++:d[c(557)]=1:d[c(557)]=0,d[c(557)]>=2&&(u={errorType:l.LogErrorType[c(1133)],errorCode:l.LogErrorCode[c(534)].Receiver,errorDesc:"音频流无接收数据"})),d[c(1284)]=n[c(1589)]),r&&a&&(d[c(1550)](c(683))&&!e[c(1870)]&&!e.localMuteVideo&&(d.videoPktsRcvd>=r[c(1589)]?d[c(1235)]?d[c(1235)]++:d[c(1235)]=1:d[c(1235)]=0,d[c(1235)]>=2&&(p={errorType:l[c(1686)][c(977)],errorCode:l[c(1641)].Media.Receiver,errorDesc:c(1392)})),d.videoPktsRcvd=r[c(1589)],d.hasOwnProperty(c(1453))&&!e[c(1870)]&&!e[c(962)]&&!p&&d.videoFramesDecoded>=r[c(561)]&&(p={errorType:l[c(1686)].Video,errorCode:l[c(1641)][c(534)][c(1902)],errorDesc:"视频流解码无输出帧"}),d.videoFramesDecoded=r.framesDecoded),u?(i.logInfo(JSON.stringify(u),"audioPktsRcvd: "+d.audioPktsRcvd),l[c(1793)](l[c(1251)][c(1619)],u),l[c(1264)](e,l[c(698)][c(1133)],!0,u)):l.emitPeerError(e,l.StreamTrack[c(1133)],!1),p?(i[c(1134)](JSON[c(1857)](p),c(1026)+d[c(683)],c(1597)+d[c(1453)]),l[c(1793)](l[c(1251)].Error,p),l[c(1264)](e,l[c(698)][c(977)],!0,p)):l[c(1264)](e,l.StreamTrack[c(977)],!1)},l[o(1264)]=function(e,t,r,n){const a=o;let c=l[a(1605)].peerErrorEvent[e.id],d={streamID:e.id,isAudio:t===l.StreamTrack.Audio,isVideo:t===l[a(698)][a(977)],isError:r};!c&&(c={},l[a(1605)][a(1402)][e.id]=c),r?(c[t]=!0,l[a(1558)][a(1402)]&&s.emit(s.Event[a(1053)],{...d,...n})):c[t]&&(c[t]=!1,l[a(1558)][a(1402)]&&s[a(676)](s[a(1211)][a(1053)],{...d}),i[a(1134)](" "+t+a(745)))},l[o(926)]=function({eventCode:r,streamInfo:n}){const i=o;return{logstamp:i(1486),version:i(1445),eventcode:r,eventtime:Date[e(1913)](),devicetype:l.core.dType,versionrtc:t,sessionid:l[i(1605)].session,eventtype:r[i(849)](0,3),eventpos:r[i(849)](r[i(1840)]-3,r.length),peerdevicetype:n&&!n[i(1137)]?n[i(1690)]:-1,streamtype:n?n[i(1049)]===l[i(932)][i(910)]?1:2:-1}},l.wrapUserActionData=function(e,t){const r=o,{action:n,streamInfo:i}=t,s={...l[r(926)]({eventCode:e,streamInfo:i}),userid:l[r(1605)][r(1322)],roomid:l[r(1605)][r(1309)],serviceid:l[r(1558)][r(1353)],userevent:n,mediatype:-1,mute:-1,streamid:-1,layerscount:-1,layerindex:-1,netmode:-1,peeruserid:-1,duration:-1,bmcsip:-1};switch(n){case l[r(584)].Joined:const e=l.core.userActionData[r(740)];s.duration=e.joinEnd-e[r(656)],delete l[r(1605)][r(1315)][r(740)];break;case l[r(584)][r(1234)]:break;case l[r(584)][r(528)]:s[r(1791)]=i.id,s[r(1418)]=l[r(797)](i).length,s[r(634)]=i[r(1368)]||0;const o=l.core[r(1315)]["publish-"+i.id];s[r(1387)]=o[r(1405)]-o[r(1497)],i[r(504)]&&i[r(1870)]?delete l[r(1605)][r(1315)]["publish-"+i.id]:l[r(1058)](i);break;case l[r(584)].Unpublished:s[r(1791)]=i.id,s[r(1418)]=l[r(797)](i).length,s[r(634)]=i[r(1368)]||0;const n=l[r(1605)][r(1315)][r(772)+i.id];s.duration=n[r(941)]-n[r(1662)],delete l.core[r(1315)][r(772)+i.id];break;case l[r(584)].Subscribed:s[r(1791)]=i.id,s[r(1418)]=i[r(1021)].length,s[r(634)]=i[r(1368)],s[r(1668)]=i[r(943)];const a=l[r(1605)][r(1315)][r(1118)+i[r(1390)]];s.duration=a[r(1523)]-a[r(1548)],i[r(504)]&&i.muteVideo?delete l[r(1605)][r(1315)][r(1118)+i[r(1390)]]:l.checkStreamFirstDownload(i);break;case l[r(584)][r(705)]:s[r(1791)]=i.id,s[r(1418)]=i.layers[r(1840)],s[r(634)]=i[r(1368)];const c=l[r(1605)][r(1315)]["unsubscribe-"+i.id];s[r(1387)]=c[r(1104)]-c[r(526)],s.peeruserid=i[r(943)],delete l[r(1605)].userActionData["unsubscribe-"+i.id];break;case l.UserAction[r(1859)]:s[r(1791)]=i.id,s.layerscount=l[r(797)](i)[r(1840)],s[r(634)]=i[r(1368)]||0;const d=l[r(1605)][r(1315)][r(1465)+i.id];s[r(1387)]=d[r(519)]-d[r(1497)],delete l[r(1605)].userActionData["publish-"+i.id];break;case l[r(584)][r(1594)]:s.streamid=i.id,s[r(1418)]=i.layers[r(1840)],s[r(634)]=i[r(1368)],s[r(1668)]=i[r(943)];const u=l.core[r(1315)]["subscribe-"+i[r(1390)]];s[r(1387)]=u[r(1896)]-u[r(1548)],delete l[r(1605)][r(1315)][r(1465)+i.publishID];break;case l.UserAction[r(1441)]:s[r(931)]=t[r(1782)],s.streamid=i.id,s.layerscount=l[r(797)](i)[r(1840)],s[r(634)]=i[r(1368)]||0,s[r(1130)]=(s.mediatype===l[r(1403)][r(1133)]?i[r(504)]||i[r(1681)]:i[r(1870)]||i[r(962)])?1:0,i[r(943)]&&(s[r(1668)]=i[r(943)])}return s},l[o(1165)]=function(e){const t=[];return e.forEach((e=>{const r=g,{streamInfo:o}=e,n={...l[r(926)]({eventCode:e[r(1782)]==l[r(1403)][r(1133)]?r(1739):"203007",streamInfo:o}),userid:l[r(1605)][r(1322)],roomid:l.core.roomName,serviceid:l[r(1558)].serviceID,username:l[r(1605)][r(681)],streamid:o.id,mediatype:e[r(1782)],mute:e.mute,peeruserid:o[r(943)],stuckcount:e.stuckCount,stuckduration:e[r(1378)],spanduration:e[r(1576)],playduration:e.playDuration,weakduration:e.weakDuration,cpu:-1,memory:-1,netmode:-1};e[r(1782)]!==l[r(1403)][r(1133)]&&(n[r(634)]=o[r(1368)]),t[r(649)](n)})),t},l[o(1587)]=function(e,t){const r=o,{errorType:n,errorCode:s,errorDesc:a,streamInfo:c}=t,d={...l[r(926)]({eventCode:e,streamInfo:c}),userid:l.core.userID,roomid:l.core[r(1309)],serviceid:l[r(1558)][r(1353)],streamid:c?c.id||c[r(1923)]:-1,peeruserid:c?c.local?-1:c.uid:-1,errtype:n,errcode:s,errdesc:a,mfsip:c&&c[r(680)]?c[r(680)]:-1,netmode:-1};return l[r(1558)].debug&&i[r(1908)](r(1270)+d[r(1774)]+r(1617)+d[r(1525)]+r(1813)+d[r(1578)]),d},l.routineCheckStreamFirstUpload=function(e){const t=o;!e[t(784)]&&e.pc&&(!l.core[t(1315)][t(1465)+e.id]&&(l[t(1605)][t(1315)][t(1465)+e.id]={}),l[t(1605)][t(1315)][t(1465)+e.id][t(1497)]=Date[t(1913)](),l.checkStreamFirstUpload(e))},l[o(1058)]=function(e){const t=o;if(!e.pc||e[t(504)]&&e[t(1870)])return;const r=e.pc[t(626)]();if(!r||0===r[t(1840)])return;e[t(784)]=!0;let n=r[0];r[t(1840)]>1&&r[t(1278)]((r=>{const o=t;r[o(1037)]&&(e.subType===l.SubStreamType[o(1340)]?"video"===r[o(1037)][o(1661)]&&(n=r):r.track[o(1661)]===(e[o(1870)]||!e[o(504)]&&-1===e[o(1368)]?o(1542):o(1063))&&(n=r))}));let i=0;const s=setInterval((()=>{const r=t;e[r(504)]&&-1===e.layerIndex?(i++,i>4&&(clearInterval(s),delete l[r(1605)][r(1315)]["publish-"+e.id],e[r(784)]=!1)):i<40?(i++,n[r(682)]()[r(1217)]((t=>{const o=r,i=[];let a=0;t[o(1278)]((e=>{const t=o;e[t(1049)]===t(1046)&&i[t(649)](e)})),i.forEach((e=>{const t=o;a+=n.track[t(1661)]===t(1063)?e[t(525)]:e[t(915)]})),a>0&&(clearInterval(s),l.core[o(1315)]["publish-"+e.id][o(519)]=Date[o(1913)](),l[o(1793)](l[o(1251)][o(584)],{action:l.UserAction[o(1859)],streamInfo:e}))}))):(clearInterval(s),l[r(1605)].userActionData[r(1465)+e.id][r(519)]=Date[r(1913)](),l.triggerLogUpload(l[r(1251)].UserAction,{action:l[r(584)][r(1859)],streamInfo:e}))}),50)},l[o(1159)]=function(e){const t=o;if(!e.pc)return;const r=e.pc.getReceivers();if(!r||0===r.length)return;let n=r[0];r.length>1&&r[t(1278)]((r=>{const o=t;r.track[o(1661)]===(e[o(1870)]?"audio":o(1063))&&(n=r)}));let i=0;const s=setInterval((()=>{const r=t;i<10?(i++,n[r(682)]()[r(1217)]((t=>{const o=r,i=[];let a=0;t[o(1278)]((e=>{const t=o;e[t(1049)]===t(1602)&&e[t(1144)]!==l[t(1605)][t(1585)]&&i[t(649)](e)})),i[o(1278)]((e=>{const t=o;a+=n[t(1037)][t(1661)]===t(1063)?e.keyFramesDecoded:e.packetsReceived})),a>0&&(clearInterval(s),l[o(1605)].userActionData[o(1118)+e[o(1390)]].downloadTime=Date[o(1913)](),l[o(1793)](l[o(1251)][o(584)],{action:l[o(584)].firstDataDownloaded,streamInfo:e}))}))):(clearInterval(s),l[r(1605)][r(1315)]["subscribe-"+e.publishID][r(1896)]=Date[r(1913)](),l[r(1793)](l[r(1251)][r(584)],{action:l.UserAction[r(1594)],streamInfo:e}))}),50)},l.joinRoom=function(e,t,r,n,s,a=!1){const c=o;if(a){if(!l[c(1605)][c(1698)]||l.ws&&l.ws.readyState===WebSocket[c(1059)])return void i.logError(c(1648)+l[c(1605)][c(1698)]+", "+(l.ws?c(1433)+(l.ws[c(1887)]===WebSocket[c(1059)]):c(869)))}else{if(l[c(1605)][c(1309)]&&l[c(1605)][c(1309)]!==e||l[c(1605)][c(1322)]&&l[c(1605)][c(1322)]!==t)return l[c(1140)](),l[c(1282)](e,t,r,s,n);if(1===l.core.status)return i[c(1908)]("you were in room already"),l[c(1500)](l.ErrorCode[c(1196)],c(1885));l[c(816)](),l.setCore({roomName:e,userID:t,userName:r,userArea:n,userRole:s})}!l.core[c(1315)][c(740)]&&(l[c(1605)][c(1315)][c(740)]={}),l[c(1605)][c(1315)][c(740)][c(656)]=Date.now();let d={reqId:S(),roomName:l[c(1605)][c(1309)]};l[c(1558)][c(1476)]?d[c(1279)]=l[c(1605)][c(1634)]:(d[c(1584)]=l.core[c(1584)],d[c(668)]=l[c(1605)][c(668)],d.countryCode=l[c(1605)].countryCode,d.regionCode=l[c(1605)][c(1430)],d[c(1172)]=l[c(1605)][c(1172)],i[c(1134)](c(1208),l.core[c(1584)],l[c(1605)][c(668)],l[c(1605)][c(1541)],l[c(1605)].regionCode,l[c(1605)].cityCode));let u={Authorization:D(l.core,l[c(1558)],l.localLog)};l.httpRequest(c(1829),l[c(1558)][c(1124)][c(831)],d,u,(function(e){const t=c;return e&&e[t(1659)]!==t(904)?(i[t(1908)](t(1249)+e[t(1411)]),l[t(1500)](l[t(1751)][t(1196)],"room response error"),void l.triggerLogUpload(l[t(1251)][t(1619)],{errorType:l[t(1686)][t(619)],errorCode:l[t(1641)].Rtc.Token,errorDesc:t(1479)})):e[t(1550)](t(913))&&e[t(913)][t(1550)](t(1615))?void l[t(1775)](e[t(913)][t(1615)],a):(i[t(1908)]("room service response error, no token info"),l.emitError(l.ErrorCode[t(1196)],t(1568)),void l[t(1793)](l.LogType[t(1619)],{errorType:l[t(1686)][t(619)],errorCode:l[t(1641)].Rtc[t(1754)],errorDesc:t(1568)}))}),(function(o,u,p){const m=c;if(o instanceof Object&&401===o[m(1659)]){const c=Date[m(864)](o[m(1224)](m(513)))||0;if(c>0){const o=Date[m(1913)]();if(Math[m(1575)](c-o-l[m(1558)][m(583)])>6e4)return l.options[m(583)]=c-o,i[m(1446)](m(1600)+o+",",m(1729)+c+",","diff="+l[m(1558)][m(583)]),l[m(1282)](e,t,r,n,s,a)}}return i[m(1908)](m(1574)+(o[m(1030)]||o)+m(1747)+JSON.stringify(d)),a?l.reconnect():(l[m(1793)](l[m(1251)].Error,{errorType:l.LogErrorType.Rtc,errorCode:l[m(1641)][m(619)][m(1754)],errorCode:m(1257)+o[m(1659)]}),l[m(1500)](l[m(1751)][m(1196)],m(1329)))}))},l[o(984)]=function(e,t,r,n,s,a){const c=o;if(l[c(1605)].ipInfoRetryCount=0,l[c(1558)][c(1476)])return i[c(1134)]("joinRoom with force areaCode:"+n),this.joinRoom(e,t,r,n,s,a);l.requestIpInfo(e,t,r,s,a)},l[o(1768)]=function(e,t,n,s,a){const c=o;let d={msgId:S()};jhkSign(d,{appKey:"commonweb",postAndJSON:!0});const u={method:c(1829),url:l[c(1449)](l[c(1558)][c(1124)][c(1539)]),timeout:l[c(1558)][c(971)],contentType:c(575)};let p={};p.appKey=c(1694),p[c(787)]=jhkSign(d,{appKey:c(1694),postAndJSON:!0}),p instanceof Object&&Object.keys(p)[c(1840)]>0&&(u[c(935)]=p),u[c(1238)]=JSON.stringify(d),r(u)[c(1217)]((r=>{!function(r){const o=g;if(r[o(1659)]!==o(904)){if(i[o(1908)](o(1391)+JSON[o(1857)](r)),l[o(1605)][o(679)]<l.core[o(1220)]){let i=1e3;return 0<l[o(1605)][o(679)]&&(i=3e3*l.core.ipInfoRetryCount),setTimeout((function(){const r=o;l[r(1605)][r(679)]=l[r(1605)].ipInfoRetryCount+1,l[r(1768)](e,t,n,s,a)}),i),l.emitError(l[o(1751)][o(499)],o(1072)+i+o(1618)+l.core.ipInfoRetryCount+o(930)+r[o(1411)])}return l.emitError(l[o(1751)][o(499)],o(567)+l.core.ipInfoMaxRetryCount+", msg:"+r[o(1411)])}if(!r[o(1550)](o(1604)))return l[o(1500)](l.ErrorCode.ConnectionError,o(1517)+JSON.stringify(r));if(!(r.cityInfo[o(1550)](o(1096))&&r[o(1604)].hasOwnProperty(o(668))&&r.cityInfo[o(1550)](o(1541))&&r.cityInfo[o(1550)](o(1430))&&r[o(1604)][o(1550)](o(1172))))return l.emitError(l.ErrorCode[o(751)],o(1517)+JSON[o(1857)](r)),l[o(1768)](e,t,n,s,a);l[o(1605)][o(1584)]=r[o(1604)][o(1096)];let c=parseInt(r[o(1604)][o(668)]);l[o(1605)][o(668)]=c[o(1644)]();let d=parseInt(r[o(1604)].countryCode);l[o(1605)][o(1541)]=d[o(1644)]();let u=r.cityInfo[o(1430)],p=r.cityInfo[o(1172)];u[o(1840)]>=2&&(l[o(1605)][o(1430)]=parseInt(u[o(849)](0,2))[o(1644)]()),p.length>=4&&(l[o(1605)].cityCode=parseInt(p[o(849)](2,4))[o(1644)]()),i[o(1134)](o(1362)+JSON[o(1857)](r)),l[o(1282)](e,t,n,l[o(1064)][o(515)],s,a)}(r)})).catch((r=>{!function(r,o,c){const d=g;if(i.logError(d(735),r,o,c),l.core[d(679)]<l.core[d(1220)]){let o=1e3;return 0<l[d(1605)][d(679)]&&(o=3e3*l[d(1605)][d(679)]),setTimeout((function(){const r=d;l[r(1605)][r(679)]=l.core[r(679)]+1,l[r(1768)](e,t,n,s,a)}),o),l.emitError(l[d(1751)].RequestIpInfoErr,d(1072)+o+d(1618)+l[d(1605)].ipInfoRetryCount+d(738)+JSON[d(1857)](r))}l.emitError(l[d(1751)].RequestIpInfoErr,d(1655)+l[d(1605)][d(1220)]+", err:"+JSON[d(1857)](r))}(r)})),i.logInfo(c(1004)+JSON[c(1857)](u))},l[o(1140)]=function(e=!0){const t=o;l[t(611)]&&(clearInterval(l[t(611)]),delete l.ping),l[t(492)]&&clearTimeout(l[t(492)]),l.ws&&(l.ws[t(1887)]===WebSocket[t(1059)]?l[t(1749)]():l.ws[t(967)](),l[t(1605)][t(1698)]&&l[t(1793)](l[t(1251)][t(584)],{action:l[t(584)].Leave})),l[t(1605)].status=0,e&&(l[t(1605)][t(1698)]="",l[t(1605)][t(1322)]="",l[t(1605)][t(681)]="",l[t(1605)][t(1309)]=""),l[t(929)](),l[t(1605)][t(820)]=!1,l[t(1605)][t(781)]=[],l[t(1605)][t(1315)]={},l.core[t(1402)]={},l[t(640)](),l[t(1657)](!1)},l.getCurrentScriptURL=function(){const e=o;if(document[e(1429)])return document[e(1429)][e(1899)];try{throw new Error}catch(t){try{let r=t[e(1254)].match(/([^ \n])*([a-z]*:\/\/\/?)*?[a-z0-9\/\\]*\.js/gi)[0];if(r)return["(",")","@"][e(1278)]((e=>{r=r.replaceAll(e,"")})),r}catch(t){i.logWarn(e(1764)+t)}}let t=document[e(1716)](e(821));return t[e(1840)]>0?t[t[e(1840)]-1].src:void 0},l[o(1557)]=function(){return new Promise((e=>{const t=g;if(l[t(1393)])e();else if(c)if(l.audioContext=new c,i[t(1134)](t(1792)),u){let r=t(1834),o=null;o=setTimeout((()=>{const r=t;i[r(1446)](r(1048)),e()}),200);try{l[t(1393)][t(1294)][t(1102)](r)[t(1217)]((()=>{i.logInfo("audioContext add module success"),clearTimeout(o),e()})).catch((r=>{const n=t;u=null,i[n(1446)]("can not add module to audio worklet,",r[n(1644)]()),clearTimeout(o),e()}))}catch(r){u=null,i[t(1446)](t(1723),r[t(1644)]()),clearTimeout(o),e()}}else e();else i.logError(t(817)),e()}))},l[o(1631)]=function(e="",t=""){const r=o;if(!l[r(1558)][r(1296)])return{video:!1};let n={},i=r(t?1544:1262),s=l.options[i].slice(-1)[0][r(559)]||1280,a=l[r(1558)][i][r(830)](-1)[0].height||720,c=l[r(1558)][i][r(830)](-1)[0].frameRate||30,d={width:s,height:a,aspectRatio:1.7777777777777777,frameRate:{min:c>>1,ideal:c},facingMode:l.core[r(1365)].facingMode};return M[r(637)]&&delete d[r(1914)][r(887)],Object[r(1323)](d).forEach((e=>{l[r(819)](e)&&(n[e]=d[e])})),e&&(n[r(1260)]=e),0===Object.keys(n)[r(1840)]?{video:!0}:(n[r(1260)]&&l[r(1780)](n),{video:n})},l[o(1347)]=function(e=""){const t=o;if(!l[t(1558)][t(1880)])return{audio:!1};let r={},n={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0};return Object.keys(n).forEach((e=>{l[t(819)](e)&&(r[e]=n[e])})),e&&(r[t(1260)]=e),0===Object[t(1323)](r)[t(1840)]?{audio:!0}:(r[t(546)]&&!l[t(1558)][t(546)]&&(r.autoGainControl=!1),r[t(1798)]&&!l.options.echoCancellation&&(r.echoCancellation=!1),r.noiseSuppression&&!l[t(1558)][t(762)]&&(r[t(762)]=!1),{audio:r})},l.adaptVideoConstraints=function(e){const t=o,r=[{name:t(807),width:1920,height:1080,frameRate:30}],n=l[t(1605)][t(1910)][t(998)].videoinput;if(!n||0===n[t(1840)])return;const i=l[t(1605)].devices[t(998)][t(1560)][t(719)]((t=>t.id==e.deviceId));i&&r[t(1278)]((r=>{const o=t;-1!==i.name.indexOf(r.name)&&(e[o(559)]=r[o(559)],e[o(958)]=r.height,e[o(1914)]={min:r[o(1914)]>>1,ideal:r[o(1914)]})}))},l[o(1373)]=function(e,t,r){const n=o;e?(i[n(1134)]("trackInfo:"+t+n(1040)+e[n(1661)]+n(614)+e[n(730)]+n(946)+e[n(1917)]+n(804)+e[n(1895)]+n(1573)+e[n(1887)]),e[n(1658)]=t=>{const r=n;i.logWarn(r(1516)+e[r(1661)]+",enabled:"+e.enabled,t)},e[n(703)]=t=>{const r=n;i[r(1446)](r(1455)+e.kind+r(946)+e[r(1917)]+r(1573)+e[r(1887)],t)},e.onmute=t=>{const o=n;i.logWarn(o(1864)+e.kind+",enabled:"+e[o(1917)]+",readyState:"+e[o(1887)],t),e[o(1661)]===l[o(698)].Video&&r[o(1744)]&&!r[o(1870)]&&(r.systemMuteVideo=!0,l.wsUpdate(r.id,r[o(1796)],r[o(504)]))},e.onunmute=t=>{const o=n;i.logWarn(o(1462)+e[o(1661)]+",enabled:"+e[o(1917)],t),e.kind===l.StreamTrack[o(977)]&&r[o(1744)]&&!r[o(1870)]&&r.systemMuteVideo&&(r[o(1796)]=!1,l[o(1125)](r.id,r[o(1796)],r[o(504)]))}):i[n(1446)](n(1806))},l[o(1579)]=function(e){const t=o;e&&(e[t(1658)]=null,e[t(703)]=null,e[t(1302)]=null,e[t(721)]=null)},l[o(1247)]=async function(e,t){const r=o;i.logInfo(r(1230)+e+r(1842)+t+")"),l[r(1452)]();let n={};e&&(n=Object[r(1509)](n,l[r(1347)]())),t&&(n=Object.assign(n,l[r(1631)]()));let a=null;try{i[r(1134)](r(700)+JSON[r(1857)](n)+")"),a=await navigator[r(1783)].getUserMedia(n),i[r(1134)](r(1830))}catch(o){return l[r(1201)](!e&&void 0,!t&&void 0),o instanceof Object&&o.name===r(1006)?(i[r(1446)](r(779),e,t),s[r(676)](s.Event[r(722)],e,t,!0,!1)):o instanceof Object&&"NotFoundError"===o.name?(i[r(1446)]("ask for permission error, no valid device,",e,t,n),s[r(676)](s[r(1211)].permission,e,t,!1,!1)):o instanceof Object&&o[r(1680)]===r(1229)?(e&&await l.initAudioContext(),l[r(1201)](!!e||void 0,!t&&void 0),i[r(1134)](r(1817),e,t,n),s[r(676)](s[r(1211)][r(722)],e,t,!0,!0)):(i[r(1908)](r(1394)+o[r(1644)](),n),s.emit(s[r(1211)][r(722)],e,t,!1,!1))}e&&await l[r(1557)](),s.emit(s[r(1211)][r(722)],e,t,!0,!0),l.stopMediaStream(a),l[r(1201)](!!e||void 0,!!t||void 0),i[r(1134)](r(1311))},l[o(1201)]=function(e,t){const r=o;typeof e===r(708)&&(l[r(1605)][r(722)].audio=e),typeof t===r(708)&&(l.core[r(722)][r(1063)]=t)},l[o(1630)]=function(e){const t=o;e&&(e[t(1318)](),l[t(1579)](e),e.kind===l.StreamTrack[t(1133)]&&s.emit(s[t(1211)][t(620)]))},l[o(1761)]=function(e){const t=o;e&&e.getTracks()[t(1278)]((e=>l.stopMediaTrack(e)))},l.replaceCustomTrack=function(){const e=o,t=l[e(1605)][e(1044)],r=t[e(736)],n=l[e(1558)][e(1826)][0];(n[e(559)]!==r[e(559)]||n[e(958)]!==r[e(958)])&&(r[e(1512)](e(559),n[e(559)]),r.setAttribute(e(958),n[e(958)]));try{t[e(1148)]&&(l[e(1630)](t[e(1148)]),t[e(539)][e(1808)](t[e(1148)]));const r=t[e(547)];let o=null;if(o=null==r[e(1894)]?r[e(551)]():r.mozCaptureStream(),t[e(1148)]=o[e(1023)]()[0],t[e(1148)]&&(t[e(539)][e(707)](t[e(1148)]),t.pc)){t.pc.getSenders()[e(719)]((t=>"audio"===(t[e(1037)]&&t[e(1037)][e(1661)])||!t[e(1037)]))[e(606)](t[e(1148)])}}catch(t){i[e(1908)](e(1621),t.toString())}},l[o(1436)]=function(){const e=o;l[e(1605)][e(1044)][e(1532)]=!0},l.checkVideoPlay=function(){const e=o,t=()=>{const e=g;l[e(1231)](),l[e(1605)].custom[e(547)][e(1868)](e(1219),t)};l[e(1605)][e(1044)].videoElem&&l[e(1605)].custom[e(1532)]&&l[e(1605)][e(1044)][e(547)][e(1337)]("canplay",t),l.core.custom.videoEnded=!1},l.addVideoEvent=function(e){const t=o;e&&(e[t(1337)](t(1803),l[t(1436)]),e.addEventListener(t(844),l[t(1197)]))},l[o(1776)]=function(e){const t=o;e&&(e[t(1868)](t(1803),l[t(1436)]),e.removeEventListener("play",l.checkVideoPlay))},l[o(1614)]=function(e){const t=o,r={audio:{trackName:"audioTrack",getTrackFunc:t(1023)},video:{trackName:t(1719),getTrackFunc:t(645)}};if(!e||Object.keys(r)[t(1100)](e)<0)return i[t(1446)]("replace stream track, bad track type");let n=r[e][t(1352)],s=r[e][t(1424)],a=l[t(1605)][t(1365)][t(539)][s](),c=a[t(1840)]>0;if(l.core.camera[n])l[t(1605)][t(1365)][t(539)][t(707)](l[t(1605)][t(1365)][n]),a[t(1278)]((e=>{const r=t;l[r(1605)].camera[r(539)][r(1808)](e),l[r(1630)](e)}));else for(let e=0,r=a.length;e<r;e++){let r=a[e];e>0&&l[t(1605)][t(1365)][t(539)][t(1808)](r),l[t(1630)](r)}return c},l[o(1677)]=async function(e=""){const t=o;if(!(Object[t(1847)](l[t(698)])[t(1100)](e)<0)&&l.core.camera.pc)if(e===l[t(698)].Audio){if(l.core[t(1365)][t(1148)]){let e=l.core.camera.pc[t(626)]()[t(719)]((e=>e[t(1037)]&&e.track[t(1661)]===t(1542)));if(e)try{await e.replaceTrack(l[t(1605)].camera[t(1148)])}catch(e){i.logError(t(1386),e.toString())}else l[t(1670)](l[t(932)][t(910)],l[t(1605)][t(1365)].id),l[t(1314)](l[t(932)][t(910)],"",l[t(1605)][l[t(932)][t(910)]].info?l[t(1605)][l[t(932)][t(910)]][t(1577)][t(1042)]:"")}}else if(l[t(1605)].camera.videoTrack){let e=l[t(1605)].camera.pc[t(626)]()[t(719)]((e=>e[t(1037)]&&"video"===e[t(1037)][t(1661)]));if(e)try{await e[t(606)](l[t(1605)][t(1365)][t(1719)])}catch(e){i[t(1908)](t(818),e[t(1644)]())}else l[t(1670)](l[t(932)].Camera,l[t(1605)][t(1365)].id),l[t(1314)](l[t(932)][t(910)],"",l[t(1605)][l[t(932)][t(910)]][t(1577)]?l.core[l[t(932)][t(910)]][t(1577)].app:"")}},l[o(552)]=function(e,t,r){const n=o,i=l[n(1605)][n(1044)],s=()=>{const t=n;l.replaceCustomTrack(),e.removeEventListener(t(1219),s)};r&&l[n(1487)]({customLayers:[...r]}),i[n(547)]===e?(e[n(793)](),e[n(1899)]=t,e[n(1337)]("canplay",s)):(i[n(547)][n(793)](),l[n(1776)](i[n(547)]),i[n(1148)]&&l[n(1630)](i[n(1148)]),i[n(547)]=e,l[n(1833)](i[n(547)]),e[n(1337)]("canplay",s),e[n(1899)]=t,l[n(851)](e),e.muted=!1)},l[o(987)]=async function(e){const t=o;if(Object[t(1847)](l.StreamTrack)[t(1100)](e)<0)return;const r=e+t(1874),n=e+t(1348),s="get"+k(e)+t(1443),a=t(631)+k(e)+"Tracks",c=e===l[t(698)][t(977)];let d=!1;const u=l.core[t(1910)][n];if(!u)return;const p=l[s](u);c&&M[t(963)]&&(d=l[t(1605)][t(1365)][r]&&l[t(1605)].camera[r].readyState===t(1884),d&&l[t(1630)](l[t(1605)][t(1365)][r]));try{let e=await navigator[t(1783)][t(776)](p);l[t(1630)](l.core[t(1365)][r]),l[t(1605)][t(1365)][r]=e[a]()[0],l[t(1373)](l.core[t(1365)][r],"cameraChangePreview",l[t(1605)][t(1365)])}catch(r){if(l[t(1605)][t(1910)][n]="",i.logError(r&&r[t(1680)]?r.name:r),c&&M.android&&d){const e=l[t(1631)](l[t(1605)][t(1910)][t(794)]),r=await navigator.mediaDevices[t(776)](e);l.core[t(1365)][t(1719)]=r[t(645)]()[0],l[t(1614)](l.StreamTrack[t(977)]),l[t(568)](l[t(1605)].camera[t(547)],l[t(1605)][t(1365)][t(539)]),l[t(1605)].camera.id&&await l[t(1677)](l.StreamTrack[t(977)])}return l[t(1500)](l.ErrorCode.SetDeviceError,{deviceType:e===l[t(698)][t(1133)]?l.DeviceType[t(969)]:l[t(1127)][t(1688)],deviceID:u,desc:t(809)+e+t(661)})}e===l[t(698)][t(1133)]?(await l[t(1557)](),l[t(1614)](e),l[t(1649)](l[t(932)].Camera)):(l[t(1614)](e),l.setVideoElementStream(l.core[t(1365)].videoElem,l[t(1605)][t(1365)][t(539)])),l[t(1605)][t(1365)].id&&await l[t(1677)](e)},l[o(851)]=function(e=null,t=!0,r=!1){const n=o;if(!(e&&e instanceof HTMLElement))return void i[n(1446)](n(754));t&&(e.muted=!0),e.controls=!1,e[n(607)]=!0,e[n(886)]=!0,e.setAttribute(n(1555),""),e[n(1512)]("x5-playsinline","");const s=()=>{const o=n;i[o(1134)](o(t?1063:1542)+o(1335)+(e.id||"")),!r&&l[o(852)](e,t),!t&&l.setElementSinkId(e,l[o(1605)][o(1910)][l[o(1127)][o(587)]]),e.removeEventListener(o(566),s)};e.addEventListener(n(566),s)},l.elementPlay=function(e,t){const r=o;e.play()[r(1217)]()[r(1549)]((o=>{const n=r;l[n(1605)][n(722)][n(539)]||(i[n(1908)](n(532)+(t?"video":n(1542))+" "+(e.id||"")+", "+o),l[n(1605)][n(920)][n(649)](e),s[n(676)](s[n(1211)][n(810)]))}))},l[o(780)]=async function(e,t){const r=o;if(!l[r(1558)][r(1084)]||!e)return void(e&&l[r(852)](e,t));if(M[r(659)]){const o=l.core[r(1365)];if(o[r(924)]&&o[r(1148)]&&"live"===o[r(1148)].readyState)return void l.elementPlay(e,t)}const n=l[r(1605)].permission;let i=null;try{n.stream?(i=n[r(539)],clearTimeout(n[r(1720)])):n[r(1542)]&&(i=await navigator[r(1783)][r(776)]({audio:!0}),n.stream=i),l[r(852)](e,t),i&&(n[r(1720)]=setTimeout((()=>{n[r(539)]=null,l.stopMediaStream(i)}),3e4))}catch(o){l[r(852)](e,t)}},l[o(1735)]=async function(e=null,t,r=!1,n=!1){const a=o;if(r||n)r&&l[a(987)](l[a(698)][a(1133)])[a(1217)](),n&&l[a(987)](l[a(698)].Video)[a(1217)]();else if(t){if(l[a(1605)].camera[a(924)]&&l[a(1605)][a(1365)][a(539)]&&(!e||l.core.camera[a(547)]===e))return i[a(1446)]("camera had been opened already"),l[a(1872)]({type:l[a(932)][a(910)],desc:a(783),error:{name:a(1598)}});if(!l[a(1558)][a(1880)]&&!l[a(1558)].cameraEnableVideo)return l[a(1872)]({type:l.StreamType[a(910)],desc:a(1308),error:{name:a(1024)}});if(!l[a(1605)][a(1910)][a(1408)]&&!l.core[a(1910)][a(1560)])return l[a(1872)]({type:l[a(932)][a(910)],desc:a(1138),error:{name:a(618)}});e instanceof HTMLElement&&e!==l[a(1605)][a(1365)][a(547)]&&(l[a(851)](e),l[a(1605)][a(1365)].videoElem=e);let t=l[a(1605)][a(1910)].videoinput?l.getVideoConstraints(l[a(1605)][a(1910)][a(1560)]):{video:!1},r=l[a(1605)].devices[a(1408)]?l.getAudioConstraints(l[a(1605)][a(1910)][a(1408)]):{audio:!1},o=!1,n=!1,c=null,d=null;if(t[a(1063)]){try{let e=await navigator[a(1783)].getUserMedia(t);l[a(1605)][a(1365)][a(1719)]=e[a(645)]()[0],o=!0,l[a(1373)](l.core[a(1365)].videoTrack,"cameraPreview",l.core[a(1365)])}catch(e){i.logError("open video input error, "+e[a(1644)](),t),o=!1,c=e}o&&(l[a(1614)](l[a(698)][a(977)]),l[a(568)](l.core[a(1365)][a(547)],l[a(1605)].camera[a(539)]),l[a(1558)].autoplayFix&&l.elementPlay(l[a(1605)][a(1365)].videoElem,!0))}if(r[a(1542)]){try{let e=await navigator[a(1783)].getUserMedia(r);l.core.camera[a(1148)]=e[a(1023)]()[0],n=!0,l[a(1373)](l.core[a(1365)][a(1148)],a(1735),l[a(1605)][a(1365)])}catch(e){i[a(1908)](a(1039)+e.toString(),r),n=!1,d=e}n&&(await l[a(1557)](),l[a(1614)](l[a(698)][a(1133)]),l[a(1649)](l[a(932)][a(910)]))}if(n||o)l[a(1605)][a(1365)][a(924)]=!0,s[a(676)](s[a(1211)][a(1365)],!0,n,o,l[a(1605)][a(1365)][a(539)]);else{let e=[];d&&e[a(649)]("audio input"),c&&e[a(649)](a(1253)),l[a(1872)]({type:l[a(932)][a(910)],desc:a(508)+e[a(740)](a(1753))+a(543),error:c||d})}}else l[a(1761)](l[a(1605)][a(1365)][a(539)]),l[a(1670)](l.StreamType[a(910)],l[a(1605)][a(1365)].id),l.core[a(1365)][a(924)]=!1,s[a(676)](s[a(1211)].camera,!1)},l.cameraPreviewEx=async function(e=null,t,r,n,a){const c=o;if(a){if(l[c(1605)].cameraEx[t]&&l[c(1605)].cameraEx[t].preview&&l[c(1605)][c(1331)][t].stream)return s[c(676)](s[c(1211)].cameraEx,a,l[c(1605)][c(1331)][t][c(539)]);!l[c(1605)].cameraEx[t]&&(l[c(1605)][c(1331)][t]={local:!0,tag:t,type:l.StreamType[c(910)],candidate:[],layerIndex:-1,info:{app:"",rtc:"",act:0}}),e instanceof HTMLElement&&e!==l[c(1605)][c(1331)][t][c(547)]&&(l.enableDomAutoPlay(e),l[c(1605)][c(1331)][t][c(547)]=e);let o=l[c(1558)][c(1544)][c(830)](-1)[0][c(559)],d=l[c(1558)][c(1544)][c(830)](-1)[0][c(958)],u=l.options.cameraExLayers[c(830)](-1)[0][c(1914)],p={video:{width:{ideal:o},height:{ideal:d},frameRate:{min:u>>1,ideal:u},aspectRatio:1.7777777777777777},audio:{autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0}};r?(p[c(1542)].deviceId={exact:r},l[c(1605)][c(1331)][t][c(1542)]=!0):(delete p[c(1542)],l[c(1605)][c(1331)][t].audio=!1),n?(p[c(1063)].deviceId=n,l.adaptVideoConstraints(p[c(1063)]),l[c(1605)][c(1331)][t].video=!0):(delete p[c(1063)],l[c(1605)][c(1331)][t][c(1063)]=!1);try{l.core[c(1331)][t].stream=await navigator.mediaDevices[c(776)](p),l.core[c(1331)][t][c(1719)]=l[c(1605)][c(1331)][t][c(539)].getVideoTracks()[0],n&&l[c(1373)](l[c(1605)][c(1331)][t].stream.getVideoTracks()[0],c(642),l[c(1605)].cameraEx[t]),r&&l[c(1373)](l[c(1605)][c(1331)][t][c(539)].getAudioTracks()[0],"cameraPreviewEx",l[c(1605)].cameraEx[t])}catch(e){i[c(1908)](c(1675)+e),l[c(1872)]({type:t,desc:c(1206),error:e})}if(await l[c(1557)](),l[c(568)](l.core[c(1331)][t][c(547)],l[c(1605)][c(1331)][t][c(539)]),!l[c(1605)][c(1331)][t].preview)return l[c(1605)][c(1331)][t][c(924)]=!0,s.emit(s[c(1211)].cameraEx,!0,t)}else l.core[c(1331)][t]&&(l.core[c(1331)][t].stream&&(l[c(1605)][c(1331)][t].stream[c(495)]()[c(1278)]((e=>{const t=c;e.onended=null,l[t(1630)](e)})),l[c(1605)][c(1331)][t][c(1744)]&&(l[c(1255)](l[c(1605)][c(1331)][t]),l[c(1670)](l[c(932)][c(910)],l[c(1605)][c(1331)][t].id,t))),l[c(1605)].cameraEx[t][c(924)]=!1),l[c(1649)](l[c(932)].Camera+"-"+t),s[c(676)](s[c(1211)][c(1331)],!1,t)},l.screenPreview=async function(e=null,t){const r=o;if(t){e instanceof HTMLElement&&e!==l.core[r(1285)].videoElem&&(l[r(851)](e),l[r(1605)].screen[r(547)]=e);let t={audio:l[r(1558)][r(1714)],video:l.options[r(1511)]};t[r(1063)]&&(t.video={frameRate:{ideal:l[r(1558)][r(1878)][0][r(1914)]}});try{l[r(1605)][r(1285)][r(539)]=await navigator.mediaDevices.getDisplayMedia(t)}catch(e){return i[r(1908)](r(1522)+e),e[r(1644)]()[r(1100)](r(1006))>=0?s[r(676)](s[r(1211)][r(1285)],!1):l[r(1872)]({type:l[r(932)][r(1013)],desc:"open screen error",error:e})}const o=l[r(1605)].screen.stream[r(1023)]()[0],n=l[r(1605)].screen[r(539)].getVideoTracks()[0];n[r(703)]=function(){const e=r;l[e(1670)](l[e(932)][e(1013)],l[e(1605)][e(1285)].id),l.core[e(1285)][e(924)]=!1,s[e(676)](s[e(1211)][e(1285)],!1,l[e(1605)][e(1285)].label||e(1843))},l.core[r(1285)][r(1699)]=n.getSettings()[r(1050)]||"monitor",l[r(1605)][r(1285)][r(1148)]=o,l[r(1605)].screen[r(1719)]=n,l.setVideoElementStream(l[r(1605)][r(1285)][r(547)],l.core[r(1285)][r(539)]),l[r(1605)][r(1285)][r(924)]=!0,s[r(676)](s[r(1211)][r(1285)],!0,l[r(1605)].screen.label||r(1843))}else l[r(1605)].screen[r(539)]&&(l.stopMediaStream(l[r(1605)][r(1285)][r(539)]),l[r(1670)](l[r(932)][r(1013)],l[r(1605)][r(1285)].id)),l.core[r(1285)].preview=!1,s[r(676)](s[r(1211)][r(1285)],!1,l[r(1605)][r(1285)][r(1699)]||r(1843))},l[o(1524)]=async function(e=null,t,r){const n=o;if(r){if(l[n(1605)][n(1331)][t]&&l[n(1605)][n(1331)][t][n(924)]&&l.core.cameraEx[t].stream)return s[n(676)](s[n(1211)][n(1189)],r,t);!l[n(1605)].cameraEx[t]&&(l[n(1605)][n(1331)][t]={local:!0,audio:l.options[n(1714)],video:l[n(1558)][n(1511)],tag:t,type:l[n(932)][n(1013)],candidate:[],layerIndex:-1,info:{app:"",rtc:"",act:0}});const o=l[n(1605)][n(1331)][t];e instanceof HTMLElement&&e!==o[n(547)]&&(l[n(851)](e),o[n(547)]=e);let a={audio:l[n(1558)][n(1714)],video:l[n(1558)][n(1511)]};a[n(1063)]&&(a.video={frameRate:{ideal:l.options[n(1878)][0][n(1914)]}});try{o[n(539)]=await navigator[n(1783)][n(1626)](a)}catch(e){if(i.logError(n(1726)+e),e.toString().indexOf(n(1006))>=0)return s[n(676)](s.Event.screenEx,!1,t);l[n(1872)]({type:t,desc:n(1400),error:e})}o[n(539)].getVideoTracks()[0][n(703)]=function(){const e=n;l[e(1670)](l[e(932)][e(1013)],o.id,o.tag),o[e(924)]=!1,s[e(676)](s.Event[e(1189)],!1,t,o.label||"share")},o.label=o[n(539)].getVideoTracks()[0][n(1088)]()[n(1050)]||n(1854),l.setVideoElementStream(o[n(547)],o[n(539)]),o[n(924)]=!0,s[n(676)](s[n(1211)][n(1189)],!0,t,o[n(1699)]||n(1843))}else{const e=l[n(1605)].cameraEx[t];e&&(e[n(539)]&&(l[n(1761)](e[n(539)]),l[n(1670)](l[n(932)][n(1013)],e.id,e[n(1019)])),e[n(924)]=!1),l[n(1649)](l[n(932)][n(1013)]+"-"+t),s[n(676)](s[n(1211)][n(1189)],!1,t)}},l.customPreview=function(e,t,r,n,a){const c=o;let d=l[c(1605)][c(1044)];if(r){if(d[c(924)])return s[c(676)](s[c(1211)].video,r,d[c(539)]);e[c(553)]("crossOrigin")!=c(1533)&&e[c(1512)](c(900),"anonymous"),e.src=t,d.tempVideoElem=e,d[c(1769)]=n,d[c(589)]=a,l[c(1833)](e),l.enableDomAutoPlay(e),e.muted=a,i[c(1134)](c(825)),clearInterval(d[c(1601)]),e.addEventListener("canplay",l.customCanPlay),e[c(844)](),d.waitStreamTimer=setTimeout((()=>{const t=c;d[t(547)].removeEventListener(t(1219),l[t(1354)]),l.cleanVideoEvent(e),l.emitPreviewError({type:l[t(932)].Screen,subType:l.SubStreamType[t(1340)],desc:t(1499),error:{name:"VideoError"}})}),5e3)}else{if(!d)return;d[c(547)]&&(d[c(547)][c(793)](),l[c(1776)](d[c(547)])),clearInterval(d.canvasTimer),clearInterval(d[c(1601)]),d[c(539)]&&(l.stopMediaStream(d[c(539)]),l[c(1670)](l[c(932)][c(1013)],d.id,"",l[c(978)][c(1340)])),l[c(1630)](d[c(1148)]),l[c(1630)](d[c(1719)]),d.audioTrack=null,d[c(1719)]=null,d[c(924)]=!1,s.emit(s[c(1211)][c(1044)],!1,d[c(1699)])}},l.customCanPlay=function(){const e=o;let t=l[e(1605)].custom;t.tempVideoElem!==t[e(547)]&&(l[e(1776)](t[e(547)]),t[e(547)]=t[e(1572)]),t[e(547)][e(1868)](e(1219),l[e(1354)]),clearInterval(t.waitStreamTimer),i[e(1134)](e(1349));let r=t[e(736)]?t[e(736)]:document[e(1586)]("canvas"),n=l[e(1558)].customLayers[0];t.canvas=r,r[e(1512)](e(559),n.width),r[e(1512)]("height",n[e(958)]);let a=r.getContext("2d");clearInterval(t[e(1421)]),t[e(1421)]=setInterval((function(){const o=e;a[o(1740)](t[o(547)],0,0,r.width,r[o(958)])}),40);try{l[e(1630)](t[e(1148)]),l[e(1630)](t.videoTrack),t.audioTrack=null,t[e(1719)]=null;let o=null;if(t[e(539)]=new MediaStream,o=typeof t[e(547)][e(1894)]===e(840)?t[e(547)][e(551)]():t.videoElem.mozCaptureStream(),!t[e(589)]&&(t[e(1148)]=o[e(1023)]()[0]),!t[e(1769)]){let o=r[e(551)](30);t.videoTrack=o.getVideoTracks()[0]}}catch(t){return i[e(1908)](e(1043)+t),l[e(1872)]({type:l[e(932)][e(1013)],subType:l[e(978)][e(1340)],desc:e(1199),error:{name:e(1537)}})}t.videoTrack?t[e(539)][e(707)](t[e(1719)]):i.logWarn(e(1070)),t.audioTrack?t[e(539)][e(707)](t[e(1148)]):i[e(1446)](e(766)),t[e(1870)]=t[e(1769)],t[e(504)]=t[e(589)],t.preview=!0,s[e(676)](s.Event[e(1044)],!0,t.label,t[e(539)])},l.resetSreenFramerate=function(e,t){return new Promise((r=>{const o=g,n=e[o(547)],s=document[o(1586)]("canvas");let a=null;if(!s[o(551)])return i[o(1446)](o(1177)),r();if(l[o(1558)][o(1714)])return r();if(!l[o(1605)][o(1365)][o(1148)])return i[o(1446)](o(1554)),r();a=l[o(1605)][o(1365)][o(1148)][o(1763)](),n[o(1337)](o(566),(function i(c){const d=o;n[d(1868)](d(566),i);const u=document[d(1586)](d(1063)),l=s.getContext("2d"),p=c[d(1758)]||c[d(1239)],m=p.videoWidth,f=p[d(1711)],b=new MediaStream;s[d(1512)](d(559),m),s.setAttribute(d(958),f),e.canvasInterval=setInterval((function(){const e=d;l[e(1865)](0,0,s[e(559)],s.height),l[e(1740)](n,0,0,s[e(559)],s.height)}),40),b[d(707)](a),b[d(707)](s.captureStream(t).getVideoTracks()[0]),u[d(1895)]=!0,u[d(1501)]=b,u[d(844)](),e.stream=b,e[d(1434)]=u,r()}))}))},l[o(824)]=function(e,t,r){const n=o;if(!e[n(539)])return;e[n(539)].getTracks().forEach((e=>{e[n(1661)]===t&&(e.enabled=!r)}))},l[o(540)]=function(e="",t={},r=!1,n=""){const i=o;let s=r,a=null,c=!1;a=n===l[i(978)][i(1340)]?l[i(1605)][i(1044)]:l.core[e],t.hasOwnProperty(i(504))&&(t.muteAudio!==a[i(504)]||r)&&(s=!0,a[i(504)]=t.muteAudio,l.muteStream(a,l.StreamTrack[i(1133)],t[i(504)]),!r&&!t[i(504)]&&(c=!0),l[i(1793)](l[i(1251)][i(584)],{action:l.UserAction[i(1441)],mediaType:l.MediaType[i(1133)],streamInfo:a})),t[i(1550)]("muteVideo")&&(t[i(1870)]!==a[i(1870)]||r)&&(s=!0,a[i(1870)]=t[i(1870)],l[i(824)](a,l[i(698)][i(977)],t[i(1870)]),!r&&!t.muteVideo&&(c=!0),a[i(1870)]&&(a.systemMuteVideo=!1),l.triggerLogUpload(l[i(1251)][i(584)],{action:l[i(584)][i(1441)],mediaType:a[i(1049)]===l[i(932)][i(910)]?l.MediaType[i(977)]:l[i(1403)][i(1013)],streamInfo:a})),s&&a[i(1744)]&&l[i(1125)](a.id,a[i(1870)],a[i(504)]),c&&l[i(1237)](a)},l[o(1412)]=function(e="",t={}){const r=o;let n=!1,i=!1,s=l[r(1605)][r(1331)][e];s&&(t[r(1550)](r(504))&&t[r(504)]!==s[r(504)]&&(n=!0,s[r(504)]=t.muteAudio,l[r(824)](s,l[r(698)][r(1133)],t.muteAudio),!t[r(504)]&&(i=!0),l[r(1793)](l[r(1251)][r(584)],{action:l.UserAction[r(1441)],mediaType:l[r(1403)][r(1133)],streamInfo:s})),t.hasOwnProperty(r(1870))&&t.muteVideo!==s[r(1870)]&&(n=!0,s[r(1870)]=t[r(1870)],l[r(824)](s,l[r(698)][r(977)],t[r(1870)]),!t[r(1870)]&&(i=!0),s.muteVideo&&(s[r(1796)]=!1),l[r(1793)](l[r(1251)][r(584)],{action:l.UserAction.toggleMute,mediaType:s.type===l[r(932)][r(910)]?l[r(1403)][r(977)]:l[r(1403)][r(1013)],streamInfo:s})),n&&s[r(1744)]&&l[r(1125)](s.id,s[r(1870)],s.muteAudio),!s[r(784)]&&s.pc&&i&&(!l.core[r(1315)][r(1465)+s.id]&&(l[r(1605)][r(1315)][r(1465)+s.id]={}),l[r(1605)][r(1315)][r(1465)+s.id][r(1497)]=Date[r(1913)](),l.checkStreamFirstUpload(s)))},l.muteRemoteStream=function(e,t={}){const r=o;let n=l[r(778)](e);if(n){let e=!1;t[r(1550)](r(504))&&t[r(504)]!==n[r(1681)]&&(e=!0,n[r(1681)]=t.muteAudio,l[r(824)](n,l[r(698)][r(1133)],t.muteAudio),l.triggerLogUpload(l[r(1251)][r(584)],{action:l[r(584)][r(1441)],mediaType:l[r(1403)][r(1133)],streamInfo:n})),t[r(1550)](r(1870))&&t[r(1870)]!==n[r(962)]&&(e=!0,n[r(962)]=t[r(1870)],l[r(824)](n,l[r(698)].Video,t[r(1870)]),l[r(1793)](l[r(1251)].UserAction,{action:l[r(584)][r(1441)],mediaType:n[r(1049)]===l.StreamType[r(910)]?l[r(1403)][r(977)]:l.MediaType[r(1013)],streamInfo:n})),e&&n[r(1744)]&&l[r(1125)](n.id,n[r(962)],n[r(1681)])}},l[o(786)]=function(e,t,r=!1){const n=o,a=()=>{const t=g;return!!l.core[t(1898)][e[t(1390)]]&&l.ws[t(1887)]===WebSocket[t(1059)]&&e.lastRequestID&&l[t(1605)][t(1698)]};if(typeof e[n(1376)]===n(840)&&(e[n(1376)]=0),!a())return e.retry=0,void i[n(1134)](n(1091));if(!l[n(1558)][n(1635)]||e[n(1376)]>2||r){const r={...e};return e.retry=0,e.id&&l.wsUnsubscribe(e.id),void l[n(1500)](l[n(1751)][n(1815)],{publishID:r[n(1390)],subscribeID:r.id,desc:t})}let c=1e3*e[n(1376)];e[n(1071)]=setTimeout((()=>{const t=n;if(a()){const r=e.id;i[t(1134)](t(1856)+e.retry),l[t(641)](e.id),l[t(748)](l.core[t(1322)],e[t(1390)]),s.emit(s[t(1211)].subscribeRecover,{publishID:e.publishID,subscribeID:r,desc:t(1564)})}else e[t(1376)]=0,i[t(1134)]("no need subscribe recover")}),c),e.retry++},l.wsPrepare=function(e="",t=!1){const r=o;let n,a;try{let t=JSON[r(864)](Base64[r(927)](e)),o=t[r(591)][r(997)](":"),i=o[0],s=o[1],c=t[r(759)];n=t.path,s&&"80"!==s&&s!==r(1676)&&(n=":"+s+n),n=l[r(1449)](r(1422)+(c||i)+n),a={name:r(740),type:r(1139),stamp:Date.now(),requestID:S(),content:{id:t[r(1298)],host:t.host,secure:t[r(1724)],signature:t[r(1051)],privateID:l.core[r(1892)],dType:l.core[r(1690)],quality:l[r(1558)].hdQualityPriority?1:2,role:l[r(1605)][r(1703)]}}}catch(e){if(t)return l[r(1608)]();i[r(1908)]("room service response error, token info error,",e[r(1644)]()),s.emit(s.Event[r(531)],l[r(1751)].JoinError,"prepare websocket"),l[r(1793)](l[r(1251)][r(1619)],{errorType:l[r(1686)][r(619)],errorCode:l[r(1641)][r(619)][r(1754)],errorDesc:"token info error: "+e[r(1644)]()})}l[r(1031)](n,a,t)},l[o(1031)]=function(e="",t={},r=!1){const n=o;l.ws&&(r&&l.ws[n(1868)](n(967),l[n(1605)][n(638)].onClose),l.ws.close()),0===l[n(1605)][n(1659)]&&(l[n(1605)][n(1376)]=0,l[n(1605)][n(1659)]=2);const s=l[n(1605)][n(638)];l.ws=new WebSocket(e),l.ws.addEventListener(n(669),s.onOpen=function(){const r=n;i[r(1134)](r(1752),e),l.core[r(1376)]=0,l[r(1371)](t)}),l.ws.addEventListener(n(896),s[n(1463)]=function(e){l[n(899)](e.data)}),l.ws.addEventListener(n(967),s[n(1629)]=function(o){const s=n;i[s(1446)](s(863)+(o?o[s(1667)]:""));const a=l.core[s(638)];if(l.ws[s(1868)](s(669),a[s(1488)]),l.ws[s(1868)](s(896),a[s(1463)]),l.ws[s(1868)](s(967),a[s(1629)]),l.ws[s(1868)](s(531),a[s(678)]),0!==l.core[s(1659)])return 2===l[s(1605)][s(1659)]?(l[s(1605)][s(1376)]++,void(l[s(1605)].retry<=3?(i[s(1134)]("first init ws, retry:"+l[s(1605)][s(1376)]),setTimeout((()=>{l[s(1031)](e,t,r)}),1e3)):(l[s(1605)][s(1659)]=0,l[s(1605)].retry=0,l[s(1500)](l[s(1751)][s(1196)],s(871))))):void(l.options[s(1760)]&&l.ws?l[s(1608)]():(!l[s(1558)][s(1760)]&&(i[s(1908)](s(1678)),l[s(1500)](l.ErrorCode[s(751)])),l[s(1140)]()))}),l.ws.addEventListener(n(531),s.onError=function(e){i[n(1908)]("websocket error,",e),l.ws.close()})},l[o(806)]=function(){const e=o;return l.ws&&l.ws[e(1887)]===WebSocket.OPEN},l[o(1077)]=function(t={},r=null){const n=o;if(l.ws&&l.ws.readyState===WebSocket[n(1059)]){let r=t;t instanceof Object&&(r=JSON[n(1857)](t),l.options[n(1504)]&&t[n(1680)]!==n(611)&&i.logInfo(n(1471),r),r=function(t){const r=e;if(!t)return;let o=Base64[r(1319)](t),n=o[r(1100)]("=")<0?0:o[r(1840)]-o.indexOf("=");o=o[r(1216)](/=/g,"");let i=w(1,25),s="";for(let e=0,t=o[r(1840)];e<t;e++){let t=o.charCodeAt(e);s+=43===t||t>=47&&t<=57?String[r(1149)](t):t>=65&&t<=90?String.fromCharCode(t+i>90?t+i-26:t+i):String.fromCharCode(t+i>122?t+i-26:t+i)}let a=Math[r(1395)](Date[r(1913)]()/1e3);return a=1e3*a+100*n+i,JSON.stringify({name:r(882),type:r(1139),stamp:a,content:s})}(r)),l.ws.send(r)}if(r)return r()},l[o(899)]=function(t=""){const r=o,n={join:l.wsHandleJoin,leave:l.wsHandleLeave,publish:l.wsHandlePublish,unpublish:l[r(823)],subscribe:l[r(728)],unsubscribe:l.wsHandleUnsubscribe,negotiate:l[r(1705)],update:l[r(970)],updateSubLayer:l[r(1687)],message:l[r(737)],ping:l.wsHandlePing,startLiveBroadcast:l[r(562)],stopLiveBroadcast:l[r(1844)],updateInfo:l[r(1623)],updateRoom:l[r(1442)],userJoined:l[r(577)],userLeft:l[r(947)],streamAdded:l[r(635)],streamRemoved:l.wsHandleStreamRemoved,streamUpdated:l[r(1423)],layerReqChanged:l.wsHandleLayerReqChanged,mixer:l.wsHandleMixer,webpage:l.wsHandleWebPage,infoUpdated:l[r(1643)],roomUpdated:l[r(544)],netStatChanged:l[r(1879)],updateNetStat:l[r(496)],kick:l[r(957)],role:l[r(801)]};let s;try{s=JSON[r(864)](t)}catch(e){return i.logError(r(1011)+t+", "+e)}return s&&s.hasOwnProperty(r(1680))&&s.content?s[r(1680)]===r(882)?l[r(899)](function(t=0,r="",o){const n=e;if(!t||!r)return;let i,s=Math[n(1395)](t%1e3),a=Math[n(1395)](s/100),c=Math[n(1395)](s%100),d="";for(let e=0,t=r[n(1840)];e<t;e++){let t=r[n(524)](e);d+=43===t||t>=47&&t<=57?String[n(1149)](t):t>=65&&t<=90?String[n(1149)](t-c<65?t-c+26:t-c):String[n(1149)](t-c<97?t-c+26:t-c)}for(let e=0;e<a;e++)d+="=";try{i=Base64[n(927)](d)}catch(e){return o.logError(n(1380))}return i}(s[r(1357)],s.content,l.localLog)):n[r(1550)](s[r(1680)])?(l[r(1558)][r(1504)]&&"ping"!==s[r(1680)]&&i[r(1134)](r(1435),t),n[s[r(1680)]](s)):i[r(1908)](r(767)+s[r(1680)]):i[r(1908)](r(1106)+t)},l[o(1371)]=function(e){l.wsSender(e)},l.wsHandleJoin=function(e={}){const t=o;if(!e[t(1527)].result)return l[t(1605)][t(1659)]=0,l.ws[t(967)](),l[t(1500)](l[t(1751)][t(1196)]),void l.triggerLogUpload(l[t(1251)].Error,{errorType:l.LogErrorType[t(619)],errorCode:l.LogErrorCode.Rtc[t(1855)],errorDesc:t(1114)+e.requestID});if(0!==e[t(1527)][t(490)][t(1667)])return i[t(1908)](t(1814),e[t(1527)][t(490)][t(1667)],e[t(1527)][t(490)][t(998)]),l.core[t(1659)]=0,l.ws[t(967)](),l[t(1500)](l[t(1751)][t(1196)]),void l.triggerLogUpload(l[t(1251)].Error,{errorType:l[t(1686)].Rtc,errorCode:l.LogErrorCode.Rtc.Join,errorDesc:t(1114)+e[t(1867)]+t(1233)+e[t(1527)].result.code});let r=1===l[t(1605)][t(1659)];l[t(1605)][t(1659)]=1,l[t(1440)]({session:e[t(1698)],stunURL:e.content[t(1835)],turnURL:e[t(1527)].turnURL,turnUser:e[t(1527)][t(757)],turnPwd:e[t(1527)][t(1695)],userToken:e[t(1527)][t(622)],curVideoQuality:e[t(1527)][t(945)]}),l.reviseStreamData(e[t(1527)][t(781)]||[],e[t(1527)][t(853)]),l[t(693)]();let n=JSON[t(864)](JSON[t(1857)](e[t(1527)][t(781)]||[]));r&&(n=n[t(1767)]((e=>e[t(1322)]!==l[t(1605)][t(1322)]))),s.emit(r?s[t(1211)][t(996)]:s[t(1211)][t(1218)],n,{mixer:e[t(1527)].mixer||[],webpage:e[t(1527)].webpage||[]}),l[t(1605)][t(1315)][t(740)][t(1269)]=Date[t(1913)](),l[t(1793)](l[t(1251)][t(584)],{action:l[t(584)][t(1804)],reconnected:r}),l[t(1558)].enableLogUpload&&(l[t(1907)](),l[t(848)]()),l[t(695)](!0,l[t(1558)][t(939)]),l[t(1657)](!0)},l.wsPing=function(){const e=o;if(l[e(611)])try{clearInterval(l.ping),delete l.ping}catch(e){i.logWarn(e)}l[e(611)]=setInterval((()=>{const t=e;l.ws&&l.ws[t(1887)]===WebSocket[t(1059)]&&l[t(1077)]({name:t(611),type:t(1139),requestID:S(),stamp:Date.now()})}),l[e(1558)].websocketPingInterval)},l[o(1660)]=function(e={}){const t=o;let r=e.content[t(1611)];l[t(611)]&&r!==l[t(1558)][t(1417)]&&(l.options[t(1417)]=r,l.wsPing()),l[t(1077)]({name:t(611),type:"notify",requestID:e.requestID,stamp:Date[t(1913)]()})},l[o(1749)]=function(){const e=o;l[e(1077)]({name:e(1310),type:"request",stamp:Date[e(1913)](),session:l.core[e(1698)],requestID:S(),content:{userID:l.core[e(1322)],meetingID:l.core[e(1309)]}},(()=>{const t=e;l.ws[t(967)]()}))},l[o(1184)]=function(){},l[o(577)]=function(e={}){const t=o;if(!e[t(1527)])return;let r=e.content[t(1322)],n=e[t(1527)][t(1690)];r!==l[t(1605)][t(1322)]&&(l[t(1605)].users[r]={uid:r,dType:n,streams:[]},s[t(676)](s[t(1211)][t(689)],e[t(1527)][t(1322)]))},l.wsHandleUserLeft=function(e={}){const t=o;if(!e.content)return;let r=e[t(1527)][t(1322)];r!==l[t(1605)][t(1322)]&&(l[t(1605)][t(781)][r]&&(l[t(1605)][t(781)][r].streams.forEach((e=>{const r=t;l[r(1605)].publishers[e]&&(l[r(1605)][r(1898)][e].id&&l[r(1605)].publishers[e].ready?l.resetStreamData(l[r(1605)][r(1898)][e],!0):delete l[r(1605)][r(1898)][e])})),delete l[t(1605)].users[r]),s.emit(s[t(1211)].someoneLeft,e.content[t(1322)]))},l[o(1314)]=function(e="",t="",r="",n=""){const i=o;let s=null;s=t?l[i(1605)][i(1331)][t]:n===l.SubStreamType[i(1340)]?l[i(1605)][i(1044)]:l[i(1605)][e],""!==r&&(s[i(1577)][i(1507)]=1|s[i(1577)][i(1507)],s[i(1577)][i(1042)]=r||"");let a=0,c=l[i(797)](s);c[i(1278)]((e=>a+=e[i(1293)]||0)),s[i(1368)]=s[i(1049)]===l[i(932)][i(1013)]?0:-1;const d=S();if(l.core[i(1315)]["publish-"+d]={publishBegin:Date[i(1913)]()},t){if(!s)return;s[i(688)]=d;let r={userID:l.core.userID,minVideoBw:0,maxVideoBw:a,label:s[i(539)].id,type:e,tag:t||"",video:s[i(1063)],audio:s[i(1542)],muteVideo:!!s[i(1870)],muteAudio:!!s.muteAudio,layers:c};s[i(1577)][i(1507)]>0&&(r[i(1577)]=s[i(1577)][i(1042)]),l.wsSender({name:i(1193),type:i(1139),stamp:Date.now(),session:l[i(1605)][i(1698)],requestID:s[i(688)],content:r}),s.info[i(1507)]=0}else{s[i(688)]=d;let t={userID:l[i(1605)][i(1322)],minVideoBw:0,maxVideoBw:a,label:s[i(539)].id,type:e,video:!!s[i(1719)],audio:!!s[i(1148)],muteVideo:s[i(1870)],muteAudio:s[i(504)],layers:c};l[i(1605)][e][i(1577)][i(1507)]>0&&(t.info=s[i(1577)].app),l.wsSender({name:i(1193),type:i(1139),stamp:Date[i(1913)](),session:l.core[i(1698)],requestID:s.lastRequestID,content:t}),s[i(1577)][i(1507)]=0}},l[o(1103)]=function(e={}){const t=o;if(!e[t(1527)][t(490)]||!e[t(1867)])return i.logError(t(1054)),void l.triggerLogUpload(l[t(1251)].Error,{errorType:l.LogErrorType.Rtc,errorCode:l[t(1641)][t(619)].Publish,errorDesc:t(752)+e[t(1867)]});let r=l[t(760)](e.requestID,l[t(1098)][t(1169)]);if(!r)return i[t(1446)](t(1609)+e[t(1932)]),void l.triggerLogUpload(l[t(1251)][t(1619)],{errorType:l.LogErrorType[t(619)],errorCode:l.LogErrorCode[t(619)][t(1862)],errorDesc:t(1146)+e[t(1867)]+t(796)});let n=r[t(1049)],s=r[t(1288)],a=r.tag;if(i[t(1134)]("wsHandlePublish("+JSON[t(1857)](e)+")"),0!==e[t(1527)][t(490)].code)return i.logInfo(t(1708)+e[t(1527)][t(490)].code+", tag:"+a),i[t(1134)](t(1495)+(e[t(1527)][t(490)][t(1667)],e.content.result[t(998)])),i[t(1446)](t(860),e[t(1527)][t(490)].code,e[t(1527)][t(490)][t(998)]),l[t(1500)](l.ErrorCode[t(1099)],{type:n,subType:s,tag:a,desc:t(1047)}),void l[t(1793)](l[t(1251)][t(1619)],{streamInfo:r,errorType:l[t(1686)][t(619)],errorCode:l[t(1641)][t(619)][t(1862)],errorDesc:t(1146)+e[t(1867)]+t(1156)});r.id&&l[t(1779)](r),r.id=e[t(1527)][t(1390)];let c=l[t(797)](r);clearInterval(r[t(1467)]),l.createRtcPeerConn(l[t(1098)][t(1169)],r,c)[t(1217)]((e=>{l[t(753)](r.id,"offer",e,0)}))},l[o(1670)]=function(e="",t="",r="",n=""){const i=o;t&&(!l[i(1605)][i(1315)][i(772)+t]&&(l[i(1605)][i(1315)]["unpublish-"+t]={}),l[i(1605)][i(1315)]["unpublish-"+t][i(1662)]=Date[i(1913)]());let s=()=>{const o=i;r?l.core[o(1331)][r]&&l[o(1605)][o(1331)][r].id&&l.core[o(1331)][r].id===t&&(l[o(1605)][o(1315)][o(772)+t].streamInfo={...l.core[o(1331)][r]},l[o(898)](l[o(1605)][o(1331)][r])):n===l[o(978)].Custom?l[o(1605)][o(1044)].id&&l.core[o(1044)].id===t&&(l[o(1605)].userActionData[o(772)+t].streamInfo={...l[o(1605)][o(1044)]},l[o(898)](l[o(1605)][o(1044)])):l[o(1605)][e].id&&l[o(1605)][e].id===t&&(l.core[o(1315)][o(772)+t][o(911)]={...l[o(1605)][e]},l.resetStreamData(l[o(1605)][e]))};t||r?l[i(1077)]({name:i(639),type:i(1139),stamp:Date[i(1913)](),session:l[i(1605)].session,requestID:S(),content:{userID:l.core[i(1322)],publishID:t||(n===l[i(978)][i(1340)]?l.core[i(1044)].id:l[i(1605)][e].id)}},s):s()},l[o(823)]=function(e){const t=o;if(!e.content.result||!e[t(1867)])return i[t(1908)]("unpublish error, bad response");l[t(1605)][t(1315)]["unpublish-"+e[t(1527)][t(1390)]].unpublishEnd=Date[t(1913)](),l[t(1605)].userActionData[t(772)+e[t(1527)].publishID][t(911)]&&l[t(1793)](l[t(1251)][t(584)],{action:l[t(584)][t(1271)],streamInfo:l[t(1605)][t(1315)][t(772)+e[t(1527)][t(1390)]][t(911)]})},l[o(748)]=function(e,t){const r=o;l[r(1605)][r(1898)][t][r(1368)]<0&&(l[r(1605)].publishers[t].layerIndex=0),!l[r(1605)][r(1315)][r(1118)+t]&&(l[r(1605)][r(1315)][r(1118)+t]={}),l[r(1605)][r(1315)][r(1118)+t][r(1548)]=Date.now(),l.core[r(1898)][t][r(688)]=S();let n=l.core.publishers[t].layers[r(830)](-1)[0].targetBw||3e6,i=!1,s=!1,a=0;try{i=l[r(1605)][r(1898)][t][r(962)],s=l[r(1605)].publishers[t][r(1681)],a=l.core[r(1898)][t].layerIndex}catch(e){}let c={name:r(658),type:r(1139),stamp:Date[r(1913)](),session:l[r(1605)][r(1698)],requestID:l.core[r(1898)][t][r(688)],content:{userID:l[r(1605)].userID,publishID:t,maxVideoBw:n,video:l[r(1605)][r(1898)][t][r(1063)],audio:l.core[r(1898)][t][r(1542)],muteVideo:i,muteAudio:s,layerIndex:a}};l[r(1077)](c)},l[o(728)]=function(e){const t=o;if(!e[t(1527)][t(490)]||!e.requestID)return i.logError(t(1508)),void l[t(1793)](l[t(1251)][t(1619)],{errorType:l[t(1686)][t(619)],errorCode:l[t(1641)][t(619)][t(749)],errorDesc:"subscribe error, bad response, params: "+JSON.stringify(e)});let r=l[t(760)](e.requestID);if(!r)return i[t(1446)](t(625)+e.requestID),void l[t(1793)](l[t(1251)][t(1619)],{errorType:l.LogErrorType[t(619)],errorCode:l[t(1641)][t(619)][t(749)],errorDesc:t(835)+JSON.stringify(e)});if(0!==e.content.result.code)return i[t(1446)](t(1893),e[t(1527)][t(490)][t(1667)],e[t(1527)].result[t(998)],"requestId: "+e.requestID),l.subscribeRecover(r,t(850)),void l[t(1793)](l[t(1251)][t(1619)],{streamInfo:r,errorType:l[t(1686)].Rtc,errorCode:l.LogErrorCode.Rtc.Subscribe,errorDesc:t(1250)+JSON[t(1857)](e)});let n=e[t(1527)].publishID,s=e.content.subscribeID;l.core[t(1898)][n].id=s,l.createRtcPeerConn(l[t(1098)].Subscriber,l[t(1605)][t(1898)][n])[t(1217)]((e=>{const r=t;e&&l.wsNegotiate(s,r(1176),e)}))},l[o(641)]=function(e="",t=null){const r=o,n=l[r(1886)](e),i=l.core[r(1898)][n];i&&(l[r(1605)][r(1315)][r(1018)+e]={unsubscribeBegin:Date[r(1913)](),streamInfo:{...i}}),l[r(1077)]({name:r(1582),type:r(1139),stamp:Date[r(1913)](),session:l[r(1605)][r(1698)],requestID:S(),content:{userID:l[r(1605)][r(1322)],subscribeID:e}},(()=>{const o=r;i&&i.id===e&&l[o(898)](i),t instanceof Function&&t()}))},l[o(727)]=function(e){const t=o;if(!e[t(1527)][t(490)]||!e[t(1867)])return i[t(1908)]("unsubscribe error, bad response");l[t(1605)][t(1315)][t(1018)+e[t(1527)][t(1923)]]&&(l[t(1605)][t(1315)][t(1018)+e[t(1527)][t(1923)]].unsubscribeEnd=Date.now(),l[t(1793)](l[t(1251)].UserAction,{action:l[t(584)][t(705)],streamInfo:l[t(1605)][t(1315)][t(1018)+e[t(1527)][t(1923)]][t(911)]}))},l[o(753)]=function(e,t,r,n=3e6,i=null){const s=o;if(!r)return;let a={name:s(1287),type:s(1139),stamp:Date[s(1913)](),session:l[s(1605)][s(1698)],requestID:S(),content:Object[s(1509)]({userID:l.core[s(1322)],streamID:e,type:t,sdp:r,maxVideoBw:n},i)};t===s(652)&&(l[s(1605)].reconnectingStreams[a[s(1867)]]=e),l.wsSender(a)},l.wsHandleNegotiate=function(e={}){const t=o;i[t(1134)](t(665)+e.type+t(1460)+JSON[t(1857)](e));let r=e.type;if([l[t(837)][t(1483)],l[t(837)].Notify][t(1100)](r)<0)return i[t(1908)](t(1906)),void l[t(1793)](l.LogType[t(1619)],{errorType:l[t(1686)][t(619)],errorCode:l.LogErrorCode[t(619)].Subscribe,errorDesc:t(1248)+JSON[t(1857)](e)});let n=e.content[t(856)],a=e[t(1867)];if(!n)return n=l[t(1605)].reconnectingStreams[a],n?l[t(1225)](n):(i[t(1446)](t(846)),void l.triggerLogUpload(l[t(1251)][t(1619)],{errorType:l[t(1686)].Rtc,errorCode:l[t(1641)][t(619)][t(749)],errorDesc:"negotiate error, stream id not found, params: "+JSON.stringify(e)}));a&&delete l[t(1605)][t(593)][a];let c=l[t(778)](n);if(!c)return l[t(1793)](l[t(1251)][t(1619)],{errorType:l[t(1686)].Rtc,errorCode:l[t(1641)][t(619)][t(749)],errorDesc:t(1738)+JSON.stringify(e)}),i.logWarn("negotiate error, drop not found stream "+n);if(r===l.MsgType.Notify){if(i[t(1134)](t(1126)+JSON[t(1857)](e)),"ready"===e[t(1527)][t(1049)]){let e=!!c.ready;if(c[t(1744)]=!0,e)i[t(1134)](n,"ice connection had been recovered");else if(c[t(1137)])c[t(1019)]?c[t(1049)]===l[t(932)].Camera?s[t(676)](s[t(1211)][t(777)],n,c[t(1019)]):s.emit(s.Event[t(1289)],n,c[t(1019)]):c[t(1288)]===l[t(978)][t(1340)]?s[t(676)](s[t(1211)][t(1737)],n,c[t(1049)],c[t(1699)]):s[t(676)](s.Event[t(1707)],n,c.type,c.label),l[t(540)](c.type,{muteAudio:c[t(504)],muteVideo:c[t(1870)]},!0,c[t(1288)]),l[t(1605)].muteAllStreamAudio&&(c[t(1067)]=c.muteAudio,c.tag?l[t(1412)](c[t(1019)],{muteAudio:!0}):l[t(540)](c[t(1049)],{muteAudio:!0},!1,c[t(1288)])),l[t(1605)][t(1315)]["publish-"+c[t(688)]]&&(l.core[t(1315)][t(1465)+c.id]={publishBegin:l[t(1605)][t(1315)]["publish-"+c[t(688)]][t(1497)],publishEnd:Date.now()},delete l[t(1605)][t(1315)][t(1465)+c.lastRequestID]),l[t(1793)](l[t(1251)][t(584)],{action:l[t(584)][t(528)],streamInfo:c});else{let e=l.getPubIdBySubId(n);if(!c.pc)return void l.subscribeRecover(c,t(1163)+e+t(1498)+c.ready);c[t(1376)]=0,s[t(676)](s[t(1211)][t(1848)],n,e,c[t(1019)]),c[t(861)]&&l[t(1879)]({content:{streamID:n,weak:!0}}),l.core[t(820)]&&(c[t(1359)]=c.localMuteAudio,l.muteRemoteStream(n,{muteAudio:!0})),l[t(1605)][t(1315)][t(1118)+e].subscribeEnd=Date.now(),l.triggerLogUpload(l.LogType.UserAction,{action:l.UserAction[t(799)],streamInfo:c}),l[t(1793)](l[t(1251)][t(584)],{action:l[t(584)][t(1441)],mediaType:l[t(1403)][t(1133)],streamInfo:c}),l[t(1793)](l[t(1251)][t(584)],{action:l.UserAction[t(1441)],mediaType:c[t(1049)]===l[t(932)][t(910)]?l[t(1403)].Video:l[t(1403)].Screen,streamInfo:c})}return}if(e.content[t(1049)]===t(891))return i[t(1446)](t(1339)+c.id+", params:"+JSON[t(1857)](e)),l[t(586)](c),void l[t(1793)](l.LogType[t(1619)],{streamInfo:c,errorType:l.LogErrorType.Rtc,errorCode:c[t(1137)]?l[t(1641)][t(619)][t(1862)]:l[t(1641)][t(619)].Subscribe,errorDesc:t(1215)+n+", requestID: "+a});if(e[t(1527)].type===t(531))return i[t(1446)]("negotiate notify error, params:"+JSON[t(1857)](e)),l.reconnectStream(n),void l.triggerLogUpload(l[t(1251)][t(1619)],{streamInfo:c,errorType:l.LogErrorType.Rtc,errorCode:c[t(1137)]?l[t(1641)].Rtc[t(1862)]:l[t(1641)][t(619)][t(749)],errorDesc:t(800)+n+", requestID: "+a})}if(r===l.MsgType[t(1483)]&&0!==e[t(1527)].result[t(1667)]){let r=e[t(1527)].result[t(1667)],o=e.content[t(490)][t(998)],s=c[t(1049)],d=c[t(1288)],u=c.tag,p=u?s+"-"+u:s,m=c[t(1390)],f=c.id;return c[t(1137)]?(l.wsUnPublish(s,f,u,d),i[t(1446)]("negotiate error, local",p,r+" "+o),i[t(1134)](t(1673)+c[t(1744)]),l[t(1500)](l[t(1751)][t(1099)],{type:s,subType:d,tag:u,publishID:f,desc:"exT:"+p+", local publish error,code:"+r+t(1017)+o})):(i.logWarn(t(1811),m,r+" "+o),l[t(786)](c,"negotiate error",!0)),c.id="",void l.triggerLogUpload(l[t(1251)][t(1619)],{streamInfo:c,errorType:l.LogErrorType[t(619)],errorCode:c[t(1137)]?l[t(1641)][t(619)][t(1862)]:l[t(1641)][t(619)][t(749)],errorDesc:"negotiate error, streamID: "+n+t(677)+a+", code: "+r+", detail: "+o})}let d=c.pc,u=e.content.sdp,p=c[t(667)];if(r===l[t(837)][t(1551)]&&e[t(1527)].type===t(909)&&u){if(!c.pc)return void l[t(786)](c,"onIceStateChange ext:"+c[t(1390)]+t(1498)+c[t(1744)]);l[t(718)](d,u)[t(1217)]((e=>{const r=t;e&&l.triggerLogUpload(l.LogType[r(1619)],{streamInfo:c,errorType:l.LogErrorType[r(619)],errorCode:c[r(1137)]?l[r(1641)].Rtc[r(1862)]:l[r(1641)][r(619)][r(749)],errorDesc:r(1789)+e[r(1644)]()+", sdp:"+u})}))}if(p&&p[t(1840)]>0){let e=p[t(1636)]();l.wsNegotiate(n,t(667),"a="+e[t(1057)],0,{sdpMLineIndex:e[t(1836)],sdpMid:e[t(1852)]})}},l[o(635)]=function(e){const t=o;let r=e.content.userID,n=e.content.stream;!l[t(1605)][t(781)][r]&&(i[t(1446)](t(714)),l.core[t(781)][r]={uid:r,streams:{}}),l[t(1605)].users[r][t(902)][t(649)](n.publishID),l[t(1605)][t(1898)][n[t(1390)]]=Object[t(1509)]({uid:r,dType:l[t(1605)].users[r].dType,local:!1,ready:!1,localMuteAudio:!1,localMuteVideo:!1,candidate:[]},n),s[t(676)](s[t(1211)].streamAdded,r,n)},l.wsHandleStreamRemoved=function(e={}){const t=o;let r=e.content[t(1322)],n=e.content[t(1390)];if(r===l.core[t(1322)])Object[t(1847)](l[t(932)])[t(1278)]((e=>{const r=t;l[r(1605)][e].id===n&&(l[r(1255)](l[r(1605)][e]),l[r(1605)][e].id="",l[r(1605)][e][r(667)]=[],l[r(1605)][e][r(1744)]=!1,l[r(1314)](e,"",l[r(1605)][e][r(1577)]?l.core[e][r(1577)].app:"",l.core[e].subType))}));else{if(!l[t(1605)][t(781)][r]||l.core[t(781)][r][t(902)][t(1100)](n)<0)return;l[t(1605)][t(1898)][n]&&l[t(1605)].publishers[n].id&&l.wsUnsubscribe(l[t(1605)][t(1898)][n].id),l[t(898)](l.core[t(1898)][n],!0),s[t(676)](s[t(1211)].streamRemoved,r,n)}},l[o(1125)]=function(e="",t=!1,r=!1){const n=o;l.wsSender({name:n(1195),type:"request",stamp:Date[n(1913)](),session:l[n(1605)].session,requestID:S(),content:{userID:l[n(1605)][n(1322)],streamID:e,muteVideo:t,muteAudio:r}})},l.wsHandleUpdate=function(e){},l[o(1845)]=function(e="",t=0){const r=o;l[r(1077)]({name:r(972),type:r(1139),stamp:Date[r(1913)](),session:l[r(1605)][r(1698)],requestID:S(),content:{userID:l.core[r(1322)],streamID:e,layerIndex:t}})},l[o(1687)]=function(e={}){},l[o(798)]=function(e={}){const t=o;let r=e[t(1527)].streamID;if(l[t(1605)][t(1365)].id===r)l[t(1605)][t(1365)][t(1368)]=e[t(1527)].layerIndex,l.setSimulcastLayerEncoding(l[t(1605)][t(1365)],l[t(1558)][t(1262)],e[t(1527)][t(1368)]),l[t(1237)](l[t(1605)].camera);else if(l.core.screen.id===r)l.core.screen.layerIndex=e[t(1527)][t(1368)],l[t(1237)](l[t(1605)][t(1285)]);else if(l[t(1605)][t(1044)].id===r)l[t(1605)][t(1044)].layerIndex=e[t(1527)][t(1368)],l[t(1237)](l[t(1605)][t(1044)]);else{let o=Object[t(1847)](l[t(1605)][t(1331)])[t(719)]((e=>e.id===r));if(!o)return;o[t(1368)]=e[t(1527)][t(1368)],o[t(1049)]===l.StreamType.Camera&&l[t(1397)](o,l.options[t(1544)],e[t(1527)][t(1368)]),l[t(1237)](o)}},l[o(1423)]=function(e){const t=o;let r=e.content.publishID,n=e[t(1527)][t(1870)],a=e[t(1527)][t(504)];l[t(1605)][t(1898)][r]?(l[t(1605)].publishers[r][t(504)]!==a&&(l.core[t(1898)][r][t(504)]=a,i.logInfo("[streamUpdated] uid:"+l[t(1605)].publishers[r][t(943)]+t(1691)+r+t(1399)+a),s[t(676)](s[t(1211)].streamUpdated,l.core[t(1898)][r][t(943)],r,l[t(698)][t(1133)],a)),l[t(1605)][t(1898)][r][t(1870)]!==n&&(l[t(1605)][t(1898)][r].muteVideo=n,i[t(1134)](t(1274)+l[t(1605)][t(1898)][r][t(943)]+", streamId:"+r+t(948)+n),s[t(676)](s[t(1211)][t(739)],l[t(1605)][t(1898)][r][t(943)],r,l[t(698)][t(977)],n))):i.logWarn(t(1925)+r+t(1460)+JSON[t(1857)](e))},l[o(608)]=function(e){const t=o;l.wsSender({name:t(1571),type:t(1139),stamp:Date.now(),session:l[t(1605)][t(1698)],requestID:S(),content:{streams:e}})},l[o(1623)]=function(e){const t=o;let r=e[t(1527)].result;(!r||0!==r.code)&&i.logWarn(t(569),r[t(998)])},l[o(1643)]=function(e){const t=o;if(e[t(1527)].streams&&e.content.streams[t(1840)]>0){let r=JSON[t(864)](JSON[t(1857)](e.content[t(902)]));s[t(676)](s[t(1211)][t(761)],r)}},l[o(953)]=function(e="",t=null){const r=o;l[r(1077)]({name:"message",type:r(1139),stamp:Date.now(),session:l[r(1605)][r(1698)],requestID:S(),content:{userID:l[r(1605)][r(1322)],userList:t,msgType:t?r(517):"broadcast",dataType:r(1447),data:e}})},l.wsHandleMessage=function(e={}){const t=o;if("notify"===e[t(1049)]){let r=e[t(1527)].userID,o=e.content.data;s[t(676)](s.Event[t(896)],r,o)}},l.wsMixer=function(e,t,r,n,i,s,a,c,d,u){const p=o;let m={name:p(1639),type:p(1139),stamp:Date[p(1913)](),session:l[p(1605)][p(1698)],requestID:S(),content:{cmd:t,task:e}};r&&(m[p(1527)][p(1049)]=r),n&&(m.content[p(768)]=n),i&&(m[p(1527)][p(781)]=i),s&&(m.content[p(873)]=s),a&&(m[p(1527)][p(923)]=a),(c||d||u)&&(m[p(1527)][p(1334)]=c||!1,m.content[p(1136)]=d||!1,m[p(1527)].autoLayout=u||!1),l[p(1077)](m)},l[o(1464)]=function(e){const t=o;if(e.type===t(1292))return l[t(1226)](e);let r=e.content[t(490)]&&0===e[t(1527)][t(490)][t(1667)],n=e[t(1527)][t(832)]||"",i=e.content[t(862)]||"";return r?n?s.emit(s[t(1211)].mixerTask,l.core[t(1322)],n,i):void 0:l[t(1500)](l[t(1751)][t(1273)],{taskID:n,cmd:i})},l[o(1226)]=function(e){const t=o;let r=e[t(1527)];if(!r)return;let n=r.uid,i=r.task,a=r[t(862)],c=r[t(873)],d=r[t(781)],u=r[t(768)],p=r[t(923)],m=r[t(1334)],f=r[t(1136)],b=r[t(1180)];i&&(a===l.TaskCmd.Start?s.emit(s.Event[t(706)],n,i,a,d,u,c,p,m,f,b):a===l[t(1060)][t(1416)]?s[t(676)](s.Event[t(706)],n,i,a,d,u):s[t(676)](s[t(1211)].mixerTask,n,i,a))},l[o(1188)]=function(e,t,r,n,i,s,a,c,d,u){const p=o;let m={name:p(1432),type:p(1139),stamp:Date.now(),session:l[p(1605)][p(1698)],requestID:S(),content:{task:e,cmd:t}};r&&(m.content[p(1049)]=r,m.content[p(847)]=n,m[p(1527)][p(1920)]=i,m[p(1527)][p(559)]=s,m[p(1527)].height=a,m.content[p(1778)]=c,m[p(1527)].streamServer=d,m[p(1527)][p(923)]=u),l[p(1077)](m)},l[o(600)]=function(e){const t=o;if(e[t(1049)]===t(1292))return l[t(1797)](e);let r=e[t(1527)].result&&0===e[t(1527)][t(490)][t(1667)],n=e[t(1527)][t(832)]||"",a=e[t(1527)].cmd||"";return r?n?s.emit(s[t(1211)][t(1384)],l[t(1605)][t(1322)],n,a):void 0:(i.logError(t(1291)+JSON[t(1857)](e)),l.emitError(l.ErrorCode.WebPageErr,{taskID:n,cmd:a}))},l[o(1797)]=function(e){const t=o;let r=e[t(1527)][t(832)]||"",n=e[t(1527)].cmd||"",s=e.content.code,a=e.content.detail;return i[t(1908)](t(636)+JSON[t(1857)](e)),l[t(1500)](l[t(1751)][t(696)],{taskID:r,cmd:n,code:s,desc:a})},l[o(699)]=function(){const e=o;let t={name:e(866),type:e(1139),stamp:Date[e(1913)](),session:l[e(1605)][e(1698)],requestID:S(),content:{quality:l[e(1558)][e(839)]?1:2}};l[e(1077)](t)},l[o(1442)]=function(e){const t=o;!(e[t(1527)]&&e[t(1527)][t(490)]&&0===e[t(1527)].result.code)&&(l[t(1558)][t(839)]=!l[t(1558)][t(839)]),s[t(676)](s[t(1211)][t(1824)],{hdQualityPriority:l.options[t(839)]})},l.wsHandleRoomUpdated=function(e){const t=o;if(e[t(1527)]&&e.content.quality){const r=e[t(1527)][t(945)];l[t(1605)][t(1771)]!==r&&(l[t(1605)][t(1771)]=e[t(1527)].quality,l[t(1605)][t(1365)].pc&&l[t(1397)](l[t(1605)][t(1365)],l[t(1558)][t(1262)],l[t(1605)].camera[t(1368)]||0),Object[t(1847)](l.core[t(1331)])[t(1278)]((e=>{const r=t;e.pc&&l[r(1397)](e,l[r(1558)][r(1544)],e[r(1368)]||0)})))}},l[o(1454)]=function(e,t,r){const n=o;i[n(1134)](n(1773)+e+n(921)+t+n(813)+r);const s={name:n(1475),type:"request",stamp:Date[n(1913)](),session:l.core[n(1698)],requestID:S(),content:{userID:e,streamID:t,weak:r}};l.wsSender(s)},l[o(496)]=function(){},l[o(1879)]=function(e){const t=o,{streamID:r,weak:n}=e[t(1527)],s=l[t(778)](r);if(i[t(1134)](t(1762)+e.type+", params:"+JSON[t(1857)](e)),s&&!s[t(1870)]){s[t(1049)]!==l[t(932)][t(1013)]&&(s[t(1827)]=n),s[t(861)]=n;let e=l[t(1605)][t(1733)][t(758)][r];!e&&(e={id:r,level:1e-9},l[t(1605)][t(1733)].netWeakStats[r]=e),e.isChange=!0,l[t(959)]()}},l.wsHandleKick=function(e){const t=o,{by:r,uid:n,ip:a,code:c,detail:d}=e[t(1527)];i[t(1134)](t(1494)+JSON[t(1857)](e[t(1527)])),l.wsSender({name:t(1388),type:t(1277),stamp:Date[t(1913)](),session:l[t(1605)][t(1698)],requestID:S()}),l.leaveRoom(),s[t(676)](s[t(1211)][t(1388)],r,n,c,d)},l.wsRole=function(e){const t=o;l[t(1077)]({name:t(1052),type:t(1139),stamp:Date[t(1913)](),session:l[t(1605)][t(1698)],requestID:S(),content:{role:e}})},l[o(801)]=function(e){},l[o(1406)]=async function(e="",t={},r=[]){const n=o;let s={iceServers:[{urls:[l.core.stunURL]}],iceTransportPolicy:n(1355),iceCandidatePoolSize:0};l[n(1605)][n(1366)]&&s[n(1135)][n(649)]({urls:[l.core[n(1366)]],username:l.core[n(757)],credential:l[n(1605)].turnPwd}),t.pc=new RTCPeerConnection(s),t.pc[n(1801)]=e=>l[n(991)](t,e),t.pc[n(1428)]=e=>l[n(1307)](t,e),t.pc[n(790)]=e=>l.onConnectionStateChange(t,e),e===l.StreamRole.Publisher?t[n(1049)]!==l.StreamType[n(910)]||t[n(1019)]?t.stream&&(t[n(1288)]===l.SubStreamType[n(1340)]&&!t[n(1148)]&&t.pc[n(493)](n(1542),{direction:n(685),streams:[t[n(539)]]}),t[n(539)][n(495)]()[n(1278)]((e=>{const r=n;t.pc[r(707)](e,t.stream)}))):(t.audioTrack&&t.pc.addTrack(t.audioTrack,t[n(539)]),t[n(1719)]&&t.pc[n(707)](t[n(1719)],t[n(539)]),l[n(628)](t.pc)):t.pc.ontrack=async function(e){const r=n;if(e[r(1037)]&&(t[r(539)]=e[r(902)][0],e.track.kind===l.StreamTrack.Video&&t[r(1063)]&&(l.setVideoElementStream(t.videoElem,t[r(539)]),l.autoplayHack(t[r(547)],!0)),e.track[r(1661)]===l[r(698)][r(1133)]&&t[r(1542)])){if(t[r(539)]=e[r(902)][0],!t[r(1550)]("audioElem")){let e=document.createElement(r(1542));e.id=t[r(1390)]+"#audio",t[r(612)]=e}l.setAudioElementStream(t.audioElem,new MediaStream([e.track])),l[r(851)](t[r(612)],!1,l[r(1558)][r(1084)]),l[r(780)](t[r(612)],!1)}};try{let o={};if(e===l[n(1098)][n(1169)])o=await t.pc[n(1456)](),o[n(1057)]=l[n(1186)](o[n(1057)],r),o[n(1057)]=l.sdpAddSimulcast(o[n(1057)],r);else{if(t.pc[n(493)]&&l[n(1558)].enableProbator)t.pc[n(493)](n(1542),{direction:n(654)}),t.pc[n(493)](n(1063),{direction:n(654)}),t.pc[n(493)](n(1063),{direction:n(654)}),l.setReceiverCodecPreferences(t.pc),o=await t.pc[n(1456)](),o[n(1057)]=l[n(1802)](o[n(1057)]);else{let e={offerToReceiveAudio:t[n(1542)],offerToReceiveVideo:t[n(1063)]};l.setReceiverCodecPreferences(t.pc),o=await t.pc[n(1456)](e)}i[n(1134)](n(989)+JSON.stringify(o))}return await t.pc[n(1637)](o),e===l[n(1098)].Publisher&&(l[n(1101)](t.pc,r),r&&1==r.length&&l.setSingleLayerConfig(t.pc,r[0])),o.sdp}catch(e){return i[n(1908)](n(993)+e),l[n(1793)](l[n(1251)].Error,{streamInfo:t,errorType:l[n(1686)][n(619)],errorCode:t[n(1137)]?l.LogErrorCode[n(619)][n(1862)]:l[n(1641)][n(619)][n(749)],errorDesc:"create session description error: "+e+", id: "+(t.id||t[n(1923)])}),null}},l[o(1255)]=function(e){const t=o,r=e.pc;try{r&&r[t(536)]!==t(1132)&&(r.onicecandidate=null,r[t(1428)]=null,r[t(790)]=null,r.close()),e.pc=null}catch(e){i[t(1908)](t(657)+e)}},l[o(586)]=function(e){const t=o;if(e.pc){let r=e.id||e[t(1390)];if(i[t(1134)](r,t(1457)),e.pc[t(605)]instanceof Function)try{e.pc[t(605)](),i[t(1134)](r,"restart ice ok, prepare ice negotiation"),e[t(667)]=[],l[t(1192)](e)}catch(e){i[t(1446)](t(697),e[t(1644)]())}else e.id&&l[t(641)](e.id,(()=>{const r=t;l.wsSubscribe(e[r(1322)],e[r(1390)])}))}},l[o(718)]=async function(e,t){const r=o;try{t=l.sdpNormalizer(e,t);let o=new RTCSessionDescription({sdp:t,type:"answer"});await e[r(1770)](o)}catch(e){return i[r(1908)](r(1789)+e+r(1850)+t),e}},l[o(628)]=function(e=null){const t=o;e&&e[t(1911)]()[t(1278)]((e=>{const r=t;if(r(1187)in e&&e.sender&&e.sender[r(1037)]){let t=e.sender.track[r(1661)];let o=RTCRtpSender[r(1642)](t)[r(662)][r(1767)]((e=>{const t=r;let o=e[t(1480)][t(580)](),n=e[t(687)];return o===t(983)&&n&&n.indexOf(t(1745))>=0&&n[t(1100)](t(1147))>=0||"video/rtx"===o||"audio/opus"===o}));if(o&&o.length>0)try{e[r(1187)](o)}catch(e){i[r(1446)](r(1459),e[r(1644)]())}}}))},l[o(1477)]=function(e=null){const t=o;e&&e[t(1911)]()[t(1278)]((e=>{const r=t;if(r(1187)in e&&e[r(1032)]&&e.receiver[r(1037)]){let t=e.receiver[r(1037)][r(1661)];let o=RTCRtpSender[r(1642)](t)[r(662)].filter((e=>{const t=r;let o=e.mimeType[t(580)]();return o===t(983)||o===t(623)||o===t(895)}));o&&o[r(1840)]>0&&e[r(1187)](o)}}))},l.sdpNormalizer=function(e,t){const r=o;let n=!0;e&&e[r(572)]&&e[r(572)][r(1049)]===r(1176)&&(n=e[r(572)][r(1057)].indexOf(r(1295))<e[r(572)][r(1057)][r(1100)](r(1174)));let i=t,s=i[r(1100)](r(1295)),a=i[r(1100)](r(1174)),c=i.length,d=i[r(849)](0,s<a?s:a),u=i.substring(s,s<a?a:c),l=i[r(849)](a,s<a?c:s);return i=d+(n?u+l:l+u),i},l.sdpAddBitrateControl=function(e="",t=[]){const r=o;let n=e;try{const o=Math.floor(t[0][r(1293)]/1e3*.5);return o?(e.match(new RegExp(r(666),"g"))[r(1278)]((t=>{const n=r;e=e[n(1216)](t,t+n(1212)+o+";")})),e):(i.logWarn(r(1588)),n)}catch(e){return i[r(1446)](r(729),e.toString()),n}},l[o(588)]=function(e="",t=[]){const r=o;let n=t[r(1840)];if(n<=1)return e;if(null!==e[r(1338)](new RegExp(r(1591),"g")))return e;let s=e.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!s||s[r(1840)]<=0)return e;let a=e;try{const t=parseInt(s[1],10),o=parseInt(s[2],10),i=e.match(new RegExp(r(1425)+s[1]+r(1755)))[1],a=e[r(1338)](new RegExp("a=ssrc:"+s[1]+r(1236)))[1],c=e.match(new RegExp(r(1425)+s[1]+r(651))),d=c&&c[1]?c[1]:"",u=e.match(new RegExp(r(1425)+s[1]+r(975))),p=u&&u[1]?u[1]:"";e[r(1338)](new RegExp("a=ssrc:"+s[1]+r(1514),"g"))[r(1278)]((t=>{e=e.replace(t,"")})),e[r(1338)](new RegExp(r(1425)+s[2]+r(1514),"g"))[r(1278)]((t=>{e=e[r(1216)](t,"")}));const m=[t],f=[o];for(let e=1;e<n;e+=1)m.push(t+1e3*e),f.push(o+1e3*e);let b,y,v=l[r(1918)](m);for(let e=0;e<m[r(1840)];e+=1)b=m[e],y=f[e],v+=l.sdpAddGroup(b,y);for(let e=0;e<m[r(1840)];e+=1)b=m[e],y=f[e],v+=l[r(897)](i,a,d,p,b,y);return v+=r(770),e[r(1216)](s[0],v)}catch(e){return i[r(1446)](r(1381),e[r(1644)]()),a}},l[o(1802)]=function(e=""){const t=o,r=e;try{const r=t(1692),o=(t(716),e[t(1338)](/a=group:BUNDLE ([0-9\ ]*)\r?\n/)),n=o[0][t(997)](" "),i=(e=e[t(1216)](o[0],o[0].replace(" "+n[n[t(1840)]-1]," "+r+"\r\n"))).lastIndexOf(t(1174));let s=e[t(849)](i,e.length);return e=e[t(849)](0,i),s=s[t(1216)](s.match(/a=mid:[0-9]*\r?\n/)[0],t(672)+r+"\r\n"),e+s}catch(e){return i[t(1446)]("sdp add probator error",e[t(1644)]()),r}},l[o(1918)]=function(e){let t="a=ssrc-group:SIM";return e.forEach((e=>{t+=" "+e})),t+"\r\n"},l[o(908)]=function(e,t){return"a=ssrc-group:FID "+e+" "+t+"\r\n"},l.sdpAddLayer=function(e,t,r,n,i,s){const a=o;return a(1425)+i+a(1713)+e+"\r\n"+(a(1425)+i+a(609)+t)+"\r\n"+(r?"a=ssrc:"+i+a(1205)+r+"\r\n":"")+(n?a(1425)+i+a(1682)+n+"\r\n":"")+(a(1425)+s+a(1713)+e)+"\r\na=ssrc:"+s+a(609)+t+"\r\n"+(r?a(1425)+s+" mslabel:"+r+"\r\n":"")+(n?a(1425)+s+a(1682)+n+"\r\n":"")},l[o(1101)]=function(e,t=[]){const r=o;if(!e||!t||t[r(1840)]<=1)return;let n=[];for(let e=0;e<t[r(1840)];e+=1)n[e]=t[e][r(1293)];e[r(626)]()[r(1278)]((e=>{const t=r;e.track&&e[t(1037)].kind===t(1063)&&l[t(1092)](e,n)}))},l[o(1474)]=function(e,t){const r=o;e.getSenders()[r(1278)]((e=>{const o=r;if(e[o(1037)]&&e[o(1037)][o(1661)]===o(1063)){const r=e.getParameters();let n=t.targetBw||15e5,s=t.frameRate||15;r[o(944)][0][o(1881)]=n,r[o(944)][0].maxFramerate=s,e[o(795)](r).then()[o(1549)]((e=>{const t=o;i[t(1908)](t(1409)+e)}))}}))},l[o(1092)]=function(e,t=[]){const r=o;if(!(e.getParameters instanceof Function&&e[r(795)]instanceof Function))return void i[r(1908)]("cannot set simulcast layers bitrate, getParameters or setParameters is not available");if(!t||t[r(1840)]<=1)return;const n=e[r(1209)]();for(let e=0;e<t.length;e++)n.encodings[e]&&(n[r(944)][e].maxBitrate=t[e],n[r(944)][e][r(1646)]=!1);e[r(795)](n)[r(1217)]()[r(1549)]((e=>{const t=r;i[t(1908)](t(579)+e)}))},l[o(1397)]=function(e,t=[],r=-1){const n=o,s=e.pc;if(!s)return;if(!t||t[n(1840)]<=1)return;let a=s[n(626)]();if(0===a[n(1840)])return;const c=1===l[n(1605)][n(1771)];let d=0,u=r;if(c&&(d=t[n(686)]((e=>e[n(559)]*e[n(958)]>=230400)),-1===d?(d=t[n(1840)]-1,u=d):d>r&&(u=d)),-1===r){const t=l[n(1605)][n(1733)][n(758)][e.id];t&&t[n(598)]&&(t[n(922)]=!0,t[n(598)]=!1,l[n(1119)]()),d=r,u=r}e[n(1368)]=u;for(let e=0;e<a.length;e++)if(a[e][n(1037)]&&a[e][n(1037)][n(1661)]===n(1063)){let r=a[e];if(!(r[n(1209)]instanceof Function&&r[n(795)]instanceof Function)){i.logWarn(n(879));break}let o=r[n(1209)](),s=t[n(1840)]-1;u>s&&(u=s),t[n(1278)]((e=>{const t=n;o[t(944)][e[t(1368)]]&&(o[t(944)][e[t(1368)]][t(1646)]=e[t(1368)]>=d&&e[t(1368)]<=u)})),r.setParameters(o)[n(1217)]().catch((e=>{const t=n;i[t(1908)](t(1120)+e)}));break}},l.onIceCandidate=async function(e,t){const r=o;try{if(t[r(667)]){let o={sdpMid:"0"===t.candidate[r(1852)]?r(1542):"video",sdpMLineIndex:t[r(667)][r(1836)],sdp:t.candidate[r(667)]};e.candidate[r(649)](o)}}catch(t){i[r(1908)]("stream "+e.id+r(868)+t)}},l[o(1307)]=function(e){const t=o;let r=e.pc;if(r)if(typeof e.retry===t(840)&&(e[t(1376)]=0),r[t(1838)]===t(891)||"disconnected"===r[t(1838)]||r[t(1838)]===t(1132)){let o=e[t(1390)]||e.id;if(i.logWarn(o,t(1595),r[t(1838)]),e[t(1744)]&&e[t(1376)],l.ws&&l.ws[t(1887)]===WebSocket[t(1059)]){if(i[t(1134)]("streamInfo.ready:"+e[t(1744)]),e[t(1137)]){const r={...e};l[t(898)](e),l[t(1500)](l[t(1751)].PublishError,{type:r[t(1049)],subType:r.subType,tag:r.tag,publishID:r.id,desc:t(1163)+(r[t(1019)]?r.tag:r[t(1049)])+", ready:"+r[t(1744)]}),e[t(1376)]=0}else e[t(1744)]?l[t(786)](e,t(1163)+e.publishID+t(1498)+e.ready):l[t(1255)](e);r[t(1838)]===t(891)&&l[t(1793)](l[t(1251)][t(1619)],{streamInfo:e,errorType:l.LogErrorType[t(619)],errorCode:e[t(1137)]?l[t(1641)][t(619)][t(1108)]:l.LogErrorCode.Rtc[t(828)],errorDesc:"ice connection state: failed"})}}else"completed"===r[t(1838)]&&(e[t(1376)]=0)},l[o(537)]=function(e,t){const r=o,n=e.pc;if(n&&n[r(901)]===r(891)){const o=e[r(1390)]||e.id;if(i[r(1446)](o,"rtc connection change to",n[r(901)]),l.ws&&l.ws[r(1887)]===WebSocket[r(1059)]){if(i[r(1134)]("streamInfo.ready:"+e[r(1744)],t),e[r(1137)]){const t={...e};l[r(898)](e),l.emitError(l.ErrorCode[r(1099)],{type:t[r(1049)],subType:t.subType,tag:t[r(1019)],publishID:t.id,desc:"onConnectionStateChange ext:"+t[r(1049)]+", ready:"+t[r(1744)]}),e.retry=0}else l[r(786)](e,r(1933)+e[r(1390)]+r(1498)+e[r(1744)]);l.triggerLogUpload(l.LogType[r(1619)],{streamInfo:e,errorType:l[r(1686)][r(619)],errorCode:e[r(1137)]?l.LogErrorCode[r(619)][r(1108)]:l[r(1641)][r(619)][r(828)],errorDesc:r(1650)})}}},l.onIceNegotiationNeeded=function(e){const t=o;let r=!0,n=e[t(1390)],s=e.id;if(!e[t(1137)]&&!l[t(1605)][t(1898)].hasOwnProperty(n)&&(r=!1),r){let r=[],o="";e.pc[t(1456)]({offerToReceiveAudio:1,offerToReceiveVideo:1})[t(1217)]((n=>{const s=t;if(e[s(1137)]){let t=e[s(1049)],o=e.tag;r=o?l[s(1558)][s(1544)]:l[s(1558)][t+s(1178)],n[s(1057)]=l[s(588)](n.sdp,r)}return o=n[s(1057)],i.logInfo("offer:"+JSON[s(1857)](n)),e.pc[s(1637)](n)}))[t(1217)]((()=>{const n=t;e.local&&(l[n(1101)](e.pc,r),l.setSimulcastLayerEncoding(e,r,e[n(1368)]||0)),l[n(753)](s,"renego",o)}))[t(1549)]((e=>{const r=t;i[r(1446)](r(1437),e[r(1644)]())}))}},l.failCheck=function(e){const t=o;e[t(1467)]=setInterval((()=>{const r=t;if(e.pc)if(e.pc[r(901)]===r(891)){if(clearInterval(e[r(1467)]),l.ws&&l.ws[r(1887)]===WebSocket.OPEN){const t={...e};l[r(898)](e),t[r(1137)]?l[r(1500)](l[r(1751)][r(1099)],{type:t.type,subType:t[r(1288)],tag:t[r(1019)],publishID:t.id,desc:r(1228)+t[r(1049)]+r(1498)+t[r(1744)]}):l.emitError(l[r(1751)][r(1815)],{publishID:t[r(1390)],subscribeID:t.id,desc:r(1228)+t.publishID+r(1498)+t.ready}),e.retry=0}}else-1!==[r(1734),r(1401),r(1132)][r(1100)](e.pc[r(1838)])&&clearInterval(e[r(1467)]);else clearInterval(e[r(1467)])}),2e3)},l.onDeviceChangeCallback=void 0,l[o(604)]=function(){const e=o;console[e(531)](e(604)),!l[e(578)]&&(l[e(578)]=setTimeout((()=>{const t=e;s[t(676)](s.Event[t(1115)]),l[t(578)]=void 0}),500))},l.checkDeviceList=async function(e,t){const r=o,n=[];return t[r(1278)]((t=>{const o=r;n[o(649)]((()=>new Promise((r=>{const n=o;if(e==l[n(698)][n(977)]){const e=l[n(1605)].devices[n(998)][n(1560)][n(719)]((e=>e.id===t.id));if(e&&e[n(1828)])t[n(1828)]=e[n(1828)],r();else{const e={video:{deviceId:{exact:t.id}}};navigator.mediaDevices[n(776)](e).then((e=>{const o=n;e.getTracks()[o(1278)]((e=>{const r=o;e[r(1661)]===l[r(698)][r(977)]&&(t[r(1828)]=e[r(1642)]()),e[r(1318)]&&e.stop()})),r()}))[n(1549)]((()=>{r()}))}}}))))})),((e,t=10,r)=>new Promise(((o,n)=>{const i=g,s=[...e],a=s[i(1840)]<t?s[i(1840)]:t,c=s[i(854)](0,a),d=new Array(e[i(1840)]);let u=!1,l=a,p=0;const m=()=>{const t=i;if(r){const o=((e[t(1840)]-(l+s.length))/e.length)[t(541)](2);r({loaded:o})}},f=(e,t)=>{const r=i;e()[r(1217)]((e=>{const n=r;u||(d[t]=e,s[n(1840)]>0?(f(s[n(1636)](),++p),m()):(l--,m(),0===l&&o(d)))}))[r(1549)]((e=>{u||(u=!0,n({index:t,error:e}))}))};c[i(1278)](((e,t)=>{p=t,f(e,t)}))})))(n,M[r(963)]?1:10)},l[o(1306)]=function(e={}){const t=o;let r=0,n=!1,i=!1;if(l[t(1605)].devices[t(1408)]&&(r++,n=!0),l.core[t(1910)][t(1560)]&&(r++,i=!0),1===r){if(n&&void 0===e[t(1408)][t(719)]((e=>e.id===l[t(1605)][t(1910)][t(1408)])))return l[t(1638)](l[t(1127)].AudioInput,"");if(i&&void 0===e[t(1560)].find((e=>e.id===l[t(1605)].devices.videoinput)))return l[t(1638)](l[t(1127)][t(1688)],"")}else if(2===r){let r=void 0===e[t(1408)].find((e=>e.id===l.core[t(1910)].audioinput)),o=void 0===e[t(1560)][t(719)]((e=>e.id===l[t(1605)][t(1910)][t(1560)]));if(r&&o)return l[t(1605)].devices[t(1408)]="",l.setDevicePreference(l[t(1127)][t(1688)],"");if(r)return l[t(1638)](l[t(1127)].AudioInput,"");if(o)return l[t(1638)](l.DeviceType[t(1688)],"")}},l.optimizeDeviceList=async function(e,t){const r=o;let n=l[r(1605)][r(1910)].detail,i=n.audioinput[r(1767)]((t=>{const o=r;return void 0===e[o(1408)][o(719)]((e=>e.id===t.id))})),a=n[r(1560)][r(1767)]((t=>{const o=r;return void 0===e[o(1560)][o(719)]((e=>e.id===t.id))}));if(i[r(1840)]>0){let t=n[r(1560)][r(1767)]((e=>{const t=r;return e.group&&void 0!==i[t(719)]((r=>r[t(1210)]===e[t(1210)]))}));e.videoinput=e[r(1560)].filter((e=>{const o=r;return void 0===t.find((t=>t[o(1680)]===e[o(1680)]))}))}if(a[r(1840)]>0){let t=n[r(1408)][r(1767)]((e=>{const t=r;return e[t(1210)]&&void 0!==a[t(719)]((r=>r[t(1210)]===e[t(1210)]))}));e[r(1408)]=e[r(1408)].filter((e=>{const o=r;return void 0===t[o(719)]((t=>t.name===e[o(1680)]))}))}t&&await l[r(1175)](l[r(698)][r(977)],e[r(1560)]),l.resetDefaultDevice(e),l.core[r(1910)][r(998)]=e,s[r(676)](s[r(1211)].deviceList,e)},l[o(1469)]=async function(e){const t=o,r=Object[t(1847)](l[t(1127)]),n={},s={};r[t(1278)]((e=>{s[e]=[],n[e]={}})),navigator[t(1783)][t(1204)]!==l.onDeviceChange&&(navigator[t(1783)][t(1204)]=l[t(604)]);let a=[];try{a=await navigator[t(1783)][t(822)]()}catch(e){return i[t(1908)]("get device list error, "+e)}a.forEach((function(e){const r=t;if(e[r(1260)]&&s[e[r(1661)]])if(e[r(1260)]===r(1784))n[e[r(1661)]]={id:e.deviceId,name:e.label||e[r(1661)]+":"+e[r(1260)].substr(0,8),group:e[r(1122)],selected:!1};else if("communications"!==e[r(1260)]){const t={id:e[r(1260)],name:e[r(1699)]||e[r(1661)]+":"+e[r(1260)][r(803)](0,8),group:e[r(1122)]};""!==n[e[r(1661)]][r(1210)]&&e[r(1122)]===n[e[r(1661)]].group?(n[e.kind][r(1190)]=!0,s[e[r(1661)]].unshift(t)):s[e[r(1661)]][r(649)](t)}})),r.forEach((e=>{const r=t;!n[e][r(1190)]&&n[e].id&&(delete n[e].selected,s[e][r(942)](n[e]))})),l.optimizeDeviceList(s,e)[t(1217)]()},l[o(1693)]=function(e){return new Promise(((t,r)=>{const o=g,n=l[o(1605)][o(1910)][o(998)][o(1408)],i=l.core[o(1910)][o(998)][o(497)],s=l.core[o(1910)][o(998)][o(1560)];let a=null;if(a=s[o(719)]((t=>t.id===e)),a)if(a.capabilities)t(JSON[o(864)](JSON[o(1857)](a)));else{const e={video:{deviceId:{exact:a.id}}};navigator[o(1783)][o(776)](e)[o(1217)]((e=>{const r=o;e.getTracks()[r(1278)]((e=>{const t=r;e[t(1661)]===l[t(698)][t(977)]&&(a[t(1828)]=e.getCapabilities()),l[t(1630)](e)})),t(JSON[r(864)](JSON.stringify(a)))}))[o(1549)]((()=>{const e=o;t(JSON.parse(JSON[e(1857)](a)))}))}else a=n[o(719)]((t=>t.id===e)),a?t(JSON[o(864)](JSON[o(1857)](a))):(a=i[o(719)]((t=>t.id===e)),a?t(JSON[o(864)](JSON[o(1857)](a))):r(o(674)))}))},l[o(1638)]=function(e="",t=""){const r=o;if(l.core[r(1910)][r(1550)](e)&&l[r(1605)].devices[e]!==t)if(e===l[r(1127)][r(1688)]&&(l[r(1605)].devices[r(1444)+e]=l.core[r(1910)][e]),l[r(1605)][r(1910)][e]=t,e===l[r(1127)][r(587)])Object[r(1847)](l[r(1605)].publishers).forEach((e=>{const o=r;e[o(612)]&&l.setElementSinkId(e[o(612)],t)}));else if(l.core[r(1365)][r(924)]){let t=e===l[r(1127)][r(969)],o=!t;l[r(1735)](null,!0,t,o)[r(1217)]()}},l[o(655)]=function(e,t){const r=o;let n=null;if(e===l[r(932)][r(910)])n=l.core[r(1365)],l[r(1558)][r(1262)]=[t];else{if(!l[r(1605)].cameraEx[e])return void i[r(1446)](r(1647));n=l[r(1605)].cameraEx[e],l.options[r(1544)]=[t]}n[r(1021)]=[t],n.pc&&n[r(1719)]&&(n[r(1719)][r(771)]({width:{ideal:t[r(559)]},height:{ideal:t[r(958)]}}).then((()=>{const e=r;i[e(1134)](e(1543))})).catch((e=>{const t=r;i[t(1908)](t(903),e)})),l[r(1474)](n.pc,t))},l.setVideoElementStream=function(e,t){const r=o;if(!(e&&e instanceof HTMLElement))return!1;try{return e[r(1501)]=t,e.controls=!1,e.muted=!0,e.onplay=()=>{const t=r;e[t(1812)]=null,i[t(1134)](e.id+t(808))},!0}catch(e){return i.logError(r(1041)+e),!1}},l.setAudioElementStream=function(e,t){const r=o;if(e&&e instanceof HTMLElement)try{e.srcObject=t,e[r(1566)]=!1,e[r(1812)]=()=>{e[r(1812)]=null,i.logInfo(e.id+" play success")}}catch(e){i.logError(r(648)+e)}},l.setElementSinkId=function(e,t){const r=o;e&&t&&(e instanceof HTMLElement&&typeof e[r(1809)]!==r(840)?e[r(859)](t)[r(1217)]().catch((e=>{const o=r;let n=e;e?(n=e.name===o(1025)?o(814)+e:e[o(896)],i[o(1908)](n)):(i[o(1908)](e),n="set audio output error"),l[o(1500)](l[o(1751)][o(1007)],{deviceType:l.DeviceType[o(587)],deviceID:t,desc:n})})):(i[r(1908)]("you browser does not support output device selection"),l[r(1500)](l[r(1751)][r(1007)],{deviceType:l[r(1127)].AudioOutput,deviceID:t,desc:r(1290)})))},l[o(1886)]=function(e=""){const t=o;if(!e)return e;let r=e[t(997)]("-");return r[t(854)](0,r[t(1840)]-1).join("-")},l[o(778)]=function(e=""){const t=o;if(e===l[t(1605)].camera.id)return l.core[t(1365)];if(e===l[t(1605)][t(1285)].id)return l.core.screen;if(e===l[t(1605)][t(1044)].id)return l[t(1605)][t(1044)];if(l[t(1605)][t(1898)][t(1550)](e))return l.core[t(1898)][e];{let r=l[t(1886)](e);return l.core.publishers[r]?l[t(1605)].publishers[r]:Object.values(l[t(1605)][t(1331)])[t(719)]((t=>t.id===e))||null}},l[o(760)]=function(e="",t=l[o(1098)][o(905)]){const r=o;if(e){if(t===l.StreamRole[r(905)]){let t=Object.values(l[r(1605)][r(1898)]);for(let o=0,n=t[r(1840)];o<n;o++)if(t[o].lastRequestID===e)return t[o];return null}return l.core[r(1365)][r(688)]===e?l[r(1605)][r(1365)]:l[r(1605)][r(1285)][r(688)]===e?l.core.screen:l[r(1605)][r(1044)][r(688)]===e?l[r(1605)][r(1044)]:Object.values(l[r(1605)][r(1331)])[r(719)]((t=>t[r(688)]===e))}},l[o(1772)]=function(e){const t=o;let r=l[t(1605)][t(1898)][e];return!r&&Object[t(1847)](l[t(1605)][t(1898)])[t(1278)]((t=>{t.tag===e&&(r=t)})),r},l[o(797)]=function(e){const t=o,{tag:r,type:n,subType:i,local:s}=e;if(!s)return e.layers;let a=[];return a=r?n===l[t(932)][t(910)]?l[t(1558)][t(1544)]:l.options[t(1878)]:n===l[t(932)][t(910)]?l[t(1558)][t(1262)]:i===l[t(978)][t(1340)]?l[t(1558)][t(1826)]:l[t(1558)][t(1878)],a},l[o(691)]=function(e){const t=o;i.logInfo(t(1679)),Object[t(1847)](l[t(932)])[t(1278)]((e=>{const r=t;l[r(1605)][e].id&&l.core[e].ready&&(l[r(898)](l[r(1605)][e]),l[r(1314)](e,"",l[r(1605)][e].info?l.core[e][r(1577)][r(1042)]:"",l[r(1605)][e][r(1288)]))})),e[t(1278)]((e=>{const r=t;l[r(1605)][r(781)][e[r(1322)]]?(e[r(902)].forEach((t=>{const o=r;l[o(1605)][o(781)][e[o(1322)]][o(902)][o(1100)](t[o(1390)])<0?(l[o(1605)][o(781)][e.userID][o(902)][o(649)](t[o(1390)]),l.core[o(1898)][t[o(1390)]]=Object[o(1509)]({uid:e.userID,dType:e[o(1690)],local:!1,ready:!1,localMuteAudio:!1,localMuteVideo:!1,candidate:[]},t)):(l[o(1605)][o(1898)][t.publishID][o(1870)]!==t[o(1870)]&&(l[o(1605)][o(1898)][t[o(1390)]][o(1870)]=t[o(1870)]),l[o(1605)][o(1898)][t[o(1390)]][o(504)]!==t[o(504)]&&(l[o(1605)].publishers[t.publishID][o(504)]=t[o(504)]),l[o(1605)].publishers[t.publishID][o(1744)]&&(l.resetStreamData(l[o(1605)][o(1898)][t.publishID]),l[o(748)](e[o(1322)],t[o(1390)])))})),l.core[r(781)][e[r(1322)]][r(902)][r(1278)]((t=>{const o=r;!e[o(902)].find((e=>e[o(1390)]===t))&&l[o(898)](l[o(1605)][o(1898)][t],!0)}))):(l[r(1605)].users[e[r(1322)]]={uid:e[r(1322)],dType:e.dType,streams:[]},e[r(902)][r(1278)]((t=>{const o=r;l[o(1605)][o(781)][e[o(1322)]][o(902)][o(649)](t.publishID),l[o(1605)][o(1898)][t[o(1390)]]=Object[o(1509)]({uid:e[o(1322)],dType:e.dType,local:!1,ready:!1,localMuteAudio:!1,localMuteVideo:!1,candidate:[]},t)})))}))},l[o(1427)]=function(e){const t=o;i[t(1134)](t(1741));let r=[];e[t(1278)]((e=>{const o=t;e[o(1322)]===l[o(1605)][o(1322)]?(Object.values(l[o(932)])[o(1278)]((t=>{const r=o;if(l[r(1605)][t].id&&l[r(1605)][t][r(1744)]){let o=e.streams.find((e=>e.publishID===l[r(1605)][t].id));o?(["connected",r(1401)][r(1100)](l[r(1605)][t].pc[r(1838)])<0?l[r(586)](l[r(1605)][t]):(l[r(1605)][t].muteAudio!==o[r(504)]||l[r(1605)][t][r(1870)]!==o[r(1870)])&&l.wsUpdate(o[r(1390)],l[r(1605)][t].muteVideo,l.core[t][r(504)]),e[r(902)]=e[r(902)][r(1767)]((e=>e[r(1390)]!==l[r(1605)][t].id))):(l[r(898)](l[r(1605)][t]),l[r(1314)](t,"",l[r(1605)][t][r(1577)]?l[r(1605)][t].info.app:"",l[r(1605)][t][r(1288)]))}})),e[o(902)][o(1278)]((e=>{const t=o;l.wsUnPublish(e[t(1049)],e[t(1390)])})),r=e[o(1383)]||[]):l[o(1605)][o(781)][e[o(1322)]]?(e[o(902)][o(1278)]((t=>{const r=o;l[r(1605)][r(781)][e[r(1322)]][r(902)][r(1100)](t[r(1390)])<0?(l[r(1605)].users[e.userID][r(902)][r(649)](t.publishID),l[r(1605)][r(1898)][t[r(1390)]]=Object[r(1509)]({uid:e[r(1322)],dType:e[r(1690)],local:!1,ready:!1,localMuteAudio:!1,localMuteVideo:!1,candidate:[]},t)):(l[r(1605)].publishers[t.publishID][r(1870)]!==t[r(1870)]&&(l[r(1605)][r(1898)][t[r(1390)]][r(1870)]=t[r(1870)]),l.core.publishers[t[r(1390)]].muteAudio!==t.muteAudio&&(l[r(1605)].publishers[t[r(1390)]][r(504)]=t[r(504)]))})),l[o(1605)][o(781)][e[o(1322)]][o(902)][o(1278)]((t=>{const r=o;!e[r(902)][r(719)]((e=>e[r(1390)]===t))&&l.resetStreamData(l[r(1605)].publishers[t],!0)}))):(l[o(1605)][o(781)][e[o(1322)]]={uid:e.userID,dType:e[o(1690)],streams:[]},e[o(902)][o(1278)]((t=>{const r=o;l.core[r(781)][e[r(1322)]].streams[r(649)](t.publishID),l[r(1605)][r(1898)][t[r(1390)]]=Object[r(1509)]({uid:e[r(1322)],local:!1,ready:!1,localMuteAudio:!1,localMuteVideo:!1,candidate:[]},t)})))})),r[t(1278)]((e=>{const r=t;l[r(1605)][r(1898)][e[r(1390)]]?l[r(1605)].publishers[e[r(1390)]].id&&l[r(1605)][r(1898)][e[r(1390)]][r(1744)]&&l.core[r(1898)][e[r(1390)]].id===e[r(1923)]&&([r(1734),r(1401)][r(1100)](l[r(1605)][r(1898)][e[r(1390)]].pc.iceConnectionState)<0?l.restartRtcPeerConn(l[r(1605)].publishers[e[r(1390)]]):((e[r(504)]!==l.core[r(1898)][e[r(1390)]][r(1681)]||e[r(1870)]!==l[r(1605)].publishers[e[r(1390)]][r(962)])&&l[r(1125)](e.subscribeID,l[r(1605)][r(1898)][e.publishID].localMuteVideo,l[r(1605)][r(1898)][e[r(1390)]][r(1681)]),e[r(1368)]!==l[r(1605)][r(1898)][e.publishID][r(1368)]&&l[r(1845)](e[r(1923)],l.core[r(1898)][e[r(1390)]][r(1368)]))):l[r(641)](e[r(1923)])})),Object[t(1323)](l[t(1605)][t(781)])[t(1278)]((r=>{const o=t;!e[o(719)]((e=>e.userID===r))&&(l[o(1605)][o(781)][r][o(902)].forEach((e=>{const t=o;l[t(1605)][t(1898)][e]&&l[t(1605)].publishers[e].id&&l[t(898)](l[t(1605)][t(1898)][e],!0)})),delete l[o(1605)][o(781)][r])}))},l[o(1389)]=function(e=[],t=!1){if(!(e&&e instanceof Array&&0!==e[o(1840)])){if(t)return;e=[]}let r=JSON.parse(JSON.stringify(e));return t?l.reviseStreamDataRejoining(r):l.reviseStreamDataNormal(r)},l[o(1225)]=function(e){const t=o;e&&delete l[t(1605)][t(593)][e];let r=l[t(778)](e);if(r)if(r.local){i.logInfo("reconnect stream "+e+t(1750));let o=r[t(1049)],n=r[t(1019)]||"",s=r[t(1577)]?r[t(1577)][t(1042)]:"";l.wsUnPublish(o,r.id,r.tag,r[t(1288)]),l[t(1314)](o,n,s,r[t(1288)])}else i[t(1134)]("reconnect stream "+e+t(950)),l.wsUnsubscribe(r.id,(()=>{const e=t;l[e(748)](r[e(1322)],r.publishID)}));else i.logError(t(1810)+e+" failed")},l[o(929)]=function(e=!1){const t=o;l[t(898)](l[t(1605)][t(1365)]),l[t(1605)].camera[t(1870)]=!1,l[t(1605)][t(1365)][t(504)]=!1,l[t(898)](l[t(1605)][t(1285)]),l[t(1605)][t(1365)].muteVideo=!1,l[t(1605)][t(1365)][t(504)]=!1,l.core.cameraEx={},!e&&(Object[t(1847)](l[t(1605)][t(1898)])[t(1278)]((e=>l[t(898)](e))),l[t(1605)][t(1898)]=[],l[t(1759)]={video:{},audio:{},enableInspire:!1,options:{activeDuration:1800,inactiveDuration:1500}},l[t(890)]={},l[t(1605)][t(1733)][t(581)]={},l.core[t(1733)][t(1663)]={},l[t(1605)].network.netWeakStats={})},l[o(898)]=function(e,t=!1){const r=o;if(!e)return;clearInterval(l[r(1467)]),l.closeRtcPeerConn(e),t&&(l[r(1605)][r(781)][e[r(943)]]&&(l[r(1605)][r(781)][e[r(943)]].streams=l[r(1605)].users[e[r(943)]][r(902)][r(1767)]((t=>t!==e[r(1390)]))),l[r(1605)].publishers[e.publishID]&&delete l[r(1605)][r(1898)][e[r(1390)]]),l[r(1779)](e);let n=e.local?e.tag?e[r(1049)]+"-"+e.tag:e.type:e[r(1390)];l[r(1649)](n),e.id="",e[r(1744)]=!1,e.candidate=[],e[r(1577)]={app:"",rtc:"",act:0},e[r(1376)]=0,e.checkedStreamFirstUpload=!1,e[r(688)]="",e[r(1071)]&&clearTimeout(e[r(1071)]),e[r(612)]&&(e.audioElem.onplay=null,l[r(1781)](e.audioElem)),e.videoElem&&(e[r(547)][r(1812)]=null,l[r(1781)](e[r(547)]))},l[o(1779)]=function(e){const t=o,r=l[t(1605)][t(1733)],n=l[t(1759)];if(r[t(581)][e.id]&&delete r[t(581)][e.id],r[t(1663)][e.id]&&delete r[t(1663)][e.id],r[t(758)][e.id]){const o=r[t(758)][e.id];o&&(o[t(598)]||e.weak)&&(o[t(922)]=!0,o[t(598)]=!1,e[t(861)]=!1,Promise[t(1086)]()[t(1217)]((()=>{l[t(1119)]()}))),delete r[t(758)][e.id]}n[t(1542)][e.id]&&delete n.audio[e.id],n.video[e.id]&&delete n[t(1063)][e.id],delete l[t(890)][e.id]},l.cleanTimer=function(){const e=o;clearInterval(l[e(512)]),clearInterval(l[e(1820)]),clearInterval(l[e(1245)]),clearInterval(l.qosLogTimer),clearInterval(l[e(503)]),clearInterval(l.core[e(1111)][e(1258)])},l[o(1781)]=function(e){const t=o;for(let r=0;r<l[t(1605)][t(920)][t(1840)];r++)if(l.core[t(920)][r]===e){l[t(1605)].unableAutoPlay.splice(r,1);break}},l[o(1608)]=function(){const e=o;if(0===l[e(1605)][e(1659)])return;let t=l[e(1605)].retry,r=1e4;0===t?r=0:t<5&&(r=1e3<<t-1),i.logInfo("websocket disconnected, retry",++l[e(1605)][e(1376)],r),s[e(676)](s.Event[e(1191)],l[e(1605)][e(1376)]),l.reconnectTimeout=setTimeout((()=>{const t=e;l.joinRoom(l[t(1605)].roomName,l[t(1605)][t(1322)],l[t(1605)][t(681)],l.core.userArea,l[t(1605)].userRole,!0)}),r)},l[o(1759)]={video:{},audio:{},enableInspire:!1,options:{activeDuration:1500,inactiveDuration:1500}},l[o(912)]=function(){const e=o;let t=l[e(1605)][e(1111)];t[e(1722)]&&(!u&&t.audioProcessor[e(538)](l.audioContext[e(812)]),t[e(1503)].disconnect(t[e(1722)]),delete t[e(1722)],delete t[e(1503)]),t[e(539)]=null},l.releaseAudioProcessor=function(e=""){const t=o;Object[t(1323)](l[t(1759)][t(1542)])[t(1278)]((r=>{const o=t;if(""===e||e===r){let e=l[o(1759)][o(1542)][r];e&&e[o(1722)]&&(!u&&e[o(1722)][o(538)](l[o(1393)][o(812)]),e[o(1503)][o(538)](e.audioProcessor),delete e[o(1722)]),delete l.historyReport[o(1542)][r]}}))};class p extends u{constructor(e,t){const r=o;super(e,r(1800)),this[r(856)]=t,this[r(1473)][r(1154)]=this[r(1155)][r(1492)](this),this[r(1223)]=0}[o(1155)](e){const t=o;try{e[t(1238)][t(1800)]?(l.historyReport.audio[this[t(856)]]?l[t(1759)].audio[this[t(856)]].audioLevel=e[t(1238)][t(1800)]||0:this[t(856)]===l[t(1605)][t(1111)][t(1049)]&&(l[t(1605)][t(1111)][t(1800)]=e[t(1238)][t(1800)]),this[t(1223)]=0):0===e[t(1238)][t(1800)]&&(this[t(1223)]>=5?(l[t(1759)].audio[this.streamID]?l[t(1759)][t(1542)][this[t(856)]][t(1800)]=0:this[t(856)]===l[t(1605)].audioTest.type&&(l.core.audioTest[t(1800)]=0),this[t(1223)]=0):this[t(1223)]++)}catch(e){i.logInfo(this[t(856)],e[t(1644)]())}}}return l[o(1008)]=function(){const e=o,t=[0,1,2,3,4,4,5,5,5,5,6,6,6,6,6,7,7,7,7,8,8,8,9,9,9,9,9,9,9,9,9,9,9],r=(e,t,r)=>{const o=g,n=Date[o(1913)]();e[o(1800)]>8&&!e[o(504)]&&r?(0===e[o(733)]&&(e[o(733)]=n),e[o(1672)]=n,e[o(870)]=0):(0===e.startMuteTime&&(e[o(870)]=n),n-e[o(870)]>t?(e.isInspired&&(i[o(1134)](o(488)+e.publishID+o(1490)+e.type+o(918)+e[o(1137)]),e[o(845)]=!1),e[o(733)]=0,e[o(1672)]=0,e[o(870)]=0):e.startSpeakTime>0&&(e[o(1672)]=n))},n=e=>{e=e>=100?99:e;return 10*t[Math[g(1395)](33*e/100)]};Object[e(1847)](l[e(1605)][e(1898)])[e(1278)]((t=>{const o=e;if(!t.pc||"connected"!==t.pc[o(901)])return;let s=t[o(1390)],a=t[o(1049)];!l[o(1759)][o(1542)][s]&&(l[o(1759)][o(1542)][s]={audioLevel:0,levelList:[],isInspired:!1,local:!1,muteAudio:t.muteAudio,publishID:s,type:a,startSpeakTime:0,startMuteTime:0,continueSpeakTime:0,startVoiceMax:0,continueVoiceMax:0});const c=l[o(1759)][o(1542)][s];if(l.audioContext&&t[o(539)]&&t.stream[o(1023)]()[o(1840)]>0&&!c[o(1722)]){let e,r=l[o(1393)][o(826)](t[o(539)]);u?(e=new p(l[o(1393)],s),r[o(1266)](e)):(e=l[o(1393)][o(1002)](4096,1,1),r.connect(e),e[o(1266)](l[o(1393)][o(812)]),e[o(1337)](o(529),(e=>{const t=o;let r=e[t(514)][t(1141)](0);try{c[t(1800)]=Math[t(1395)](100*Math[t(836)].apply(Math,r))}catch(e){i[t(1134)](s,e[t(1644)]())}}))),c[o(1503)]=r,c.audioProcessor=e,c.stream=t[o(539)]}t[o(504)]?c[o(1800)]=0:l[o(1759)][o(815)]&&(c[o(1800)]=n(c[o(1800)])),c[o(1240)].push(c[o(1800)]),c[o(1240)][o(1840)]>=20&&(l[o(1558)][o(1214)]&&i[o(1134)](o(1628)+s+o(1167),c[o(1240)]),c[o(1240)]=[]),l.historyReport[o(815)]&&r(c,l.historyReport[o(1558)].inactiveDuration,!!t.pc)})),[l[e(1605)][e(1365)],l[e(1605)][e(1285)],l[e(1605)][e(1044)]][e(1612)](Object.values(l[e(1605)][e(1331)]))[e(1278)]((t=>{const o=e;if(!t[o(924)])return;let s=t.type,a=t[o(1019)],c=a?s+"-"+a:s;!l[o(1759)][o(1542)][c]&&(l[o(1759)][o(1542)][c]={audioLevel:0,levelList:[],isInspired:!1,local:!0,muteAudio:t[o(504)],publishID:t.id,type:c,startSpeakTime:0,startMuteTime:0,continueSpeakTime:0});const d=l[o(1759)].audio[c];if(!d[o(1722)]&&l[o(1393)]&&t[o(539)]&&t.stream.getAudioTracks().length>0){let e,r=l[o(1393)].createMediaStreamSource(t[o(539)]);u?(e=new p(l[o(1393)],c),r[o(1266)](e)):(e=l[o(1393)][o(1002)](4096,1,1),r.connect(e),e[o(1266)](l[o(1393)][o(812)]),e[o(1337)](o(529),(e=>{const t=o;let r=e[t(514)].getChannelData(0);if(r)try{d[t(1800)]=Math[t(1395)](100*Math[t(836)].apply(Math,r))}catch(e){i.logInfo(c,e[t(1644)]())}}))),d[o(1503)]=r,d[o(1722)]=e}l[o(1759)].enableInspire&&(d.audioLevel=n(d[o(1800)])),d[o(1240)][o(649)](d.audioLevel),d.levelList.length>=20&&(l[o(1558)][o(1214)]&&i[o(1134)]("local pubid:"+c+o(1167),d[o(1240)]),d[o(1240)]=[]),l[o(1759)][o(815)]&&r(d,l[o(1759)][o(1558)].inactiveDuration,!!t.pc)}));const a=l[e(1759)].audio,c={remote:[],local:[]};if(l[e(1759)][e(815)]){const t=l[e(1759)].options[e(1361)];let r=0,o=null,n=null;c.inspiredStream=null,Object[e(1323)](a)[e(1840)]>0&&(Object[e(1323)](a).forEach((s=>{const c=e,d=a[s];!n&&d[c(845)]?n=d:n&&d[c(845)]&&i.logWarn(c(1701)+d[c(1390)]);let u=0;d[c(733)]>0&&(u=d.continueSpeakTime-d.startSpeakTime),(0===r&&u>t||r>d[c(733)]&&u>t)&&(r=d.startSpeakTime,o=d)})),!n&&o&&(n=o,n.isInspired=!0,n.startMuteTime=0,i.logInfo(e(1164)+n[e(1390)]+e(1490)+n[e(1049)]+", local: "+n[e(1137)]+e(1818)+(n[e(1672)]-n[e(733)]))),Object[e(1323)](a).forEach((t=>{const r=e,o=a[t],n={publishID:o[r(1390)],type:o.type,audioLevel:o[r(1800)],isInspired:o.isInspired};o[r(845)]&&(c[r(1590)]=n),o[r(1137)]?c[r(1137)].push(n):c.remote[r(649)](n)})),s[e(676)](s[e(1211)][e(512)],c))}else Object[e(1323)](a)[e(1840)]>0&&(Object[e(1323)](a)[e(1278)]((t=>{const r=e,o=a[t],n={publishID:o.publishID,type:o[r(1049)],audioLevel:o[r(1800)]};o.local?c[r(1137)].push(n):c[r(1915)].push(n)})),s[e(676)](s[e(1211)].audioReport,c))},l[o(907)]=function(e,t,r,n,s){const a=o;if(!l[a(1393)]&&i[a(1446)](a(1375)),!t)return l[a(1649)](),clearInterval(l.audioReport),void delete l.audioReport;l[a(512)]||(l[a(1759)][a(815)]=n,s&&(l[a(1759)][a(1558)]=s),l.audioReport=setInterval(l[a(1008)],r))},l[o(1671)]=function(e,t,r){const n=o,s=l.core[n(1111)];if(!e)return clearInterval(s.auidoInterval),s[n(1800)]=0,s[n(1240)]=[],void(s[n(539)]&&l[n(912)]());s[n(539)]=t,l.initAudioContext(),i[n(1134)](n(880)+r),s.auidoInterval=setInterval(l.routineAudioTestReport,r)},l[o(1535)]=function(){const e=o,t=[0,1,2,3,4,4,5,5,5,5,6,6,6,6,6,7,7,7,7,8,8,8,9,9,9,9,9,9,9,9,9,9,9],r=l.core[e(1111)];if(!r.audioProcessor&&l[e(1393)]&&r[e(539)]&&r[e(539)][e(1023)]().length>0){let t,o=l.audioContext[e(826)](r[e(539)]);u?(t=new p(l[e(1393)],r.type),o[e(1266)](t)):(t=l[e(1393)][e(1002)](4096,1,1),o[e(1266)](t),t[e(1266)](l[e(1393)][e(812)]),t[e(1337)](e(529),(t=>{const o=e;let n=t[o(514)].getChannelData(0);if(n)try{r[o(1800)]=Math[o(1395)](100*Math.max[o(725)](Math,n))}catch(e){i[o(1134)](sid,e[o(1644)]())}}))),r[e(1503)]=o,r[e(1722)]=t}r.audioLevel=(e=>{e=e>=100?99:e;return 10*t[Math[g(1395)](33*e/100)]})(r[e(1800)]),r.levelList.push(r[e(1800)]),r[e(1240)][e(1840)]>=20&&(i[e(1134)]("auidoTest, levelList:",r[e(1240)]),r.levelList=[]),s[e(676)](s[e(1211)][e(1111)],{audioLevel:r[e(1800)],type:r[e(1049)]})},l[o(925)]=function(e=!0,t="",r,n={}){const i=o;let s=l[i(1759)][i(1063)][t];!s&&(s={timestamp:r.timestamp,bytesSent:0,framesSent:0,framesEncoded:0});let a=r.timestamp-s[i(1545)];n.videoFrameWidth=r.frameWidth||0,n.videoFrameHeight=r[i(663)]||0;let c="bytes"+i(e?702:914);n.videoBitrate=I(r[c],s[c],a,8);let d=i(1712)+(e?"Sent":"Received"),u=i(582)+(e?"Sent":"Received");n[d]=I(r[u],s[u],a,1e3);let p=i(1712)+i(e?1431:872),m=i(582)+(e?"Encoded":i(872));n[p]=I(r[m],s[m],a,1e3)},l.setStreamReport=function(e=!0,t="",r){const n=o;!l[n(1759)][n(1063)][t]&&(l[n(1759)][n(1063)][t]={}),l.historyReport[n(1063)][t][n(1545)]=r.timestamp;let i="bytes"+n(e?702:914);l[n(1759)][n(1063)][t][i]=r[i];let s=n(582)+n(e?702:914);l[n(1759)][n(1063)][t][s]=r[s];let a=n(582)+(e?"Encoded":n(872));l[n(1759)][n(1063)][t][a]=r[a]},l[o(1426)]=function(){const e=o;let t={remote:[],local:[]},r=[];Object.values(l[e(1605)][e(1898)])[e(1278)]((e=>{r.push(new Promise((r=>{const o=g;if(!e.pc||e.pc.connectionState!==o(1734))return r();e.pc[o(682)]().then((n=>{const i=o;let s=e[i(1390)],a={publishID:e.publishID,type:e.type};return n.forEach((t=>{const r=i;t[r(1049)]===r(1602)&&"video"===t.kind&&t[r(1144)]!==l[r(1605)][r(1585)]&&(l[r(925)](!1,e[r(1390)],t,a),l[r(1117)](!1,e[r(1390)],t))})),t.remote[i(649)](a),!l[i(1759)][i(1063)][s]&&(l[i(1759)][i(1063)][s]={}),!l[i(1759)][i(1063)][s][i(1300)]&&(l[i(1759)][i(1063)][s].reportInfo={bitrateList:[],FpsList:[]}),l.historyReport[i(1063)][s][i(1300)][i(602)][i(649)](a.videoBitrate),l[i(1759)][i(1063)][s].reportInfo[i(1143)][i(649)](a.videoFPSReceived),l[i(1759)][i(1063)][s][i(1300)][i(602)][i(1840)]>=20&&(l[i(1759)][i(1063)][s][i(1300)].bitrateList=[],l.historyReport[i(1063)][s][i(1300)][i(1143)]=[]),r()}))})))})),[l.core.camera,l.core[e(1285)],l.core[e(1044)]][e(1612)](Object[e(1847)](l[e(1605)][e(1331)]))[e(1278)]((o=>{const n=e;let i=o.tag,s=o.type,a=i?s+"-"+i:s;o[n(924)]&&o.pc&&o.pc[n(901)]===n(1734)&&r[n(649)](new Promise((e=>{const r=n;o.pc[r(682)]()[r(1217)]((n=>{const i=r;let s=o.id,c={publishID:o.id,type:a,videoFrameWidth:0,videoFrameHeight:0,videoBitrate:0,videoFPSSent:0,videoFPSEncoded:0},d=[];n[i(1278)]((e=>{const t=i;"outbound-rtp"===e[t(1049)]&&e[t(1661)]===t(1063)&&d[t(649)](e)})),d[i(1849)](((e,t)=>e.frameHeight-t[i(663)]));for(let e=o[i(1368)];e>=0;e--){let t=d[e];if(t&&t.bytesSent){l.getStreamReport(!0,a,t,c),l[i(1117)](!0,a,t);break}}return t.local[i(649)](c),!l[i(1759)].video[s]&&(l.historyReport[i(1063)][s]={}),!l.historyReport.video[s][i(1300)]&&(l[i(1759)].video[s][i(1300)]={bitrateList:[],FpsList:[]}),l[i(1759)].video[s][i(1300)].bitrateList.push(c.videoBitrate),l[i(1759)][i(1063)][s][i(1300)].FpsList.push(c[i(802)]),l[i(1759)].video[s][i(1300)][i(602)][i(1840)]>=20&&(l.historyReport[i(1063)][s][i(1300)][i(602)]=[],l[i(1759)][i(1063)][s][i(1300)][i(1143)]=[]),e()}))})))})),Promise[e(1355)](r)[e(1217)]((()=>{const r=e;Object[r(1323)](t)[r(1840)]>0&&s[r(676)](s[r(1211)][r(1820)],t)}))},l[o(1283)]=function(e,t){const r=o;e?l[r(1820)]||(l[r(1820)]=setInterval(l.routineVideoReport,t)):l[r(1820)]&&(clearInterval(l[r(1820)]),delete l[r(1820)])},l.emitNetworkReport=function(){const e=o,t=l[e(1605)][e(1733)],r=t.uplinkStats,n=t.downlinkStats;t[e(1009)];const i={local:[],remote:[],level:0};l[e(1119)](),Object.keys(r)[e(1278)]((t=>{const r=e,o=l[r(778)](t);i.local[r(649)]({level:l[r(1653)](t,!0),publishID:o.id})})),Object[e(1323)](n)[e(1278)]((t=>{const r=e,o=l.getStreamInfo(t);i[r(1915)][r(649)]({level:l.getStreamNetLevel(t,!1),subscribeID:o.id,publishID:o[r(1390)]})})),i[e(985)]=l[e(1128)](),s.emit(s[e(1211)][e(1245)],i)},l[o(1119)]=function(){const e=o,t=l[e(1605)][e(1733)][e(758)],r={local:[],remote:[]};Object[e(1323)](t).forEach((o=>{const n=e,i=t[o],s=l[n(778)](o);i&&s&&i[n(922)]&&(i[n(922)]=!1,s.local?(r[n(1137)][n(649)]({weak:!!i[n(598)],publishID:s.id}),i[n(598)]&&l[n(1793)](l.LogType[n(1619)],{errorType:l[n(1686)][n(619)],errorCode:l[n(1641)][n(619)][n(1034)],errorDesc:n(954)})):r.remote[n(649)]({weak:!!i[n(598)],remoteWeak:!!s[n(861)],subscribeID:s.id,publishID:s.publishID}),l[n(1454)](l.core[n(1322)],s.id,!!i[n(598)]))})),(r.local.length>0||r.remote[e(1840)]>0)&&s[e(676)](s.Event[e(1935)],r)},l[o(1907)]=function(){const e=o;clearInterval(l[e(1468)]),l[e(1468)]=setInterval((()=>{const t=e;l.triggerLogUpload(l[t(1251)].QosEvent)}),l[e(1558)][e(1179)])},l[o(848)]=function(){const e=o,t=100;let r=0,n=0,a=0;clearInterval(l[e(503)]),l[e(503)]=setInterval((()=>{const o=e;let c=!1,d=!1;r++,r>=6&&(c=!0,r=0),n++,n>=300&&(d=!0,n=0),a++;const u=[],p=[];Object[o(1847)](l[o(1605)][o(1898)])[o(1278)]((r=>{const s=o;!l[s(1605)][s(1448)][r.id]&&(l[s(1605)][s(1448)][r.id]={audio:{stuckCount:0,stuckDuration:0,weakDuration:0,time:Date[s(1913)](),type:l[s(1403)][s(1133)],playDuration:0,playTime:Date[s(1913)]()},video:{initTime:Date[s(1913)](),stuckCount:0,stuckDuration:0,weakDuration:0,time:Date[s(1913)](),type:r[s(1049)]===l.StreamType[s(910)]?l[s(1403)].Video:l.MediaType[s(1013)],gapList:[],framesDecoded:0,beginStuckTime:0,lastIntervalTime:Date.now(),totalStuckCount:0,totalStuckDuration:0,playDuration:0,playTime:Date[s(1913)](),hiddenDuration:0,isDownlinkError:!1,isWeak:!1}});const m=l[s(1605)].stuckData[r.id];r[s(1690)]===l.PlatformType.Web&&r[s(1049)]===l[s(932)][s(1013)]&&(a>=12?(a=0,c=!0):c=!1),p[s(649)](new Promise((o=>{const a=s;if(!r.pc||r.pc[a(901)]!==a(1734)||!r[a(1744)]||!r.videoElem)return o();let p=r[a(547)][a(1501)].getVideoTracks()[0];if(!p)return o();r.pc[a(682)](p)[a(1217)]((s=>{const p=a;s[p(1278)]((o=>{const s=p;if(o[s(1049)]===s(1602)&&o[s(1661)]===s(1063)){const a=m[s(1063)],p=r[s(1870)]||r.localMuteVideo;if("number"==typeof o.framesDecoded&&o[s(561)]>0){a[s(1526)][s(649)]({mute:p,framesDecoded:o[s(561)]});const e=l[s(1605)][s(1733)].netWeakStats[r.id];let d=l[s(1605)].peerErrorEvent[r.id][l[s(698)][s(977)]],u=e&&e.isWeak||r[s(861)],m=l[s(806)]();const f=Date[s(1913)]();if(!p){const e=f-a[s(594)];a[s(1599)]+=e,document.hidden&&(a[s(521)]+=e),(u||d)&&(a[s(1066)]+=e)}if(a[s(594)]=f,c){if(p||u||d||document[s(1528)]||!m)a[s(1372)]&&a.lastIntervalTime&&(a[s(1367)]+=a[s(1097)]-a[s(1372)],i[s(1134)](s(1654)+a[s(561)]+"-"+a[s(1367)]+"-"+a[s(507)])),a[s(1372)]=0,u?!a[s(598)]&&(a.isWeak=!0,a.totalStuckDuration>1e4?a[s(1367)]-=1e4:a.totalStuckDuration=0):a[s(598)]=!1,d?!a[s(502)]&&(a[s(502)]=!0,a.totalStuckDuration>5e3?a[s(1367)]-=5e3:a[s(1367)]=0):a[s(502)]=!1;else if(o.framesDecoded<=a[s(561)]){if(!a[s(1372)]){a[s(1372)]=a.lastIntervalTime,a.totalStuckCount++;const e=a[s(1526)][s(854)](0,a[s(1526)][s(1840)]-6);e&&e[s(1278)]((e=>{const r=s;!e[r(1130)]&&a[r(561)]===e[r(561)]&&(a[r(1372)]-=t)})),i.logInfo(s(1280)+a[s(561)]+"-"+a.totalStuckDuration+"-"+a[s(507)])}}else if(a[s(1372)]){a[s(1367)]+=a[s(1097)]-a.beginStuckTime;a.gapList[s(854)](a.gapList[s(1840)]-6,a[s(1526)].length-1)&&a.gapList[s(1278)]((e=>{const r=s;!e.mute&&a[r(561)]===e[r(561)]&&(a.totalStuckDuration+=t)})),a[s(1372)]=0,i[s(1134)](s(1654)+a[s(561)]+"-"+a[s(1367)]+"-"+a[s(507)])}a.initTime&&(a.totalStuckCount=0,a[s(1367)]=0,Date[s(1913)]()-a[s(1640)]>400&&(a[s(1640)]=null)),o[s(1530)]=a[s(507)],o[s(888)]=a.totalStuckDuration,a.framesDecoded=o[s(561)],a.lastIntervalTime=Date.now()}n>12&&a.gapList[s(1840)]>0&&a[s(1526)][s(1636)](),r[s(1853)]=o[s(1853)],r.totalFreezesDuration=o[s(1742)],r[s(561)]=o[s(561)]}d&&(a[s(1372)]&&(a[s(1367)]+=a.lastIntervalTime-a[s(1372)],a[s(1372)]=0,o[s(888)]=a[s(1367)],i[s(1134)](s(1654)+a.framesDecoded+"-"+a[s(1367)]+"-"+a.totalStuckCount)),u[s(649)](function(t,r,o){const n=e,i="number"==typeof t[n(1530)]?t[n(1530)]:r[n(573)],s="number"==typeof t[n(888)]?t[n(888)]:r[n(1378)],a=Date[n(1913)](),c={streamInfo:o,mediaType:r[n(1049)],stuckCount:i-r[n(573)],stuckDuration:s-r[n(1378)]>0?s-r.stuckDuration:0,spanDuration:a-r[n(1905)],playDuration:r[n(1599)],weakDuration:r[n(1066)],mute:r[n(1599)]?0:1};return r[n(573)]=i,r.stuckDuration=s,r.time=a,r[n(1599)]=0,r.weakDuration=0,c}(o,a,r)),a[s(1526)]=[])}})),o()})).catch((e=>{o()}))})))})),p[o(1840)]>0&&Promise.all(p)[o(1217)]((()=>{const t=o;d&&u.length>0&&(l.triggerLogUpload(l[t(1251)].mediaStuck,u),function(t){const r=e;l[r(1558)].videoFreezeLog&&t[r(1278)]((e=>{const t=r;if(e[t(1782)]===l.MediaType[t(977)]||e[t(1068)]===l[t(1403)].Screen){const{streamInfo:r}=e;i.logInfo(t(885)+e[t(1782)]+"-"+e.spanDuration+"-"+e[t(1599)]+"-"+e.weakDuration+"-"+e.mute+"-"+e.stuckCount+"-"+e[t(1378)]+t(671)+!document[t(1528)]+","+r[t(561)]+"-"+r[t(1742)]+"-"+r[t(1853)]),e.stuckDuration/e[t(1599)]>.19&&!e.streamInfo[t(627)]&&(e[t(911)][t(627)]=!0,s[t(676)](s[t(1211)][t(627)]))}}))}(u))}))}),t)},l[o(789)]=function(e,t,r){let o=0;return o=e<=t?1:e>=r?0:1-(e-t)/(r-t),o},l[o(1666)]=function(e,t,r){let o=0;return o=e<=t?0:e>=r?1:(e-t)/(r-t),o},l[o(650)]=function(e){const t=o;let r,n=0;return r=e[t(1019)]?JSON.parse(JSON.stringify(l.options.cameraExLayers)):JSON[t(864)](JSON[t(1857)](l[t(1558)][e[t(1049)]+t(1178)])),r[t(854)](e[t(1368)]+1,r[t(1840)]-e[t(1368)]-1),r[t(1278)]((e=>{n+=e[t(1293)]})),n},l[o(613)]=function(e,t){const r=o;let n;return n=e.tag?JSON[r(864)](JSON[r(1857)](l[r(1558)].cameraExLayers)):JSON.parse(JSON.stringify(l[r(1558)][e[r(1049)]+r(1178)])),n[t].targetBw},l[o(1689)]=function(e,t){const r=o,{kMinVideoBitrate:n,kMinVideoBitrate2:i}=l[r(1605)].network[r(1009)];let s=Math.floor(e===l[r(932)][r(1013)]?t/4:t/3);return s>i?s=i:s<n&&(s=n),s},l[o(1128)]=function(){const e=o,t=l[e(1605)][e(1733)],r=Object[e(1323)](t[e(581)]),n=Object.keys(t[e(1663)]);if(0===r.length&&0==n.length||!l.ws||l.ws.readyState!==WebSocket[e(1059)])return 0;let i=1,s=0,a=!1;r[e(1840)]>0&&(i=0,r[e(1278)]((r=>{const o=e,n=t[o(581)][r],c=t.netWeakStats[r];n[o(504)]&&n[o(1870)]||(s++,(!c||!c[o(598)])&&(i+=n[o(985)]),!n.muteVideo&&(a=!0))})));let c=1,d=0,u=!1;n[e(1840)]>0&&(c=0,n.forEach((r=>{const o=e,n=t[o(1663)][r],i=t[o(758)][r];n[o(504)]&&n[o(1870)]||(d++,(!i||!i[o(598)])&&(c+=n[o(985)]),!n[o(1870)]&&(u=!0))})));let p=1;0==s&&0==d?p=0:s>0&&d>0?a&&u?p=(i+c)/(s+d):u?!a&&(p=c/d):p=i/s:s>0?p=i/s:d>0&&(p=c/d);let m=0;return(s>0||d>0)&&(m=Math.floor(4*p+1.5)),m},l[o(1653)]=function(e,t,r=!1){const n=o,i=l.core.network,s=l[n(778)](e),a=t?i.uplinkStats[e]:i[n(1663)][e],c=i.netWeakStats[e];let d=0;return!r&&(c&&c[n(598)]||s&&s.weak)?d=1:a&&a[n(985)]&&(d=Math[n(1395)](4*a[n(985)]+1.5)),d},l[o(585)]=function({streamInfo:e,pair:t,videoOutList:r,audioOut:n,videoRemoteInList:i,audioRemoteIn:s}){const a=o,c=l[a(1605)].network[a(581)][e.id],{rttMin:d,rttMax:u,kMinVideoBitrate:p,kMinVideoBitrate2:m,fractionLostMin:f,fractionLostMax:b}=l[a(1605)][a(1733)].const,y=l[a(650)](e),v={id:e.id,type:e[a(1049)],muteAudio:e[a(504)],muteVideo:e.muteVideo,timestamp:t?t[a(1545)]:Date[a(1913)](),level:0,outBandWidth:y};if(-1===e.layerIndex)return v[a(985)]=1,v;if(!t)return c;let g=l.getNetworkMinBw(e[a(1049)],l[a(613)](e,0));if(v[a(1346)]=t.availableOutgoingBitrate,r.splice(e[a(1368)]+1,r[a(1840)]-e[a(1368)]-1),i[a(854)](e.layerIndex+1,i[a(1840)]-e[a(1368)]-1),s&&(v[a(1202)]=s.roundTripTime,v[a(937)]=s.packetsLost),n&&(v[a(1603)]=n[a(915)]),i&&i[a(1840)]>0){const e=i[i[a(1840)]-1];v[a(867)]=e.roundTripTime,v[a(664)]=0,i[a(1278)]((e=>v[a(664)]+=e[a(505)]))}if(r&&r.length>0){const e=r[r[a(1840)]-1];v[a(1162)]=0,v[a(1379)]=0,r[a(1278)]((e=>{const t=a;v[t(1162)]+=e.packetsSent,v.videoBytesSent+=e[t(1183)]})),v[a(525)]=e.framesSent,c&&(v.videoFps=v.framesSent<c[a(525)]||v[a(525)]-c[a(525)]>100?15:Math.floor((v[a(525)]-c[a(525)])/(v.timestamp-c[a(1545)])*1e3),v[a(1346)]=Math.floor(8*(v.videoBytesSent-c[a(1379)])/(v[a(1545)]-c[a(1545)])*1e3),v[a(664)]&&c[a(664)]<v[a(664)]&&(v[a(1346)]-=Math[a(1395)](1200*(v[a(664)]-c[a(664)])*8/(v[a(1545)]-c[a(1545)])*1e3)))}if(!c)return v[a(985)]=0,v;let h=1,w=1,S=1,I=1,k=1;if(s&&!v.muteAudio){v[a(1202)]&&(w=l[a(789)](v[a(1202)],d,u));const e=v[a(1603)]-c[a(1603)],t=v[a(937)]-c.audioPktsLost;if(e>0&&t>0){const r=t/e*100;I=l.fetchRangePercentL(r,f,b)}}if(i&&i.length>0&&!v[a(1870)]){v[a(867)]&&(S=l[a(789)](v[a(867)],d,u));const e=v[a(1162)]-c.videoPktsSent,t=v[a(664)]-c[a(664)];if(e>0&&t>0){const r=t/e*100;k=l[a(789)](r,f,b)}}return!v[a(1870)]&&y>0&&v.outBandWidth&&i&&i[a(1840)]>0&&r&&r.length>0&&(h=l[a(1666)](v[a(1346)],g,y)),v[a(504)]&&v[a(1870)]?v.level=0:v.muteAudio||v[a(1870)]?v[a(504)]?v[a(985)]=.1*S+.2*k+.7*h:v[a(1870)]&&(v[a(985)]=.5*w+.5*I):v.level=.1*(w+S)+.1*(I+k)+.6*h,v},l[o(1083)]=function({streamInfo:e,pair:t,video:r,audio:n}){const i=o,s=l[i(1605)][i(1733)][i(1663)][e.id],{delayMin:a,delayMax:c,jitterMin:d,jitterMax:u,kMinVideoFrameRate:p}=l.core[i(1733)][i(1009)],m=e[i(1021)][e[i(1368)]],f=l.getNetworkMinBw(e.type,e[i(1021)][0][i(1293)]),b={};if(b.id=e.id,b.type=e.type,b[i(504)]=e[i(504)]||e[i(1681)],b[i(1870)]=e.muteVideo||e[i(962)]||e[i(1827)],b[i(1545)]=t?t.timestamp:Date.now(),b.level=0,b[i(1613)]=m[i(1293)],!t)return s;if(n&&(b.audioDelay=1e3*t[i(1489)]+(n[i(1029)]?n.jitterBufferDelay/n[i(1029)]*1e3:0),b[i(961)]=1e3*n[i(554)],b[i(1284)]=n[i(1589)],b[i(937)]=n.packetsLost),r&&(b.videoDelay=1e3*t[i(1489)]+(r[i(1029)]?r[i(1882)]/r[i(1029)]*1e3:0),b[i(1788)]=(r[i(1624)]-r[i(561)]-r[i(1232)])/r[i(1510)]*1e3,b[i(875)]=1e3*r.jitter,b[i(683)]=r[i(1589)],b[i(664)]=r[i(505)],b[i(1624)]=r[i(1624)],b[i(747)]=r.bytesReceived,s&&s[i(747)]&&(b[i(1613)]=Math[i(1395)](8*(b[i(747)]-s[i(747)])/(b[i(1545)]-s[i(1545)])*1e3))),!s)return b[i(985)]=0,b;r&&(b[i(624)]=Math[i(1395)]((b[i(1624)]-s[i(1624)])/(b[i(1545)]-s[i(1545)])*1e3));let y=1,v=1,g=1,h=1;return n&&!b[i(504)]&&(v=l[i(789)](b[i(1330)],a,c),g=l[i(789)](b[i(961)],d,u)),r&&!b[i(1870)]&&(l[i(789)](b[i(1869)],a,c),l.fetchRangePercentL(b[i(875)],d,u),m[i(1293)]>0&&b[i(1613)]&&(y=l[i(1666)](b.inBandWidth,f,m.targetBw)),r[i(1510)]>0&&(h=l[i(1666)](b[i(624)],p,m[i(1914)]))),b[i(504)]&&b[i(1870)]?b.level=0:b[i(504)]||b.muteVideo?b.muteAudio?b[i(985)]=.8*y+.2*h:b[i(1870)]&&(b[i(985)]=.5*v+.5*g):b.level=.1*v+.1*g+.1*h+.7*y,b},l[o(523)]=function(e,t){const r=o,n=l[r(1605)].network[r(758)],{kNetUpWeakBitrate:i,networkQuality:s,kNetDownWeakFps:a}=l[r(1605)][r(1733)][r(1009)],c=Date[r(1913)](),d=l[r(1653)](e.id,e[r(1137)],!0),u=t.videoFps,p=e[r(1137)]?t[r(1346)]:t[r(1613)],m=15e3,f=l.options[r(939)]+500;let b=null;function y(e){const t=r;e[t(1377)]=0,e[t(1246)]=0,e[t(855)]=0,e[t(968)]=0,e.sampleNum=0}0!==d&&(n[e.id]?b=n[e.id]:(b={id:e.id,averageBitrate:0,totalBitrate:0,sampleNum:0,updateTime:0,startLowBitrateTime:0,startNormalBitrateTime:0,isWeak:!1},n[e.id]=b),b[r(574)]=c,e[r(1870)]||e.localMuteVideo?(b[r(1299)]=0,b[r(834)]=0,y(b)):(e[r(1137)]?d<=s[r(1256)]&&!b.isWeak?0===b[r(1299)]&&(b[r(1299)]=c,y(b)):d>s[r(1256)]&&b.isWeak&&0===b[r(1109)]&&(b.startNormalBitrateTime=c,y(b)):(d<=s[r(1182)]||u<=a)&&!b.isWeak?0===b.startLowBitrateTime&&(b[r(1299)]=c,y(b)):d>s.vbad&&u>a&&b.isWeak&&0===b[r(1109)]&&(b[r(1109)]=c,y(b)),b[r(1299)]>0&&(b[r(1930)]++,b[r(855)]+=p,b[r(968)]+=u,b[r(1246)]=b[r(855)]/b[r(1930)],b[r(1377)]=b[r(968)]/b.sampleNum,e[r(1137)]?d>s[r(1256)]?(b[r(1299)]=0,y(b)):c-b[r(1299)]+f>m&&(b[r(1299)]=0,y(b),!b.isWeak&&(b[r(598)]=!0,b[r(922)]=!0)):d>s[r(1182)]&&u>a?(b[r(1299)]=0,y(b)):c-b[r(1299)]+f>m&&(b[r(1299)]=0,y(b),!b.isWeak&&(b[r(598)]=!0,b.isChange=!0))),b.startNormalBitrateTime>0&&(b[r(1930)]++,b[r(855)]+=p,b[r(968)]+=u,b[r(1246)]=b.totalBitrate/b[r(1930)],b[r(1377)]=b.totalVideoFps/b[r(1930)],e[r(1137)]?d<=s[r(1256)]?(b.startNormalBitrateTime=0,y(b)):c-b[r(1109)]+f>m&&(b[r(1109)]=0,y(b),b.isWeak&&(b[r(598)]=!1,b.isChange=!0)):d<=s[r(1182)]||u<=a?(b[r(1109)]=0,y(b)):c-b[r(1109)]+f>m&&(b[r(834)]=0,y(b),b[r(598)]&&(b.isWeak=!1,b[r(922)]=!0)))))},l.routineNetworkReport=function(){const e=o,t=[];Object[e(1847)](l[e(1605)].publishers)[e(1278)]((r=>{const o=e;t[o(649)](new Promise((e=>{const t=o;if(!r.pc||"connected"!==r.pc[t(901)])return e();r.pc.getStats()[t(1217)]((o=>{const n=t,i={streamInfo:r,video:null,audio:null,pair:null};o[n(1278)]((e=>{const t=n;"candidate-pair"===e.type&&e[t(1241)]===t(494)?i[t(1345)]=e:e[t(1049)]===t(1602)&&e[t(1144)]!==l[t(1605)][t(1585)]&&(e[t(1661)]===t(1063)?e.decoderImplementation!==t(1866)&&(i[t(1063)]=e):i[t(1542)]=e)}));const s=l[n(1083)](i);return s&&(l.core[n(1733)][n(1663)][r.id]=s,i[n(1063)]&&l[n(523)](r,l[n(1605)][n(1733)][n(1663)][r.id])),e()}))})))}));[l[e(1605)][e(1365)],l.core[e(1285)],l.core[e(1044)]][e(1612)](Object[e(1847)](l[e(1605)][e(1331)]))[e(1278)]((r=>{const o=e;r.preview&&r.pc&&r.pc.connectionState===o(1734)&&t[o(649)](new Promise((e=>{const t=o;r.pc[t(682)]().then((o=>{const n=t,i={streamInfo:r,pair:null,videoOutList:[],audioOut:null,videoRemoteInList:[],audioRemoteIn:null};o[n(1278)]((e=>{const t=n;e.type===t(1153)&&"succeeded"===e[t(1241)]?i.pair=e:e[t(1049)]===t(1351)?e[t(1661)]===t(1063)?i[t(1123)][t(649)](e):i[t(1227)]=e:"outbound-rtp"===e[t(1049)]&&("video"===e[t(1661)]?i[t(1536)][t(649)](e):i.audioOut=e)}));const s=l.getUplinkNetworkReport(i);return s&&(l[n(1605)][n(1733)][n(581)][r.id]=s,l[n(523)](r,s)),e()}))})))})),Promise[e(1355)](t)[e(1217)]((()=>{l[e(959)]()}))},l.streamNetworkReport=function(e,t){const r=o;clearInterval(l[r(1245)]),delete l.networkReport,e&&(l[r(1245)]=setInterval(l[r(774)],t))},l.recorders={},l.record=function(e=!0,t="",r=!0,n="",s=!1,c=1){const u=o;let p;if(e){if(p=n?l[u(1605)][u(1331)][n]:l[u(1605)][t],!p[u(924)]||!p[u(539)])return i.logWarn(u(1665),t,"before preview"),l[u(1500)](l.ErrorCode[u(1502)],u(1656))}else{if(p=l[u(778)](t),!p)return i[u(1446)](u(1168),t,u(1161)),l[u(1500)](l[u(1751)][u(1502)],u(1194));if(!p[u(1744)])return i[u(1446)]("record stream",t,u(1003)),l[u(1500)](l.ErrorCode[u(1502)],u(726))}let m=n?t+"-"+n:t;if(!r)return l.recorders[m]?(l[u(1364)][m].recorder[u(1318)](),l[u(1364)][m][u(1863)]=s,l[u(1364)][m][u(1181)]):(i[u(1908)](u(878),m,u(1161)),l[u(1500)](l.ErrorCode[u(1502)],u(1370)+m));{if(l.recorders[m])return;if(!d)return;let e=1e4,t={autoDownload:s,chunks:[],recorder:new d(p[u(539)]),resolve:null,promise:null,customStream:null,video:null,canvasTrack:null,canvasInterval:-1},r=p[u(539)].getVideoTracks()[0],o=e=>{const r=u;t[r(511)].push(e[r(1238)])},n=()=>{const e=u;let r=new File([new Blob(t[e(511)],{type:t[e(1382)].mimeType})],(2===c?e(1542):"video")+"-"+Date[e(1913)]()+e(1010),{type:t[e(1382)][e(1480)]});t[e(511)]=[],t.recorder[e(1891)]=null,t.recorder.onstop=null,t[e(1382)].onerror=null,t[e(1016)]&&l[e(1593)](t),delete l[e(1364)][m],t.autoDownload&&a&&a(r),t[e(1086)](r)},f=e=>{const r=u;i.logWarn(r(889),e.toString()),t[r(511)].length>0&&n()};if(t[u(1181)]=new Promise((e=>{t[u(1086)]=e})),1===c){let e=!p.local&&(r&&r.muted||p[u(1870)]);i[u(1134)](u(1592)+e),e&&l.initRecordCustomStream(p,t)}else if(2===c){let e=new MediaStream(p[u(539)][u(1023)]());t.recorder=new d(e)}else if(3===c){let e=new MediaStream(p[u(539)][u(645)]());t[u(1382)]=new d(e)}t[u(1382)].ondataavailable=o,t[u(1382)][u(1877)]=n,t[u(1382)][u(842)]=f,t[u(1382)][u(704)](e),l[u(1364)][m]=t}},l[o(988)]=function(e,t){const r=o,n=e[r(1021)][e[r(1021)][r(1840)]-1],s=e[r(539)][r(645)]()[0];if(!n)return void i.logWarn("record layer empty");if(!s)return void i[r(1446)]("record videoTrack empty");i[r(1134)]("initRecordCustomStream begin: ",n[r(559)],n.height,n[r(1914)]);const a=document[r(1586)]("video"),c=document.createElement(r(736)),u=new MediaStream;c[r(559)]=n[r(559)],c[r(958)]=n[r(958)],a.width=n[r(559)],a[r(958)]=n[r(958)];const l=c[r(833)]("2d");a.srcObject=new MediaStream([s]),a[r(1566)]=!1,a[r(1895)]=!0,a.play()[r(1217)]((()=>{i[r(1134)]("custom stream has video")}))[r(1549)]((e=>{const t=r;i[t(1134)](t(675),e[t(1644)]())})),t.canvasInterval=setInterval((()=>{const e=r;l[e(1865)](0,0,n[e(559)],n[e(958)]),t[e(1719)]&&!t[e(1719)][e(1895)]&&l[e(1740)](t.video,0,0,n.width,n[e(958)])}),40);const p=c[r(551)](n.frameRate);e[r(539)].getAudioTracks().forEach((e=>{u[r(707)](e)})),p[r(645)]().forEach((e=>{const o=r;u[o(707)](e),t[o(916)]=e,i[o(1134)](o(1563)+e[o(1895)])})),t[r(1719)]=s,t[r(1063)]=a,t.recorder=new d(u),t.customStream=u,i[r(1134)](r(615))},l[o(1593)]=function(e){const t=o;clearInterval(e.canvasInterval),e[t(916)]&&e[t(916)].stop(),e.video[t(793)](),i[t(1134)](t(1725))},l.recordTest=function(e=!0,t="",r=!0,n=""){const s=o;let c,u=1;if(c=l[s(778)](t),!c.ready)return;let p=n?t+"-"+n:t;if(r){if(l[s(1364)][p])return;if(!d)return;let e={chunks:[],type:c[s(1049)],index:u++};e[s(1382)]=new d(c[s(539)],{}),e[s(1382)][s(1891)]=t=>{const r=s;e[r(511)].push(t[r(1238)])},e[s(1382)].onstop=function(){const t=s;if(a){let r=new File([new Blob(e.chunks,{type:e[t(1382)][t(1480)]})],t(550)+e[t(1049)]+"-"+Date.now()+"-"+e[t(1223)]+t(1010),{type:e[t(1382)][t(1480)]});a(r)}e[t(511)]=[]},e[s(1382)][s(842)]=function(e){const t=s;console.error(t(715),e)},e[s(1382)][s(704)](),l[s(1364)][p]=e}else{if(!l[s(1364)][p])return i[s(1908)](s(878),p,"not found"),l[s(1500)](l[s(1751)][s(1502)],s(1370)+p);l.recorders[p].recorder[s(1318)](),delete l.recorders[p]}},l.print=function(e=!0,t="",r=""){const n=o;let s;if(e)if(l[n(1605)][n(1331)][r]&&l[n(1605)].cameraEx[r][n(924)]&&l[n(1605)][n(1331)][r][n(547)])s=l[n(1605)][n(1331)][r][n(547)];else{if(!(l[n(1605)][t]&&l[n(1605)][t].preview&&l[n(1605)][t][n(547)]))return i[n(1908)](n(940)),l[n(1500)](l.ErrorCode[n(1622)],"print "+(r?t+"-"+r:t)+n(1461));s=l.core[t].videoElem}else{let e=l[n(778)](t);if(!e||!e.ready||!e[n(547)])return i[n(1908)](n(1398)),l[n(1500)](l[n(1751)].PrintError,n(570)+t);s=e[n(547)]}let a=document[n(1586)](n(736));return a.width=s[n(617)]||640,a.height=s.videoHeight||360,a[n(833)]("2d")[n(1740)](s,0,0,a.width,a[n(958)]),a[n(1606)]("png")},l[o(1639)]=function(e="",t="",r,n,i,s,a,c,d,u){l[o(1766)](e,t,i,r,n,d,u,a,s,c)},l[o(1825)]=function(e,t,r,n,i,s,a,c,d,u){l[o(1188)](e,t,r,n,i,s,a,c,d,u)},l[o(596)]=async function(){const t=o;i[t(1134)](t(1652)+l[t(1605)].unableAutoPlay.length);const r=l[t(1605)][t(920)],n=[];l[t(1605)][t(920)]=[],r[t(1278)]((e=>{const r=t;e&&e[r(1501)]&&e[r(1501)][r(1646)]?n[r(649)](new Promise(((t,o)=>{const n=r;e[n(844)]()[n(1217)]((()=>{t(e)}))[n(1549)]((()=>{const t=n;i[t(1908)](t(756)+e.id),o(e)}))}))):l[r(1605)].unableAutoPlay.push(e)})),(t=>{const r=e;return Promise&&Promise[r(763)]?Promise[r(763)](t):new Promise((e=>{const o=r;if(0===t[o(1840)])return e([]);const n=new Array(t[o(1840)]);let i=t[o(1840)];const s=()=>{i--,0===i&&e(n)};t[o(1278)](((e,t)=>{const r=o;e[r(1217)]((e=>{const o=r;n[t]={status:o(1413),value:e},s()}))[r(1549)]((e=>{const o=r;n[t]={status:o(692),reason:e},s()}))}))}))})(n)[t(1217)]((e=>{const r=t;let o=!1;e[r(1278)]((e=>{const t=r;e[t(1659)]===t(692)&&(o=!0,l[t(1605)].unableAutoPlay[t(649)](e.reason))})),o&&(i.logError("user play fail: "+l[r(1605)][r(920)][r(1840)]),setTimeout((()=>{s[r(676)]("needUserPlay")}),1e3))}))},l[o(1837)]=async function(e){const t=o;let r="recordScreen",n=null;if(e){if(l.recorders[r])return void i[t(1908)](t(1841)+r);if(!d)return void i[t(1908)]("browser is not support MediaRecorder");try{let e={audio:l[t(1558)].screenEnableAudio,video:l[t(1558)][t(1511)]};e.video&&(e[t(1063)]={frameRate:{ideal:l[t(1558)].screenLayers[0][t(1914)]}}),n=await navigator[t(1783)][t(1626)](e)}catch(e){if(i.logError("open screen preview error, "+e),e[t(1644)]()[t(1100)](t(1006))>=0)return s.emit(s[t(1211)][t(1285)],!1);l[t(1872)]({type:l[t(932)][t(1013)],desc:t(1344),error:e})}var c={audioBitsPerSecond:128e3,videoBitsPerSecond:25e5,mimeType:t(644)};let e={chunks:[],recorder:new d(n,c),stream:n};e[t(1382)].ondataavailable=r=>{const o=t;e.chunks[o(649)](r[o(1238)])},e.recorder[t(1877)]=function(){const o=t;a&&a(new File([new Blob(e.chunks,{type:e[o(1382)][o(1480)]})],o(550)+Date[o(1913)]()+".webm",{type:e[o(1382)].mimeType})),e[o(511)]=[],delete e[o(539)],delete l.recorders[r]},e[t(1382)][t(704)](),l.recorders[r]=e}else{if(!l[t(1364)][r])return i.logError(t(878),r,t(1161)),l[t(1500)](l[t(1751)][t(1502)],t(1370)+r);l[t(1364)][r].recorder[t(1318)](),l[t(1761)](l.recorders[r].stream)}},l[o(1438)]=async(e={},t)=>{const n=o;if(null===e)return;e instanceof Array?e[n(1278)]((e=>{const t=n;Object.keys(e)[t(1278)]((t=>{(void 0===e[t]||null===e[t]||""===e[t])&&(e[t]=-1)}))})):e instanceof Object&&Object.keys(e)[n(1278)]((t=>{(void 0===e[t]||null===e[t]||""===e[t])&&(e[t]=-1)}));const i=e=>new Promise(((t,o)=>{const n=g,i={url:e.url,timeout:e[n(1720)],method:e.method};e.method===n(631)?i[n(743)]=e[n(743)]:i[n(1238)]=e[n(1238)],r(i)[n(1217)]((e=>{t(e)})).catch((e=>{200===e[n(1659)]?t():o(e)}))}));if(e instanceof Array&&e[n(1840)]>4){const r=Math[n(1875)](e.length/4);for(let o=0;o<r;o++){let s=e[n(830)](4*o,o!==r-1?4*o+4:e[n(1840)]);v[n(1301)](i,s,t)}}else v[n(1301)](i,e,t)},l[o(1696)]=function(){const e=o,t={webSocketSupported:!(!window[e(1478)]||typeof window[e(1478)]!==e(1414)),webRTCSupported:!(!window.RTCPeerConnection||typeof window[e(843)]!==e(1414)),mediaDevicesSupported:!!navigator.mediaDevices,h264DecodeSupported:!1};if(t[e(491)]){const r=RTCRtpReceiver[e(1642)]("video"),o=t=>{const r=e;return t.codecs[r(1767)]((e=>{const t=r;return e.mimeType[t(580)]()===t(983)}))||[]};t[e(952)]=o(r)[e(1840)]>0}return t},l.setRole=function(e){const t=o;if(l[t(1605)][t(1703)]!==e)if(l[t(1605)][t(1698)]){const r=[l[t(1001)][t(1743)],l.UserRole[t(1645)]],o=[l[t(1001)][t(1142)],l[t(1001)][t(1075)]];r[t(601)](l[t(1605)][t(1703)])&&r[t(601)](e)||o[t(601)](l[t(1605)][t(1703)])&&o.includes(e)?(l[t(805)](e),l[t(929)](!0),l[t(1440)]({userRole:e})):l[t(1500)](l[t(1751)].SetRoleError)}else l[t(1440)]({userRole:e});else i.logWarn("set same role")},l[o(1321)]=function(){const e=o;l[e(1605)][e(1698)]&&!l[e(1605)][e(820)]?(l[e(1605)].muteAllStreamAudio=!0,l.core[e(1365)][e(1067)]=l[e(1605)][e(1365)].muteAudio,l[e(1605)][e(1365)].pc&&l[e(540)](l.StreamType[e(910)],{muteAudio:!0}),l.core.screen[e(1067)]=l[e(1605)][e(1285)].muteAudio,l[e(1605)][e(1285)].pc&&l[e(540)](l[e(932)][e(1013)],{muteAudio:!0}),l[e(1605)][e(1044)][e(1067)]=l.core.custom[e(504)],l.core[e(1044)].pc&&l[e(540)](l.StreamType.Screen,{muteAudio:!!l[e(1605)][e(1044)].lastMuteAudio},!1,l[e(978)][e(1340)]),Object[e(1323)](l[e(1605)][e(1331)])[e(1278)]((t=>{const r=e;l[r(1605)][r(1331)][t].lastMuteAudio=l[r(1605)][r(1331)][t][r(504)],l[r(1605)][r(1331)][t].pc&&l[r(1412)](t,{muteAudio:!0})})),Object.keys(l[e(1605)][e(1898)]).forEach((t=>{const r=e;l.core.publishers[t][r(1359)]=l[r(1605)].publishers[t].localMuteAudio,l[r(982)](t,{muteAudio:!0})}))):i[e(1446)](e(1035)+!!l[e(1605)][e(1698)]+e(1919)+l.core[e(820)])},l[o(1491)]=function(){const e=o;l[e(1605)][e(1698)]&&l[e(1605)][e(820)]?(l.core[e(820)]=!1,l[e(540)](l[e(932)].Camera,{muteAudio:!!l[e(1605)].camera[e(1067)]}),l[e(540)](l[e(932)][e(1013)],{muteAudio:!!l[e(1605)][e(1285)].lastMuteAudio}),l[e(540)](l.StreamType[e(1013)],{muteAudio:!!l.core[e(1044)][e(1067)]},!1,l.SubStreamType[e(1340)]),Object[e(1323)](l[e(1605)][e(1331)])[e(1278)]((t=>{const r=e;l[r(1412)](t,{muteAudio:!!l[r(1605)][r(1331)][t].lastMuteAudio})})),Object[e(1323)](l[e(1605)][e(1898)])[e(1278)]((t=>{const r=e;if(l[r(982)](t,{muteAudio:!!l[r(1605)][r(1898)][t][r(1359)]}),M[r(963)]){const e=l.core[r(1898)][t][r(612)];e&&(e[r(793)](),setTimeout((()=>{e[r(844)]()}),50))}}))):i[e(1446)](e(1922)+!!l[e(1605)].session+e(1919)+l.core.muteAllStreamAudio)},l.destroy=function(){const e=o;s.destroy(),l.cameraPreview(null,!1),l[e(1710)](null,!1),Object[e(1847)](l[e(1605)][e(1331)])[e(1278)]((t=>{const r=e;t[r(1049)]===l[r(932)][r(910)]?l[r(642)](null,t[r(1019)],"","",!1):l[r(1524)](null,t[r(1019)],!1)})),l[e(1152)](null,"",!1),l.leaveRoom(!0)},l[o(1822)]=function(e=""){const t=o;if(e&&typeof e===t(1447)&&!(e[t(1840)]<45))try{let r=CryptoJS[t(1786)][t(881)][t(864)](Base64.decode(e[t(803)](0,22))),o=CryptoJS[t(1786)][t(881)][t(864)](Base64[t(927)](e[t(803)](22,22))),n=e[t(803)](44);for(let e=0,r=(4-n[t(1840)]%4)%4;e<r;e++)n+="=";return CryptoJS[t(1033)][t(1715)](n,r,{iv:o})[t(1644)](CryptoJS.enc[t(881)])}catch(e){i[t(1908)]("self aes decrypt error, "+e)}},l}function U(){const r=e;let o=N(),n=o[r(1819)],i=o[r(769)];return{version:t,logs:function(e=!1){const t=r;return n[t(1244)](o[t(1605)],e)},setDNS:function(e=[]){const t=r;n[t(1134)](t(1151)+JSON[t(1857)](e||[])+")"),0!==e.length&&e[t(1278)]((e=>{const r=t;e[r(759)]&&e.ip&&(o.dns[e[r(759)]]=e.ip)}))},init:function(e={}){o[r(1487)](e)},addListener:i[r(1746)][r(1492)](i),on:i[r(1746)][r(1492)](i),removeListener:i[r(1731)].bind(i),removeAllListener:i[r(1055)][r(1492)](i),askForPermission:function(e=!1,t=!1){const i=r;if(n[i(1134)](i(1198)+e+i(1842)+t+")"),!e&&!t)return o[i(1500)](o[i(1751)][i(1069)],"askForPermission");o.getDeviceUsingPermission(e,t)[i(1217)]()},join:function(e,t,i="",s=o.Area.BeiJing,a){const c=r;return n[c(1134)](c(1757)+e+c(1363)+t+c(1360)+i+c(1265)+s+c(1700)+a+")"),e&&t&&typeof e===c(1447)&&typeof t===c(1447)?(typeof a===c(840)&&(a=o[c(1605)][c(1703)]),typeof a!==c(1846)||typeof Object[c(1847)](o.UserRole).find((e=>e===a))===c(840)?o[c(1500)](o[c(1751)][c(1069)],c(1410)):((!i||typeof i!==c(1447))&&(n[c(1446)](c(1420)),i=""),void o.joinRoomEx(e,t,i,s,a))):o[c(1500)](o[c(1751)].ParamsError,c(1757)+e+", uid:"+t+c(1360)+i+c(1466)+s+")")},leave:function(){const e=r;n.logInfo(e(489)),o.leaveRoom()},preview:function(e=null,t=o.StreamType[r(910)],i=!0){const s=r;if(n[s(1134)](s(1632)+(e?e.id:"")+", streamType:"+t+s(876)+i+")"),Object[s(1847)](o.StreamType)[s(1100)](t)<0)return o[s(1500)](o[s(1751)][s(1069)],s(924));t===o[s(932)][s(910)]?o.cameraPreview(e,i)[s(1217)]():o[s(1710)](e,i)[s(1217)]()},previewEx:function(e=null,t,i,s,a){const c=r;return n[c(1134)](c(999)+(e?e.id:"")+c(1129)+t+c(558)+i+c(1320)+s+c(876)+a+")"),t&&(!a||i||s)?void o.cameraPreviewEx(e,t,i,s,a):o.emitError(o[c(1751)][c(1069)],c(1317))},previewScreenEx:function(e=null,t,i){const s=r;if(n[s(1134)](s(1263)+(e?e.id:"")+s(1129)+t+s(876)+i+")"),!t)return o[s(1500)](o[s(1751)][s(1069)],s(522));o.screenPreviewEx(e,t,i)},previewCustom:function(e=null,t="",i=!0,s=!1,a=!1){const c=r;if(n[c(1134)](c(1243)+!!e+", url:"+t+c(876)+i+c(948)+s+", muteAudio:"+a),i){if(!(e&&e instanceof HTMLElement))return o[c(1500)](o[c(1751)][c(1069)],c(1506));if(!t||"string"!=typeof t)return o.emitError(o[c(1751)][c(1069)],c(841))}o[c(1152)](e,t,i,s,a)},setCustomProfile:function(e,t,i){const s=r;return n.logInfo(s(1166)+!!e+s(1627)+t+s(1795)+(i?JSON[s(1857)](i):"")),e instanceof HTMLElement?t&&typeof t===s(1447)?o.core[s(1044)][s(924)]?void o[s(552)](e,t,i):o.emitError(o[s(1751)].ParamsError,s(1272)):o[s(1500)](o[s(1751)][s(1069)],s(981)):o[s(1500)](o[s(1751)][s(1069)],"setCustomProfile: videoElement error")},publish:function(e=o[r(932)].Camera,t=""){const i=r;return n[i(1134)](i(1450)+e+i(1562)+JSON[i(1857)](t)+")"),Object[i(1847)](o[i(932)])[i(1100)](e)<0?o[i(1500)](o[i(1751)][i(1069)],i(1193)):typeof t!==i(1447)?o.emitError(o.ErrorCode[i(1069)],i(549)):o[i(1605)][i(1698)]?o[i(1605)][i(1703)]===o.UserRole[i(1645)]||o[i(1605)][i(1703)]===o[i(1001)][i(1075)]?(n.logError(i(518)),o.emitError(o.ErrorCode[i(1099)],i(518))):o[i(1605)][e].preview?e===o[i(932)][i(1013)]&&o[i(1605)][i(1044)].id?(n[i(1908)](i(1553)),o[i(1500)](o[i(1751)][i(1099)],i(1553))):void o[i(1314)](e,"",t):(n[i(1908)](i(1482)),o.emitError(o[i(1751)][i(1099)],i(1482))):(n[i(1908)](i(1805)),o[i(1500)](o[i(1751)][i(1099)],i(1805)))},publishEx:function(e,t=""){const i=r;return n[i(1134)](i(1858)+e+i(1562)+JSON.stringify(t)+")"),e?typeof t!==i(1447)?o.emitError(o[i(1751)][i(1069)],"publishEx, info should be string"):o.core[i(1698)]?o.core.userRole===o.UserRole.audience||o[i(1605)][i(1703)]===o[i(1001)][i(1075)]?(n[i(1908)](i(518)),o[i(1500)](o.ErrorCode[i(1099)],i(518))):o[i(1605)][i(1331)][e]&&o[i(1605)][i(1331)][e].preview?void o[i(1314)](o[i(932)][i(910)],e,t):(n[i(1908)](i(1730)),o.emitError(o.ErrorCode[i(1099)],i(1482))):(n[i(1908)](i(1912)),o[i(1500)](o[i(1751)].PublishError,i(1805))):o[i(1500)](o.ErrorCode.ParamsError,"publishEx")},publishScreenEx:function(e,t=""){const i=r;return n[i(1134)]("publishScreenEx(tag:"+e+i(1562)+JSON[i(1857)](t)+")"),e?typeof t!==i(1447)?o.emitError(o[i(1751)][i(1069)],i(1790)):o[i(1605)][i(1698)]?o.core[i(1703)]===o[i(1001)][i(1645)]||o[i(1605)][i(1703)]===o[i(1001)][i(1075)]?(n[i(1908)]("current role can not publish"),o[i(1500)](o[i(1751)][i(1099)],i(518))):o[i(1605)].cameraEx[e]&&o.core.cameraEx[e][i(924)]?void o[i(1314)](o.StreamType[i(1013)],e,t):(n[i(1908)]("publishScreenEx before preview"),o[i(1500)](o[i(1751)].PublishError,i(1482))):(n[i(1908)](i(986)),o.emitError(o[i(1751)][i(1099)],i(1805))):o[i(1500)](o.ErrorCode[i(1069)],i(1728))},publishCustom:function(e=""){const t=r;return n.logInfo(t(1080)+JSON[t(1857)](e)+")"),"string"!=typeof e?o.emitError(o.ErrorCode[t(1069)],t(1036)):o[t(1605)][t(1698)]?o[t(1605)][t(1703)]===o.UserRole[t(1645)]||o.core[t(1703)]===o[t(1001)].sysAudience?(n[t(1908)](t(518)),o[t(1500)](o[t(1751)].PublishError,t(518))):o[t(1605)][t(1044)][t(924)]?o[t(1605)][t(1285)].id?(n.logError(t(673)),o.emitError(o.ErrorCode[t(1099)],t(673))):void o[t(1314)](o[t(932)][t(1013)],"",e,o.SubStreamType[t(1340)]):(n[t(1908)](t(1482)),o.emitError(o[t(1751)].PublishError,t(1482))):(n[t(1908)](t(1805)),o[t(1500)](o[t(1751)].PublishError,t(1805)))},unpublish:function(e=o[r(932)].Camera){const t=r;if(n.logInfo(t(976)+e+")"),Object[t(1847)](o[t(932)])[t(1100)](e)<0)return o[t(1500)](o[t(1751)].ParamsError,t(639));o.wsUnPublish(e,o[t(1605)][e].id)},unpublishEx:function(e=""){const t=r;if(n[t(1134)](t(1888)+e+")"),!e)return o[t(1500)](o[t(1751)].ParamsError,t(1221));o.core.cameraEx[e]&&o[t(1670)](o[t(932)].Camera,o[t(1605)][t(1331)][e].id,e)},unpublishScreenEx:function(e){const t=r;if(n.logInfo(t(1904)+e+")"),!e)return o[t(1500)](o[t(1751)][t(1069)],t(1358));o.core[t(1331)][e]&&o[t(1670)](o[t(932)][t(1013)],o[t(1605)][t(1331)][e].id,e)},unpublishCustom:function(){const e=r;n[e(1134)](e(1889)),o.wsUnPublish(o[e(932)][e(1013)],o[e(1605)][e(1044)].id,"",o.SubStreamType[e(1340)])},subscribe:function(e=null,t="",i="",s,a,c){const d=r;if(n[d(1134)](d(1534)+(e?e.id:"")+", UserID:"+t+d(603)+i+d(527)+s+", muteAudio:"+a+d(948)+c+")"),!t||!i)return o[d(1500)](o[d(1751)][d(1069)],d(658));const u=o[d(1772)](i);if(!u||u[d(943)]!==t)return n[d(1908)](d(616),t,i),o[d(1500)](o.ErrorCode[d(1815)],"publisher not found");i=u[d(1390)],e instanceof HTMLElement&&e!==o[d(1605)][d(1898)][i][d(547)]&&(o[d(851)](e),o.core.publishers[i][d(547)]=e),o[d(1605)][d(1898)][i].id?n.logWarn(i+d(1496)):(typeof s===d(1846)&&s>=0?(s>u.layers.length-1&&(s=u[d(1021)][d(1840)]-1),o[d(1605)][d(1898)][i].layerIndex!==s&&(o[d(1605)][d(1898)][i][d(1368)]=s)):(s=0,o[d(1605)][d(1898)][i].layerIndex=s),typeof a!==d(840)&&o[d(1605)][d(1898)][i].localMuteAudio!==a&&(o[d(1605)][d(1898)][i][d(1681)]=a),void 0!==c&&o[d(1605)][d(1898)][i][d(962)]!==c&&(o[d(1605)].publishers[i][d(962)]=c),0===s&&o[d(1558)][d(839)]&&o.core[d(1898)][i][d(1021)].length>1&&(o[d(1605)][d(1898)][i][d(1839)]=s,o[d(1605)].publishers[i][d(1368)]=1,s=1),o.wsSubscribe(t,i))},unsubscribe:function(e="",t=""){const i=r;n[i(1134)]("unsubscribe(publishIDorTag:"+e+i(1350)+t+")");const s=o.getStreamByPubIDorTag(e);t&&e&&s&&!(t[i(1100)](s[i(1390)])<0)?o.wsUnsubscribe(t):n[i(1446)](i(1312))},muteLocal:function(e="",t={}){const i=r;return n[i(1134)](i(1121)+e+i(1861)+JSON.stringify(t)+")"),t[i(1550)](i(504))||t[i(1550)]("muteVideo")?Object[i(1847)](o[i(932)])[i(1100)](e)<0?o[i(1500)](o[i(1751)][i(1069)],i(1078)):void o[i(540)](e,t):o[i(1500)](o[i(1751)][i(1069)],"muteLocal")},muteLocalEx:function(e="",t={}){const i=r;return n[i(1134)](i(1171)+e+i(1861)+JSON[i(1857)](t)+")"),t[i(1550)]("muteAudio")||t[i(1550)](i(1870))?e?void o[i(1412)](e,t):o.emitError(o[i(1751)].ParamsError,i(1616)):o.emitError(o[i(1751)][i(1069)],i(1616))},muteLocalScreenEx:function(e="",t={}){const i=r;return n[i(1134)]("muteLocalScreenEx(tag:"+e+i(1861)+JSON[i(1857)](t)+")"),t[i(1550)]("muteAudio")||t[i(1550)]("muteVideo")?e?void o[i(1412)](e,t):o[i(1500)](o.ErrorCode[i(1069)],i(785)):o[i(1500)](o[i(1751)][i(1069)],i(785))},muteLocalCustom(e={}){const t=r;if(n[t(1134)](t(973)+JSON.stringify(e)+")"),!e[t(1550)](t(504))&&!e[t(1550)](t(1870)))return o.emitError(o[t(1751)][t(1069)],t(1027));o[t(540)](o[t(932)].Screen,e,!1,o[t(978)][t(1340)])},muteRemote:function(e="",t={}){const i=r;return n[i(1134)]("muteRemote(subscribeID:"+e+i(1861)+JSON[i(1857)](t)+")"),t[i(1550)](i(504))||t[i(1550)](i(1870))?e?void o[i(982)](e,t):o[i(1500)](o[i(1751)][i(1069)],i(510)):o.emitError(o.ErrorCode[i(1069)],i(510))},selectLayer:function(e="",t=0){const i=r;if(n[i(1134)](i(1286)+e+i(527)+t+")"),!e)return o[i(1500)](o[i(1751)].ParamsError,i(992));if(t<0)return o[i(1500)](o[i(1751)].ParamsError,i(1336));let s=o.getPubIdBySubId(e),a=o[i(1605)][i(1898)][s];if(!a)return o[i(1500)](o[i(1751)][i(1069)],i(1787));t>a[i(1021)][i(1840)]-1&&(t=a.layers[i(1840)]-1),a[i(1368)]!==t&&(a[i(1368)]=t),0===t&&o.options[i(839)]&&a[i(1021)][i(1840)]>1&&(t=1),a[i(1839)]=t,a.layerIndex=t,o.wsUpdateLayer(e,t)},updateInfo:function(e=[]){const t=r;if(n[t(1134)](t(865)+JSON[t(1857)](e)+")"),!e||0===e[t(1840)])return o[t(1500)](o[t(1751)][t(1069)],"updateInfo");e[t(1278)]((e=>{const r=t;let n=e[r(1390)]?o.getStreamInfo(e[r(1390)]):null;if(n){typeof n.info===r(1559)?info=n[r(1577)]:info=JSON[r(864)](n[r(1577)]),e[r(1577)]!=={}&&(info.app=e.info,info[r(1507)]=1);let t=[{userID:o.core[r(1322)],publishID:e[r(1390)],info:JSON.stringify(info)}];o.wsUpdateInfo(t),n[r(1577)][r(1507)]=0}}))},getAppInfo:function(e){const t=r;n[t(1134)](t(500)+e+")");let i=o[t(778)](e);return i?i[t(1577)]:{}},message:function(e="",t=null){const i=r;if(n.logInfo(i(724),t||"all"),!e)return o[i(1500)](o[i(1751)][i(1069)],i(896));(!t||t instanceof Array&&0===t[i(1840)])&&(t=null),o[i(953)](e,t)},getDevices:function(e=!1){const t=r;n.logInfo(t(1145)+!!e),o[t(1469)](!!e)[t(1217)]()},setDevice:function(e="",t=""){const i=r;if(n[i(1134)](i(629)+e+i(1505)+t+")"),Object[i(1847)](o[i(1127)])[i(1100)](e)<0)return o.emitError(o[i(1751)][i(1069)],i(1484));o.setDevicePreference(e,t)},getDeviceInfo:function(e){const t=r;return n.logInfo(t(1185)+e+")"),"string"!=typeof e?Promise[t(1341)](t(750)):o[t(1693)](e)},audioReport:function(e=!0,t=250,i=null,s=!1,a){const c=r;if(n[c(1134)]("audioReport(aduioid: "+(i?i.id:"")+c(892)+e+c(684)+t+c(1093)+s+c(1326)+(typeof a===c(1559)?JSON.stringify(a):"")),isNaN(t))return o.emitError(o[c(1751)].ParamsError,"statement");let d=t>200&&!s?t:200;o[c(907)](i?i[c(551)]():null,e,d,s,a)},audioTest:function(e,t,i=200){const s=r;if(n[s(1134)](s(1110)+e+s(1061)+!!t+s(684)+i+")"),e){if(!(t instanceof HTMLElement&&t))return o.emitError(o[s(1751)][s(1069)],s(720));if("number"!=typeof i)return o[s(1500)](o.ErrorCode[s(1069)],s(928));let r=null;try{r=t.captureStream()}catch(e){return o[s(1500)](o[s(1751)][s(1069)],"audio test audioElement get stream error, "+e)}let n=i>200?i:200;o.streamAudioTest(e,r,n)}else o[s(1671)](!1)},videoReport:function(e=!0,t=1e3){const i=r;if(n[i(1134)](i(1664)+e+", interval:"+t+")"),isNaN(t))return o[i(1500)](o[i(1751)][i(1069)],i(632));let s=t>500?t:500;o[i(1283)](e,s)},qosReport:function(e=!0){const t=r;n[t(1134)](t(936)+!!e+")"),o[t(1558)][t(1651)]=!!e},recordLocal:function(e=o[r(932)][r(910)],t=!0,i=!0){const s=r;return n[s(1134)](s(884),e,t),Object.values(o[s(932)])[s(1100)](e)<0?o[s(1500)](o[s(1751)].ParamsError,s(1094)):o.record(!0,e,t,"",i)},recordLocalEx:function(e,t=!0,i=!0){const s=r;return n[s(1134)](s(1005),e,t,i),e?o[s(501)](!0,o[s(932)].Camera,t,e,i):o[s(1500)](o.ErrorCode[s(1069)],"recordLocalEx")},recordLocalScreenEx:function(e,t=!0){const i=r;return n[i(1134)](i(564),e,t),e?o[i(501)](!0,o[i(932)][i(1013)],t,e):o.emitError(o.ErrorCode[i(1069)],i(646))},recordRemote:function(e="",t=!0,i=!0,s=1){const a=r;return n[a(1134)](a(934),e,t,i,s),e?o[a(501)](!1,e,t,"",i,s):o[a(1500)](o[a(1751)][a(1069)],a(995))},printLocal:function(e=o[r(932)].Camera){const t=r;return n[t(1134)](t(1674),e),Object[t(1847)](o[t(932)])[t(1100)](e)<0?o[t(1500)](o[t(1751)][t(1069)],t(1407)):o[t(1704)](!0,e)},printLocalEx:function(e){const t=r;return n[t(1134)](t(509),e),e?o.print(!0,o.StreamType[t(910)],e):o[t(1500)](o[t(1751)][t(1069)],t(1697))},printLocalScreenEx:function(e){const t=r;return n.logInfo(t(1785),e),e?o[t(1704)](!0,o[t(932)][t(1013)],e):o[t(1500)](o[t(1751)].ParamsError,t(1014))},printRemote:function(e=""){const t=r;return n[t(1134)](t(1079),e),e?o[t(1704)](!1,e):o.emitError(o[t(1751)][t(1069)],t(1407))},startMixer:function(e=0,t=null,i=0,s=!1,a=!1,c=!1,d="",u=""){const l=r;return n[l(1134)]("[startMixer]",e,t,i,s,a,c,d,u),0===e||0==(e&o.MixerType.Live)&&0==(e&o[l(597)][l(1112)])||0===i?o[l(1500)](o.ErrorCode.ParamsError,l(1521)):e&o.MixerType.Live>0&&!d?o[l(1500)](o[l(1751)][l(1069)],"startMixer"):void o[l(1639)]("",o[l(1060)][l(1374)],i,t,e,a,s,c,d,u)},pauseMixer:function(e,t){const i=r;n[i(1134)]("[pauseMixer]",e,t),o[i(1639)](e,t?o[i(1060)][i(711)]:o.TaskCmd[i(545)])},stopMixer:function(e){const t=r;n[t(1134)]("[stopMixer]",e),o[t(1639)](e,o[t(1060)][t(1883)])},updateMixer:function(e,t,i){const s=r;n[s(1134)](s(1596),e,t,i),o[s(1639)](e,o[s(1060)][s(1416)],i,t)},startWebPage:function(e,t,i,s,a,c,d,u,l){const p=r;n[p(1134)](p(701),e,t,i,s,a,c,d,u,l),o[p(1825)](e,o.TaskCmd[p(1374)],t,i,s,a,c,d,u,l)},stopWebPage:function(e){const t=r;n[t(1134)](t(1860),e),o[t(1825)](e,o[t(1060)].Stop)},pauseWebPage:function(e,t){const i=r;n.logInfo(i(556),e,t),o.webPage(e,t?o[i(1060)][i(711)]:o[i(1060)][i(545)])},userPlay:function(){const e=r;n[e(1134)](e(596)),o[e(596)]()[e(1217)]()},recordScreen:function(e=!0){const t=r;n.logInfo(t(1837)),o.recordScreen(e)},checkRequirement:function(){const e=r;return n[e(1134)](e(1696)),o[e(1696)]()},setVideoOption:function(e){const t=r;if(n[t(1134)]("setVideoOption:"+JSON.stringify(e)),typeof e!==t(1559))return o[t(1500)](o[t(1751)][t(1069)],t(1736));if(e[t(1550)]("hdQualityPriority")){const r=!!e[t(839)];o[t(1558)][t(839)]!==r&&(o[t(1558)][t(839)]=r,1===o[t(1605)][t(1659)]&&(o.wsUpdateRoom(),Object.keys(o.core[t(1898)])[t(1278)]((e=>{const n=t,i=o[n(1605)].publishers[e];i.pc&&0===i[r?"layerIndex":"targetLayerIndex"]&&this[n(1807)](i.id,0)}))))}},setPublishLayer(e,t={}){const i=r;if(n[i(1134)](i(1343),e,t),typeof t!==i(1559))return o[i(1500)](o.ErrorCode.ParamsError,i(723));if(!(t.targetBw&&t[i(1914)]&&t[i(559)]&&t[i(958)]))return o[i(1500)](o[i(1751)][i(1069)],i(548));if(e===o.StreamType[i(910)]){if(1!==o.options[i(1262)][i(1840)])return o[i(1500)](o[i(1751)].ParamsError,i(643));o.setPublishLayer(e,t)}else{if(!o[i(1605)][i(1331)][e])return o[i(1500)](o[i(1751)][i(1069)],i(1107)+e+i(1062));if(1!==o[i(1558)][i(1544)][i(1840)])return o[i(1500)](o[i(1751)].ParamsError,i(643));o.setPublishLayer(e,t)}},getRole:function(){const e=r;return o.core[e(1703)]},setRole:function(e){const t=r;if(n[t(1134)](t(1150)+e),typeof e!==t(1846)||void 0===Object[t(1847)](o[t(1001)])[t(719)]((t=>t===e)))return o.emitError(o.ErrorCode.ParamsError,"setRole");n[t(1134)](t(1415)+e),o[t(1873)](e)},pauseAllStreamAudio(){const e=r;n[e(1134)](e(1321)),o.pauseAllStreamAudio()},resumeAllStreamAudio(){const e=r;n[e(1134)](e(1491)),o[e(1491)]()},destroy(){const e=r;n[e(1134)](e(1756)),o[e(1756)](),o=null,n=null,i=null,Object[e(1323)](this).forEach((t=>{t!==e(1458)&&delete this[t]}))},create:U,Area:o[r(1064)],StreamType:o[r(932)],StreamTrack:o.StreamTrack,DeviceType:o.DeviceType,ErrorCode:o[r(1751)],Role:o[r(1020)],exAPI:{selfAESDecrypt:function(e=""){return o[r(1822)](e)}}}}!(A=window)[e(827)]&&(A.hirtcwebsdk=U());
